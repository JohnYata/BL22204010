<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(BL22204010)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div id="homework-0" class="section level2">
<h2>Homework 0</h2>
</div>
<div id="data-generation" class="section level2">
<h2>Data Generation</h2>
<p>For example 1, a regular sequence of integers from 1 to 30 can be
generated like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>x</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; [26] 26 27 28 29 30</span></span></code></pre></div>
</div>
<div id="explain" class="section level2">
<h2>Explain</h2>
<p>The resulting vector x has 30 elements.</p>
</div>
<div id="for-example-2" class="section level2">
<h2>For example 2</h2>
<p>Function Generate different levels of data (gl) is very useful
because it can generate a regular sequence of factors. The usage of this
function is gl(k,n), where k is the number of levels (or categories) and
n is the number of times each level is repeated. This function has two
options: length is used to specify the number of data to generate, and
labels is used to specify the name of each level factor.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt;  [1] Male   Male   Male   Male   Male   Male   Female Female Female Female</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; [11] Female Female</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Levels: Male Female</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">expand.grid</span>(<span class="at">Hight=</span><span class="fu">c</span>(<span class="dv">60</span>,<span class="dv">80</span>), <span class="at">Width=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">300</span>), <span class="at">sex=</span><span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;   Hight Width    sex</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; 1    60   100   Male</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 2    80   100   Male</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 3    60   300   Male</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 4    80   300   Male</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 5    60   100 Female</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 6    80   100 Female</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 7    60   300 Female</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; 8    80   300 Female</span></span></code></pre></div>
</div>
<div id="examples-3" class="section level2">
<h2>Examples 3</h2>
<p>The time-series function (ts) creates a ts-type object from a vector
(univariate time series), and has some options (with default values)
that indicate the characteristics of the series.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">ts</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">47</span>, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1959</span>, <span class="dv">2</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt;      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; 1959       1   2   3   4   5   6   7   8   9  10  11</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 1960  12  13  14  15  16  17  18  19  20  21  22  23</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 1961  24  25  26  27  28  29  30  31  32  33  34  35</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 1962  36  37  38  39  40  41  42  43  44  45  46  47</span></span></code></pre></div>
</div>
<div id="homework-1" class="section level2">
<h2>Homework 1</h2>
</div>
<div id="question-3.4-pages-94-96-statistical-computating-with-r" class="section level2">
<h2>Question 3.4 (pages 94-96, Statistical Computating with R)</h2>
</div>
<div id="answer-3.4" class="section level2">
<h2>Answer 3.4</h2>
<p>To generate random samples from a Rayleigh distribution, we can use
the fact that if <span class="math inline">\(X\)</span> follows a
Rayleigh distribution with parameter <span class="math inline">\(\sigma\)</span>, then the square of <span class="math inline">\(X\)</span> follows an exponential distribution
with rate <span class="math inline">\(\lambda = \frac{1}{2
\sigma^2}\)</span>. Specifically, for a Rayleigh distribution, we can
generate samples using the following steps:</p>
<ul>
<li>Generate two independent random variables <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> from a standard normal distribution
<span class="math inline">\(N(0,1)\)</span>.</li>
<li>Compute the Rayleigh-distributed sample as <span class="math inline">\(X = \sigma \sqrt{U^2 + V^2}\)</span>.
\end{enumerate}</li>
</ul>
<p>Alternatively, we can generate the Rayleigh random sample by using
the relationship with the chi-squared distribution:</p>
<p><span class="math display">\[
X = \sigma \sqrt{-2 \ln(U)},
\]</span> where <span class="math inline">\(U \sim
\text{Uniform}(0,1)\)</span>.</p>
<p><strong>Algorithm for Generating Rayleigh Samples:</strong></p>
<ul>
<li><p> <span class="math inline">\(\sigma &gt; 0\)</span>, the scale
parameter of the Rayleigh distribution, and <span class="math inline">\(n\)</span>, the number of samples to generate. - A
vector of Rayleigh-distributed random variables.</p></li>
<li><p>Generate <span class="math inline">\(n\)</span> independent
random variables <span class="math inline">\(U_1, U_2, \dots,
U_n\)</span> from the uniform distribution <span class="math inline">\(\text{Uniform}(0,1)\)</span>.</p></li>
<li><p>For each <span class="math inline">\(U_i\)</span>, compute <span class="math inline">\(X_i = \sigma \sqrt{-2 \ln(U_i)}\)</span>.</p></li>
<li><p>Return the vector of <span class="math inline">\(X_i\)</span>’s.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Function to generate Rayleigh distributed random samples</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>generate_rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="co"># Generate n uniform random variables</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="co"># Apply the Rayleigh transformation</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co"># Function to check the mode of the generated samples</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>check_mode <span class="ot">&lt;-</span> <span class="cf">function</span>(samples, sigma) {</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  mode_theoretical <span class="ot">&lt;-</span> sigma  <span class="co"># Theoretical mode of Rayleigh distribution</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  mode_sample <span class="ot">&lt;-</span> <span class="fu">density</span>(samples)<span class="sc">$</span>x[<span class="fu">which.max</span>(<span class="fu">density</span>(samples)<span class="sc">$</span>y)]  <span class="co"># Sample mode using density estimation</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Theoretical mode: &quot;</span>, mode_theoretical, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Sample mode: &quot;</span>, mode_sample, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>}</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co"># Example: Generate Rayleigh samples for different sigma values</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>sigma_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)  <span class="co"># Different values for sigma</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of samples</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co"># Increase plot margins</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))  <span class="co"># Set up a 2x2 plotting area with adjusted margins</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigma_values) {</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">generate_rayleigh</span>(n, sigma)</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram of Rayleigh(&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>), </span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">breaks =</span> <span class="dv">50</span>)</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>  <span class="fu">check_mode</span>(samples, sigma)</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>}</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; Theoretical mode:  1 </span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt; Sample mode:  0.9975599</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt; Theoretical mode:  2 </span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt; Sample mode:  2.366148</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt; Theoretical mode:  3 </span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co">#&gt; Sample mode:  2.776427</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co"># Reset plotting parameters after use</span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># Reset to single-plot layout</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.11-pages-94-96-statistical-computating-with-r" class="section level2">
<h2>Question 3.11 (pages 94-96, Statistical Computating with R)</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># Function to generate random sample from a mixture of two normal distributions</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>generate_mixture_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p1) {</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="co"># Probabilities for components</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p1</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  </span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="co"># Generate random component choices based on probabilities</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  component_choices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(p1, p2))</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  </span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  <span class="co"># Generate samples from N(0, 1) and N(3, 1)</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  sample_1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">sum</span>(component_choices <span class="sc">==</span> <span class="dv">1</span>), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>  sample_2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">sum</span>(component_choices <span class="sc">==</span> <span class="dv">2</span>), <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  </span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>  <span class="co"># Combine the samples</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>  mixture_sample <span class="ot">&lt;-</span> <span class="fu">c</span>(sample_1, sample_2)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>  </span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>  <span class="fu">return</span>(mixture_sample)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>}</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co"># Generate and visualize the mixture sample for p1 = 0.75</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>mixture_sample <span class="ot">&lt;-</span> <span class="fu">generate_mixture_sample</span>(n, p1)</span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co"># Plot histogram with density overlay using ggplot2</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> mixture_sample), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Mixture Distribution (p1 =&quot;</span>, p1, <span class="st">&quot;)&quot;</span>), <span class="at">x =</span> <span class="st">&quot;Sample Values&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt; ℹ Please use `linewidth` instead.</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a><span class="co">#&gt; generated.</span></span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="co">#&gt; Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a><span class="co">#&gt; ℹ Please use `after_stat(density)` instead.</span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a><span class="co">#&gt; generated.</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABI1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOgBmOjpmOmZmZjpmkJBmkNtmtpBmtrZmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQZgCQZjqQZraQkDqQkGaQtmaQtpCQttuQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2Zjq2kDq2tpC225C229u22/+2/9u2///A3ujG5O7Ijk3I///bkDrbkGbbtmbbtpDb27bb/7bb/9vb///kq27k///r6+v/AAD/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///+ByNHrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPgklEQVR4nO2dC5sbtRWGz27ImlDagB3ASVto2dBCG/dCaZe2GAohu8GUNoGMY7qOM///V1RHl5E0F2k0o7E0tr7nSWyvpKMz7xxpNDcJ8iSjILQDsQtCOxC7ILQDsQtCOxC7ILQDsQtCOxC7ILQDsQtCOxC7wL3I8vW/8m/f/Xya7xY3nxZJm188shZfAdXrD8l3rbBSGv++nZ9VC2MWvVBV27sXZY9rLAn9eI/7Qs1PmHMnxMKSfpuCZXNqtITTR8JcCdDqtDUggPMyIFm6ERBmsQFaTis1NgPaztEVUbECaLfoDujkNebC6sak5EsrQDTP7tvJSXlH66UbAVm0LmXZfQ4GQCt48+nuC9C2Y40/N5Nz+gNs9VW1PP0z3YW7xbsTFkErtLiGNxH6lO3g3eIM/63g9KEexcU2rkX47f5Idtn7bJdNWZmvWAStJ/DKQxFnJGWnVIBGeeK/XoOT9woepGICd4plcQ9s5ye/kqhZwMiYEabVmNzO8dea779OgL58FQtvbn3JAe0Wp4+289OvK4BuTODmUxa3RbysFN/YP9bgxNZjmScU0I2JiPYqoPVEbwpwzs3TPb+d/4yXzbd/UhtrGRBPWqpRt6Surk7/QhF3AvT1AkNyebbhgEg0kP1+rnYRDBBG1m5BwiP/biKcLFoJ8QrzbiZvPCWbdSZKszIIiEX/mWKxqIBkex/bB/129lTpZqh5UvaMlVUo1GnDOomV0tw3zNMl594J0KMV8Xg7Py8AobmzvAoInRU+CC5VQDfe/apIYWUYIGaH5SoBEltxcsEKSAZLzMvKisBwA8QCiOxWcqz+N9zsBggbKOkMJaDNhMelDog2ZpCHzjpAbF/dfqiXRkDC91pAtEmttcQ8F90JR8K329DEqoB0msuTboDQeTK4kIDWrBNwAST6INL87jGPAwDilSh90LrozZiFboCwoyYuFoC281fuYR1045ci5kVwnWvFK0cx1H/+QPwqAzrLWROTFmubWC0g0TxLgMqqHsU4Kx5ay9OOgNYnvyT/F4BID00HDys2BH0P+1rZuWJr/nGh90FkHMS3lQwPyKH+C1JypRyxaCdNrNOOtrBYZFE7aQ2Q6INEB28BREyTjJ/LcZBgRQ8taKEjIDxM5AUg3J90d5FR8pS1qVfuCUCijQkfyiNpfpymmOUgAQHRQzXiLCzKLMphXgdE9xEfIujH8lrJkTRrW0XeNe8XOgIi5M8lINrxI6XtPTzmfjuB20+KPoikkD7mxvuiOAN0crs4F6MDxTdwv5PST9Q+iFD4KR1gCotKlo0cKGqA+DgIB5m3HwoIlnMxtMMBbYqTA6yA1N4BUNziI2kDEjeBL0PRCIcgCZBJ5Gw+ATJpe/ciAdqfILQDsQtCOxC7ILQDsQtCOxC7ILQDsQs82XnWKalr2h6LgaGMixIgixIgixIgixIgixIgixIgixIgixIgixIgi3q4Je5yeDTpsRgYyrioD6ArqoonCVCeANmSEiBLUgJkSUqALEkJkCUpAbIkJUCWpATIkjRuQC8+mr39A/32fDZ76xuD8Y5uiXOMkQJ6+emD/Pt38Nv1b77h3/y6RchcIpmRAnrx+28oGib5zZ9bIwd0/dsf8he/+4z/khH0zJvgkkp8+DPsQ3ZAz9+WgK7v3/msMaNxB5iSDiqC5Dd/bo0ckN4H5Y8fGKwfJaCXn37Iex61sfl0a+SA+DiIHuNns9QH9VRXQFmWJUBNCYRMRpUANdR9ReFwQhVPEiBgaCABaqo7y1gnzTj5MOm/GBjKuKiLW5kARAlVPEmACJYEyJCUSUBIqOLJsQOiPXQC1JxER4jFSJr86m9yiGJgKOOiBMgiZ7eyBMiclGX6ySr53dfkIMXAUMZFrm5lCZA5CXkkQE1JeDMsozfElOtBFULHDIiPnROghiRxepoANSQlQJakWkBQJnTMgLIEyJgkriGW7mqUCB0xoCwBMieJ+xiHCcjDkxNZpj3WIZ7uyDIPtn2pO6AGbC5Jhx1BznVXkrIGQCVCxwzoKgEyJGUJkDlJPq5QebpDI5QAJUD1SQmQOSlLgCxJWd4ISCN0rICyBMiYxK/WJ0BNSc2AqBRCxwiIEpDv9+iA6P80mU0zcJSA2AOJRkBFgztWQFcJUHNSAmRJklfrmwBdyaemjxTQVQJkSCJNLAEyJbWIIPlY+TECktdaE6DapATInJQlQOYk5WJ0AlSX1ApQ8WpL9IDk1BTX92cz8zu9xwhITk2BL/Ref9D/pd5s7IC2c3VlT/la+HPE5OG1cPVi9CgB0aUKi6XImiYW6P48AAF0WffUQvkDn20IPlFFPSC23hZbQEp7Wx5fojeqxX7LWkaQeHssxghC4YJouIKYGkEvPrLwaQcoPwBAK7oeKK6Dp0xNcX3fcgw7FkAYPGz1SRJCcmqKFny8AuKv18UHaDvX1pEupqb4fobqdRSjV+szGD2gInycZQOEm13DIgHKC0DZ2AEVy3saVmfv7Fblar0REHv/MDZARQR10lEA6qPDB0TCR6wUPUgfNHpAPWUDVL4hZgZE3406LkDl+z3jBMSaWZcW1iKCDgHQ8gwXO18NcJivXK23AEJC8QEiAYRLSQ8xUDwYQNv5NAHSBMr33WKKS20vUxNTBOqPzYScZiyLi64uMrtVvWM4TkA9ZANUB8EEiBz2EqDxASJNbJBTjZobYqMEhMf4rrIAqocwNkCDXe7oAqj8Bmvb2oaNoKGuBx0IoG5DRGvdhxNBQ10PqrvfYwdkInRgh/kEyFz3IQFaAZyvLKcazs9JkFFQeY2RFh/PAs9UUQtoefO/7IqHuww7R39DrH0EPWsOoZCXO869X+5IgGxudQXU3AuF6oNW2MTwmpm7hoig+ADlaxwGdeFjqJtu5aEA6i5TBOUJ0EAR1EgoECDawKDbCWtj3eyyxSEA2i3o0Ws793tNuhegJkJBAIkR9G7h8ygG/EV4Z0CVeQba1GZJ6wVIXgyynWu42S8WF3EExNIiAiQvJ3odKGb9ADWE0EEBskNIgHoAqu+maW3ikUq+IeLXuABlQwLiOfmGiF/DASqecvUKqAWEcQDqqcEA1RI6HEC5D0BVQocDyEME1YXQwQDS1+9JgKryAaiG0MEA8hJBNYQOBVB5gaMEqCRfgCqEDgVQ3h9QcdlDOauIBZCcmiJXF553sO8hgvivTF+rNgpAcmqKPH8+e6sDoMoaYt0B8fkXtdpCA1JeC398559dIsgnIEoItNp4Wia0b0Da1BRKE2t9+x8fWujw1ELTB741XTJfFubkGubhBU3a1BRd+iBxv8dPBPFQEaYV8Q2h6STnpdLu7E5a0+otoZoiqLV934CU1kRV7YPoH/cGSOmDYgEEuRo1NZ20uD63F0Byaoq8E6BsCEDMZ64qoCt+j2AvgOTUFHlHQNT+EIB4lNQAutonICfFAkhOotfKSXtavSV3VexngQBd6WNus5Mt0uotuasGELOfADXYh0z0pHsGdKmdlJidbJFWb8ldNRHUEYIHQNkIADUskdUTkDi+GwFdHTEgCSEB6gGIzY3Swsk2afWW3FWy37QK3b4A+XusCBxBtLTftETWfgD5fO4KHEG0s9+4hlgCxNS4RNaeADUQigdQ4yJrCRBT8Aiqf3QvDkD2JbI8A9KvDo0AUHlOyaEB1aY1P3dl3QBd0IdKrX37GmIJkG0FqAQoAkCNz11ZN0AX9KFSa7/FGmJHD8gLhL6Amh5Ms26ALuhDpdZ+lgCZ7bdZ4GgvgBoeTLNugC7oQ6XOfqsVoA4akPWZDm/Pc/T54L4M+XSHIzb+2XL9nr1EUP2jjZYNKAv6canYb7v6yl4AlQklQDJNe/YTSk4GBNR6/Z6hAfFf+p36KAC1XX3lOAFlsQHS79THAChPgAz2s/gAXamPMkQAKE+ADPazGAGpd+rDA8ojBKTcqQ8MKEuAjPazLNPvv8QCSN5FDA3ILwR/gApCQQF1mXX8mADVnYRFA0jcZw0LqMM0XHsDxA+wAQHVnoRFBIgRCgeo/hwjJkC5Zb2pYQFldKq7uAHl5rVeBgWUjQJQ7TQyewGU8eiNGJC4ANthkvP+gLIRAOIfzwyEBgNUnGF0mExy74DyrDGKBgREQ+fSO4RBAOWNiDoAklNTqJNU1NkYCyDZFbV/sKEZkJyaQp2kYtSALtmHfO++FyD5Wrj2grhWWHY+YwKkxJH+Ir4yv0wLQHJiAW2KAfXhBRi7qoA6TU2hTVLRIMMgtcv4dRiTfkfSTRG0F7eGMekXUIs+aDi3hjHpF5CcmkKbpGI/bg1j0vPJqpyawjIOGsCtYUyGvi/mnpQAWZISIEtSAmRJOiJABysI7UDsgtAOxC4I7UDsgtAOxC4I7UDsgtAOxC4I7UDsgtAOxC7obeH6/mz2gH77fjazzjvN1fqOiYe61MxOtVGBU+4a4aXG6w/o5cbHD9oWan/HpH9daman2pjAKXeNnr8jPHj5d/NVWUVuVyv71aVmdqqNCVwyN4ldsCbhKxqATW7Xu/vVpWZ2rs0PILwki7WT4G+5Z93umPSrS83sWlveE9Dj2ewd3EEfKn9qtVs7R1CHutTMQSLo+r7qZzunO/ZBnepSM4fog6TPGL8v/9Gqdrc7Jv3qUjM71cYETrlrhGMM0gXifiFf77QMX6c7Jj3rynlm19qYwCn3EQpCOxC7ILQDsQtCOxC7ILQDsQtCOxC7IEy1KwA4ubBk2ryq5tgtzljRs/r0gQTDV1GjFa6WvIZzc64SAFqIcDpvSB9GMHwVVfGNXN58asxWAsB+bm49akgfRjB8FVXtFlPxdTMhjW1KtvUT8mWKv87Jj48BCDwEsFvIxbmXWApbWFHogjJS89EkS2Q6CTzaaq81bh+KLuJO2s5mQoCskAr9cfoIexyy4bTjWfFIW5NPDL6ikAQk8rHfE4+EwJ8pJ2EvTbbpf7jpuKG4Tew/8YNu/RqjggIh2t69oC2sKCQBiXxKA/Qk8GzPQds5RsaaHs+KplK0G9zaVy9W7Hlm3iJJG2PHsKKQKFLkW1LuHgVerbmJbNh2Tg72al9SBqT14+ubT7B7VwoVgGS+7bzotHwI/JlqL374waZBg6gcQbSJ3cI+Zq0NlrZ3P8EmpBQqmpiaTzRJLwJ/phy0xO3BjhU3bDOpAFI6aQJDbv3yJ9h+lELb+ZTYOSny0b7I6+Ef/Jly0Ur0LKTPOPkbbU1qE/uY9iTi8C2jg48tlUJ4WP/1XZlv3WaI7iLwaMuX9jIAbCsI7UCNEiCLEqAxCUI7ELsgtAOxC0I7ELsgtAOxC0I7ELsgtAOx6/+uXemoOnclrAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Repeat the process for other values of p1 using base R plots</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>p1_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># Set up a 2x2 plotting area</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))  <span class="co"># Adjust margins for better layout</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="cf">for</span> (p1 <span class="cf">in</span> p1_values) {</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  mixture_sample <span class="ot">&lt;-</span> <span class="fu">generate_mixture_sample</span>(n, p1)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  </span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="co"># Plot histogram with density overlay using base R</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="fu">hist</span>(</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>    mixture_sample, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;p1 =&quot;</span>, p1),</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Sample Values&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, <span class="at">breaks =</span> <span class="dv">30</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  )</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(mixture_sample), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># Reset plotting layout to default</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="question-3.20-pages-94-96-statistical-computating-with-r" class="section level2">
<h2>Question 3.20 (pages 94-96, Statistical Computating with R)</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># Function to simulate a Compound Poisson-Gamma process</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>simulate_compound_poisson_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, alpha, beta, t, n_sim) {</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  means <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  variances <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="co"># Simulate the process n_sim times</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>    <span class="co"># Simulate the Poisson process N(t)</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)  <span class="co"># Poisson process with rate lambda</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>    </span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>    <span class="co"># Generate jumps from Gamma distribution</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, <span class="at">shape =</span> alpha, <span class="at">rate =</span> beta)</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>    </span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>    <span class="co"># Compute the sum X(t)</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>    X_t <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>    </span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>    <span class="co"># Estimate mean and variance</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>    means[i] <span class="ot">&lt;-</span> X_t</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>    variances[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(Y) <span class="sc">*</span> N_t  <span class="co"># Variance of the sum of N_t gamma variables</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>  }</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>  </span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>  <span class="co"># Calculate theoretical mean and variance</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>  theoretical_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> alpha <span class="sc">/</span> beta</span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>  theoretical_variance <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">/</span> beta<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (alpha <span class="sc">/</span> beta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>  </span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>  <span class="co"># Return results</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mean_estimate =</span> <span class="fu">mean</span>(means),</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>       <span class="at">variance_estimate =</span> <span class="fu">mean</span>(variances),</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>       <span class="at">theoretical_mean =</span> theoretical_mean,</span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a>       <span class="at">theoretical_variance =</span> theoretical_variance)</span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>}</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a><span class="co"># Set parameters for simulation</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># Poisson rate</span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">3</span>   <span class="co"># Gamma shape parameter</span></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>    <span class="co"># Gamma rate parameter</span></span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>      <span class="co"># Time point to evaluate X(t)</span></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># Number of simulations</span></span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a><span class="co"># Run the simulation</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">simulate_compound_poisson_gamma</span>(lambda, alpha, beta, t, n_sim)</span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a></span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated Mean of X(10):&quot;</span>, results<span class="sc">$</span>mean_estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a><span class="co">#&gt; Estimated Mean of X(10): 60.26144</span></span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated Variance of X(10):&quot;</span>, results<span class="sc">$</span>variance_estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a><span class="co">#&gt; Estimated Variance of X(10): 59.82358</span></span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theoretical Mean of X(10):&quot;</span>, results<span class="sc">$</span>theoretical_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a><span class="co">#&gt; Theoretical Mean of X(10): 60</span></span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theoretical Variance of X(10):&quot;</span>, results<span class="sc">$</span>theoretical_variance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a><span class="co">#&gt; Theoretical Variance of X(10): 240</span></span></code></pre></div>
</div>
<div id="homework-2-pages-149-151-statistical-computing-with-r." class="section level2">
<h2>Homework 2 (pages 149-151, Statistical Computing with R).</h2>
</div>
<div id="exercise-5.4" class="section level2">
<h2>Exercise 5.4</h2>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(\text{Beta}(3, 3)\)</span> cdf, and use the
function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2, \dots, 0.9\)</span>. Compare the
estimates with the values returned by the function in .</p>
</div>
<div id="answer-5.4" class="section level2">
<h2>Answer 5.4</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Function to estimate the Beta(3, 3) CDF using Monte Carlo simulation</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>monte_carlo_beta_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n_sim) {</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="co"># Generate n_sim samples from Beta(3, 3)</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_sim, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">3</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="co"># Estimate the CDF as the proportion of samples &lt;= x</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(samples <span class="sc">&lt;=</span> x)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">return</span>(estimate)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>}</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of simulations</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)  <span class="co"># x values to estimate</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co"># Compute estimates and compare with pbeta</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_values, monte_carlo_beta_cdf, <span class="at">n_sim =</span> n_sim)</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>pbeta_values <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x_values, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">3</span>)</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_values, <span class="at">Monte_Carlo_Estimate =</span> estimates, <span class="at">pbeta_Values =</span> pbeta_values)</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="fu">print</span>(results)</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt;     x Monte_Carlo_Estimate pbeta_Values</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; 1 0.1               0.0080      0.00856</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; 2 0.2               0.0598      0.05792</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; 3 0.3               0.1551      0.16308</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; 4 0.4               0.3234      0.31744</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; 5 0.5               0.4979      0.50000</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; 6 0.6               0.6833      0.68256</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt; 7 0.7               0.8339      0.83692</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; 8 0.8               0.9448      0.94208</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; 9 0.9               0.9908      0.99144</span></span></code></pre></div>
</div>
<div id="exercise-5.9" class="section level2">
<h2>Exercise 5.9</h2>
<p>The Rayleigh density is given by:</p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-\frac{x^2}{2\sigma^2}}, \quad x \geq 0, \;
\sigma &gt; 0.
\]</span></p>
<p>Implement a function to generate samples from a Rayleigh<span class="math inline">\((\sigma)\)</span> distribution using antithetic
variables.</p>
<p>What is the percent reduction in variance of <span class="math inline">\(X + X_2\)</span> compared with <span class="math inline">\(X_1 + X_2\)</span> for independent <span class="math inline">\(X_1, X_2\)</span>?</p>
</div>
<div id="answer" class="section level2">
<h2>Answer:</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Function to generate Rayleigh samples using antithetic variables</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>generate_rayleigh_antithetic <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="co"># Generate n uniform samples</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="co"># Generate antithetic samples</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> U))  <span class="co"># Antithetic variable</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2))</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>}</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of samples</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Scale parameter for Rayleigh distribution</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co"># Generate Rayleigh samples using antithetic variables</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">generate_rayleigh_antithetic</span>(n, sigma)</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co"># Calculate the sum S_antithetic for antithetic variables</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>S_antithetic <span class="ot">&lt;-</span> samples<span class="sc">$</span>X1 <span class="sc">+</span> samples<span class="sc">$</span>X2</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co"># Calculate variances</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>var_antithetic <span class="ot">&lt;-</span> <span class="fu">var</span>(S_antithetic)</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co"># Generate independent Rayleigh samples</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>X1_independent <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>X2_independent <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>S_independent <span class="ot">&lt;-</span> X1_independent <span class="sc">+</span> X2_independent</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co"># Calculate variance for independent samples</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>var_independent <span class="ot">&lt;-</span> <span class="fu">var</span>(S_independent)</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co"># Calculate percent reduction in variance</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>percent_reduction <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (var_independent <span class="sc">-</span> var_antithetic) <span class="sc">/</span> var_independent</span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Variance of X1 + X2 (Independent):&quot;</span>, var_independent, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt; Variance of X1 + X2 (Independent): 0.8606416</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Variance of X + X2 (Antithetic):&quot;</span>, var_antithetic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co">#&gt; Variance of X + X2 (Antithetic): 0.04431678</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Percent Reduction in Variance:&quot;</span>, percent_reduction, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="co">#&gt; Percent Reduction in Variance: 94.85073 %</span></span></code></pre></div>
</div>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to</p>
<p><span class="math display">\[
g(x) = \frac{x^2}{\sqrt{2\pi}} e^{-x^2/2}, \quad x &gt; 1.
\]</span></p>
<p>Which of your two importance functions should produce the smaller
variance in estimating</p>
<p><span class="math display">\[
I = \int_1^\infty \frac{x^2}{\sqrt{2\pi}} e^{-x^2/2} \, dx
\]</span></p>
<p>by importance sampling? Explain.</p>
</div>
<div id="answer-5.1-3" class="section level2">
<h2>Answer 5.1 3</h2>
<p>To find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> supported on <span class="math inline">\((1, \infty)\)</span> that are “close” to the
target function</p>
<p><span class="math display">\[
g(x) = \frac{x^2}{\sqrt{2\pi}} e^{-x^2/2} \quad \text{for } x &gt; 1,
\]</span></p>
<p>we need to ensure that our chosen importance functions adequately
represent the behavior of <span class="math inline">\(g(x)\)</span> over
this interval. Here’s how to proceed:</p>
<p></p>
<p>Let’s use an exponential function which decreases rapidly. We can
choose:</p>
<p><span class="math display">\[
f_1(x) = \lambda e^{-\lambda (x-1)}, \quad x &gt; 1
\]</span></p>
<p>This function is simple and gives us flexibility by adjusting <span class="math inline">\(\lambda\)</span>.</p>
<p></p>
<p>Another option could be a truncated Gaussian function:</p>
<p><span class="math display">\[
f_2(x) = \frac{1}{\sqrt{2\pi \sigma^2}} e^{-\frac{(x -
\mu)^2}{2\sigma^2}}, \quad x &gt; 1
\]</span></p>
<p>Where <span class="math inline">\(\mu\)</span> is shifted to be
greater than 1 and <span class="math inline">\(\sigma\)</span> is
adjusted to control spread.</p>
<p>To be effective, both functions should satisfy:</p>
<p>To determine which function produces a smaller variance when
estimating</p>
<p><span class="math display">\[
I = \int_1^\infty g(x) \, dx,
\]</span></p>
<p>the variance of the estimator <span class="math inline">\(\hat{I}\)</span> for each importance function is
influenced by how closely the function resembles <span class="math inline">\(g(x)\)</span>.</p>
<p>The variance of the estimator using importance sampling is given
by:</p>
<p><span class="math display">\[
\text{Var}(\hat{I}) = \text{Var}\left(\frac{g(X)}{f(X)}\right) \cdot
\frac{1}{n},
\]</span></p>
<p>where <span class="math inline">\(X\)</span> is drawn from the
importance function.</p>
<p>: This function may produce larger variance because it does not
closely resemble <span class="math inline">\(g(x)\)</span> for large
<span class="math inline">\(x\)</span> due to its rapid decrease.</p>
<p>: If <span class="math inline">\(\mu\)</span> is chosen well (e.g.,
near the peak of <span class="math inline">\(g(x)\)</span>), this
function will likely align better with <span class="math inline">\(g(x)\)</span> for larger values, thereby producing
a lower variance.</p>
<p>While both functions can be used, the modified Gaussian <span class="math inline">\(f_2\)</span> is likely to yield a smaller variance
in estimating the integral due to its closer resemblance to the tail
behavior of <span class="math inline">\(g(x)\)</span> for <span class="math inline">\(x &gt; 1\)</span>. In general, the better the fit
of the importance function to the target function, the lower the
variance of the estimator.</p>
</div>
<div id="exercise-monte-carlo-experiment" class="section level2">
<h2>Exercise: Monte Carlo Experiment</h2>

</div>
<div id="answer-monte-carlo-experiment" class="section level2">
<h2>Answer: Monte Carlo experiment</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># Function to measure average sorting time</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>measure_sort_time <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">simulations =</span> <span class="dv">100</span>) {</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  total_time <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  </span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simulations) {</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    arr <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)  <span class="co"># Generate random permutation of 1 to n</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()  <span class="co"># Start time measurement</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    <span class="fu">sort</span>(arr)  <span class="co"># Sort the array</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>    total_time <span class="ot">&lt;-</span> total_time <span class="sc">+</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), start_time, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>))</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>  }</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>  </span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>  <span class="fu">return</span>(total_time <span class="sc">/</span> simulations)  <span class="co"># Return average time</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>}</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co"># Values of n</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>average_times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n_values))</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co"># Run the experiment for each n</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(n_values)) {</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>  avg_time <span class="ot">&lt;-</span> <span class="fu">measure_sort_time</span>(n_values[i])</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>  average_times[i] <span class="ot">&lt;-</span> avg_time</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Average sorting time for n=%d: %.4f seconds</span><span class="sc">\n</span><span class="st">&quot;</span>, n_values[i], avg_time))</span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>}</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt; Average sorting time for n=10000: 0.0001 seconds</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt; Average sorting time for n=20000: 0.0002 seconds</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="co">#&gt; Average sorting time for n=40000: 0.0004 seconds</span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="co">#&gt; Average sorting time for n=60000: 0.0006 seconds</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="co">#&gt; Average sorting time for n=80000: 0.0007 seconds</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="co"># Calculate t_n = n * log(n)</span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a>t_n <span class="ot">&lt;-</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values)</span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a><span class="co"># Data frame for regression</span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n =</span> n_values, <span class="at">average_time =</span> average_times, <span class="at">t_n =</span> t_n)</span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(average_time <span class="sc">~</span> t_n, <span class="at">data =</span> results_df)</span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a><span class="co"># Print summary of the regression model</span></span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a><span class="co">#&gt; lm(formula = average_time ~ t_n, data = results_df)</span></span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb13-50"><a href="#cb13-50" tabindex="-1"></a><span class="co">#&gt;          1          2          3          4          5 </span></span>
<span id="cb13-51"><a href="#cb13-51" tabindex="-1"></a><span class="co">#&gt; -9.144e-06 -5.755e-06 -3.626e-06  5.436e-05 -3.583e-05 </span></span>
<span id="cb13-52"><a href="#cb13-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-53"><a href="#cb13-53" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb13-54"><a href="#cb13-54" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb13-55"><a href="#cb13-55" tabindex="-1"></a><span class="co">#&gt; (Intercept) 3.420e-05  3.123e-05   1.095 0.353488    </span></span>
<span id="cb13-56"><a href="#cb13-56" tabindex="-1"></a><span class="co">#&gt; t_n         7.571e-10  5.743e-11  13.185 0.000943 ***</span></span>
<span id="cb13-57"><a href="#cb13-57" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb13-58"><a href="#cb13-58" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb13-59"><a href="#cb13-59" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-60"><a href="#cb13-60" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.816e-05 on 3 degrees of freedom</span></span>
<span id="cb13-61"><a href="#cb13-61" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.983,  Adjusted R-squared:  0.9774 </span></span>
<span id="cb13-62"><a href="#cb13-62" tabindex="-1"></a><span class="co">#&gt; F-statistic: 173.8 on 1 and 3 DF,  p-value: 0.0009426</span></span>
<span id="cb13-63"><a href="#cb13-63" tabindex="-1"></a></span>
<span id="cb13-64"><a href="#cb13-64" tabindex="-1"></a><span class="co"># Plotting the results</span></span>
<span id="cb13-65"><a href="#cb13-65" tabindex="-1"></a><span class="fu">ggplot</span>(results_df, <span class="fu">aes</span>(<span class="at">x =</span> t_n, <span class="at">y =</span> average_time)) <span class="sc">+</span></span>
<span id="cb13-66"><a href="#cb13-66" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb13-67"><a href="#cb13-67" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb13-68"><a href="#cb13-68" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;t_n = n log(n)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Average Sorting Time (seconds)&quot;</span>, </span>
<span id="cb13-69"><a href="#cb13-69" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Average Sorting Time vs. t_n&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-70"><a href="#cb13-70" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb13-71"><a href="#cb13-71" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#The plot show regression fitted line</span></span></code></pre></div>
<p>You performed a linear regression analysis to model the relationship
between the average computation time () and <span class="math display">\[
t_n = n \log(n),
\]</span> where <span class="math inline">\(n\)</span> represents
different sizes of input for a sorting algorithm.</p>
<p>Overall, the results suggest a strong and statistically significant
relationship between the average computation time and <span class="math inline">\(t_n\)</span>. The high R-squared values imply that
the model explains a large portion of the variance in computation time,
and the significance of the <span class="math inline">\(t_n\)</span>
coefficient indicates that the computation time grows as <span class="math inline">\(n \log(n)\)</span> increases, consistent with
theoretical expectations for sorting algorithms.</p>
</div>
<div id="homework-3-page-180-181-statistical-computing-with-r." class="section level2">
<h2>Homework 3 (page 180-181, Statistical Computing with R).</h2>
</div>
<div id="question-6.6" class="section level2">
<h2>Question 6.6</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment. Compute the standard error of the estimates from
equation (2.14) using the normal approximation for the density (with
exact variance formula). Compare the estimated quantiles with the
quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_1} \approx N(0, \sqrt{6/n})\)</span>.</p>
</div>
<div id="answer-6.6" class="section level2">
<h2>Answer 6.6</h2>
<p>To estimate the quantiles of the skewness statistic <span class="math inline">\(\sqrt{b_1}\)</span> under normality using a Monte
Carlo experiment and compare them with the large sample approximation,
we’ll proceed with the following steps:</p>
<p>I’ll outline the theoretical aspect and computations so you can
perform them step-by-step using a suitable programming tool like Python
or R.</p>
<p>For each generated sample <span class="math inline">\(X_1, X_2,
\dots, X_n\)</span>, the skewness is calculated as: <span class="math display">\[
b_1 = \frac{1}{n} \sum_{i=1}^{n} \left( \frac{X_i - \bar{X}}{s}
\right)^3
\]</span> where <span class="math inline">\(\bar{X}\)</span> is the
sample mean and <span class="math inline">\(s\)</span> is the sample
standard deviation.</p>
<p>The standard error for the skewness using the normal approximation
is: <span class="math display">\[
\text{Standard Error} = \sqrt{\frac{6}{n}}
\]</span></p>
<p>After generating the skewness values, you can estimate the quantiles
using empirical quantile functions.</p>
<p>Compute these quantiles using the normal distribution: <span class="math display">\[
\text{Quantiles} = N(0, \sqrt{6/n})
\]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># Set the random seed for reproducibility</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of Monte Carlo simulations</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span>     <span class="co"># Size of each sample</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co"># Storage for skewness values</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>skewness_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co"># Function to calculate skewness</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>calculate_skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>  mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>  sd_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>  skewness <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> mean_x)<span class="sc">^</span><span class="dv">3</span>) <span class="sc">/</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sd_x<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>  <span class="fu">return</span>(skewness)</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>}</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co"># Run Monte Carlo simulation</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(sample_size)  <span class="co"># Generate normal samples</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>  skewness <span class="ot">&lt;-</span> <span class="fu">calculate_skewness</span>(sample)  <span class="co"># Calculate skewness</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>  skewness_values[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(skewness))  <span class="co"># Store the square root of the skewness</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>}</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="co"># Estimate quantiles from the Monte Carlo simulation</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>quantiles_estimated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(skewness_values, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>))</span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a><span class="co"># Calculate the standard error using the normal approximation</span></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>standard_error <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> sample_size)</span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="co"># Theoretical quantiles using the normal approximation</span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>quantiles_theoretical <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> standard_error)</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a></span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a>  <span class="at">Estimated_Quantiles =</span> quantiles_estimated,</span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>  <span class="at">Standard_Error =</span> standard_error,</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>  <span class="at">Theoretical_Quantiles =</span> quantiles_theoretical</span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>)</span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a><span class="co">#&gt; $Estimated_Quantiles</span></span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a><span class="co">#&gt;      2.5%        5%       95%     97.5% </span></span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a><span class="co">#&gt; 0.1072480 0.1556041 0.8953450 0.9652652 </span></span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a><span class="co">#&gt; $Standard_Error</span></span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a><span class="co">#&gt; [1] 0.4472136</span></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a><span class="co">#&gt; $Theoretical_Quantiles</span></span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a><span class="co">#&gt; [1] -0.8765225 -0.7356009  0.7356009  0.8765225</span></span></code></pre></div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in . Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X, Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># Set the random seed for reproducibility</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of simulations</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span>     <span class="co"># Sample size for each test</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>         <span class="co"># Significance level</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co"># Function to calculate the power of a test</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>calculate_power <span class="ot">&lt;-</span> <span class="cf">function</span>(p_values, alpha) {</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(p_values <span class="sc">&lt;</span> alpha))</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>}</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co"># Storage for p-values</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>p_values_pearson <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>p_values_spearman <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>p_values_kendall <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co"># Simulate samples from a bivariate normal distribution</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>  <span class="co"># Generate a bivariate normal sample with correlation 0.5</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(sample_size)</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rnorm</span>(sample_size)</span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>  </span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>  <span class="co"># Pearson&#39;s correlation test</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>  p_values_pearson[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>  </span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>  <span class="co"># Spearman&#39;s rank correlation test</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>  p_values_spearman[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>  </span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>  <span class="co"># Kendall&#39;s tau test</span></span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a>  p_values_kendall[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a>}</span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a><span class="co"># Calculate empirical power for each test under bivariate normal distribution</span></span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a>power_pearson <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(p_values_pearson, alpha)</span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a>power_spearman <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(p_values_spearman, alpha)</span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a>power_kendall <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(p_values_kendall, alpha)</span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a></span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a><span class="co"># Display the power of each test</span></span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb16-43"><a href="#cb16-43" tabindex="-1"></a>  <span class="at">Power_Pearson =</span> power_pearson,</span>
<span id="cb16-44"><a href="#cb16-44" tabindex="-1"></a>  <span class="at">Power_Spearman =</span> power_spearman,</span>
<span id="cb16-45"><a href="#cb16-45" tabindex="-1"></a>  <span class="at">Power_Kendall =</span> power_kendall</span>
<span id="cb16-46"><a href="#cb16-46" tabindex="-1"></a>)</span>
<span id="cb16-47"><a href="#cb16-47" tabindex="-1"></a><span class="co">#&gt; $Power_Pearson</span></span>
<span id="cb16-48"><a href="#cb16-48" tabindex="-1"></a><span class="co">#&gt; [1] 0.8316</span></span>
<span id="cb16-49"><a href="#cb16-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-50"><a href="#cb16-50" tabindex="-1"></a><span class="co">#&gt; $Power_Spearman</span></span>
<span id="cb16-51"><a href="#cb16-51" tabindex="-1"></a><span class="co">#&gt; [1] 0.7715</span></span>
<span id="cb16-52"><a href="#cb16-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-53"><a href="#cb16-53" tabindex="-1"></a><span class="co">#&gt; $Power_Kendall</span></span>
<span id="cb16-54"><a href="#cb16-54" tabindex="-1"></a><span class="co">#&gt; [1] 0.7687</span></span>
<span id="cb16-55"><a href="#cb16-55" tabindex="-1"></a></span>
<span id="cb16-56"><a href="#cb16-56" tabindex="-1"></a><span class="co"># Alternative distribution: Bivariate example with a monotonic relationship</span></span>
<span id="cb16-57"><a href="#cb16-57" tabindex="-1"></a>p_values_pearson_alt <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb16-58"><a href="#cb16-58" tabindex="-1"></a>p_values_spearman_alt <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb16-59"><a href="#cb16-59" tabindex="-1"></a>p_values_kendall_alt <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb16-60"><a href="#cb16-60" tabindex="-1"></a></span>
<span id="cb16-61"><a href="#cb16-61" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb16-62"><a href="#cb16-62" tabindex="-1"></a>  <span class="co"># Generate a bivariate distribution with a monotonic but nonlinear relationship</span></span>
<span id="cb16-63"><a href="#cb16-63" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(sample_size)</span>
<span id="cb16-64"><a href="#cb16-64" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(sample_size, <span class="at">sd =</span> <span class="fl">0.1</span>)  <span class="co"># Quadratic relationship introduces nonlinearity</span></span>
<span id="cb16-65"><a href="#cb16-65" tabindex="-1"></a>  </span>
<span id="cb16-66"><a href="#cb16-66" tabindex="-1"></a>  <span class="co"># Pearson&#39;s correlation test</span></span>
<span id="cb16-67"><a href="#cb16-67" tabindex="-1"></a>  p_values_pearson_alt[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb16-68"><a href="#cb16-68" tabindex="-1"></a>  </span>
<span id="cb16-69"><a href="#cb16-69" tabindex="-1"></a>  <span class="co"># Spearman&#39;s rank correlation test</span></span>
<span id="cb16-70"><a href="#cb16-70" tabindex="-1"></a>  p_values_spearman_alt[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb16-71"><a href="#cb16-71" tabindex="-1"></a>  </span>
<span id="cb16-72"><a href="#cb16-72" tabindex="-1"></a>  <span class="co"># Kendall&#39;s tau test</span></span>
<span id="cb16-73"><a href="#cb16-73" tabindex="-1"></a>  p_values_kendall_alt[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb16-74"><a href="#cb16-74" tabindex="-1"></a>}</span>
<span id="cb16-75"><a href="#cb16-75" tabindex="-1"></a></span>
<span id="cb16-76"><a href="#cb16-76" tabindex="-1"></a><span class="co"># Calculate empirical power for each test under the alternative distribution</span></span>
<span id="cb16-77"><a href="#cb16-77" tabindex="-1"></a>power_pearson_alt <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(p_values_pearson_alt, alpha)</span>
<span id="cb16-78"><a href="#cb16-78" tabindex="-1"></a>power_spearman_alt <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(p_values_spearman_alt, alpha)</span>
<span id="cb16-79"><a href="#cb16-79" tabindex="-1"></a>power_kendall_alt <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(p_values_kendall_alt, alpha)</span>
<span id="cb16-80"><a href="#cb16-80" tabindex="-1"></a></span>
<span id="cb16-81"><a href="#cb16-81" tabindex="-1"></a><span class="co"># Display the power of each test for the alternative distribution</span></span>
<span id="cb16-82"><a href="#cb16-82" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb16-83"><a href="#cb16-83" tabindex="-1"></a>  <span class="at">Power_Pearson_Alternative =</span> power_pearson_alt,</span>
<span id="cb16-84"><a href="#cb16-84" tabindex="-1"></a>  <span class="at">Power_Spearman_Alternative =</span> power_spearman_alt,</span>
<span id="cb16-85"><a href="#cb16-85" tabindex="-1"></a>  <span class="at">Power_Kendall_Alternative =</span> power_kendall_alt</span>
<span id="cb16-86"><a href="#cb16-86" tabindex="-1"></a>)</span>
<span id="cb16-87"><a href="#cb16-87" tabindex="-1"></a><span class="co">#&gt; $Power_Pearson_Alternative</span></span>
<span id="cb16-88"><a href="#cb16-88" tabindex="-1"></a><span class="co">#&gt; [1] 0.3747</span></span>
<span id="cb16-89"><a href="#cb16-89" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-90"><a href="#cb16-90" tabindex="-1"></a><span class="co">#&gt; $Power_Spearman_Alternative</span></span>
<span id="cb16-91"><a href="#cb16-91" tabindex="-1"></a><span class="co">#&gt; [1] 0.1382</span></span>
<span id="cb16-92"><a href="#cb16-92" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-93"><a href="#cb16-93" tabindex="-1"></a><span class="co">#&gt; $Power_Kendall_Alternative</span></span>
<span id="cb16-94"><a href="#cb16-94" tabindex="-1"></a><span class="co">#&gt; [1] 0.2208</span></span></code></pre></div>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level. I What is the corresponding hypothesis test problem? I What test
should we use? Z-test, two-sample t-test, paired-t test or McNemar test?
Why? I Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments, say, 0.651 for one method and 0.676 for
another method, we want to know if the powers are different at the 0.05
significance level.</p>
<p>The hypotheses for this test are: <span class="math display">\[\begin{align*}
H_0 &amp;: p_1 = p_2 \quad \text{(The powers of the two methods are
equal)} \\
H_1 &amp;: p_1 \neq p_2 \quad \text{(The powers of the two methods are
different)}
\end{align*}\]</span> where <span class="math inline">\(p_1\)</span> and
<span class="math inline">\(p_2\)</span> represent the powers of the
first and second methods, respectively.</p>
<p>We use the because we are comparing proportions from independent
samples. Other tests like the t-tests or McNemar’s test are not suitable
for this scenario.</p>
<p>The sample sizes for both methods are: <span class="math display">\[
n_1 = n_2 = 10,000
\]</span> The number of successes (rejections) for each method can be
calculated as: <span class="math display">\[\begin{align*}
\text{Successes for method 1} &amp;= p_1 \times n_1 = 0.651 \times
10,000 = 6,510 \\
\text{Successes for method 2} &amp;= p_2 \times n_2 = 0.676 \times
10,000 = 6,760
\end{align*}\]</span></p>
<p>The Z-statistic is calculated using the formula: <span class="math display">\[
Z = \frac{(\hat{p}_1 - \hat{p}_2)}{\sqrt{\hat{p}(1 - \hat{p}) \left(
\frac{1}{n_1} + \frac{1}{n_2} \right)}}
\]</span> where: <span class="math display">\[
\hat{p} = \frac{\text{successes}_1 + \text{successes}_2}{n_1 + n_2} =
\frac{6,510 + 6,760}{20,000} = 0.6635
\]</span></p>
<p>The standard error is: <span class="math display">\[
\text{Standard Error} = \sqrt{0.6635 \times (1 - 0.6635) \times \left(
\frac{1}{10,000} + \frac{1}{10,000} \right)} = \sqrt{0.000044623}
\approx 0.00668
\]</span></p>
<p>The Z-statistic is then: <span class="math display">\[
Z = \frac{0.651 - 0.676}{0.00668} = \frac{-0.025}{0.00668} \approx -3.74
\]</span></p>
<p>The p-value for the Z-statistic of <span class="math inline">\(-3.74\)</span> in a two-tailed test is: <span class="math display">\[
p\text{-value} = 2 \times P(Z &lt; -3.74) \approx 2 \times 0.00009 =
0.00018
\]</span></p>
<p>Since the p-value <span class="math inline">\(0.00018\)</span> is
less than the significance level <span class="math inline">\(0.05\)</span>, we reject the null hypothesis and
conclude that there is a statistically significant difference between
the powers of the two methods.</p>
<ul>
<li>: Two-sample proportion Z-test.</li>
<li>: <span class="math inline">\(p_1 = p_2\)</span>.</li>
<li>: <span class="math inline">\(p_1 \neq p_2\)</span>.</li>
<li>: <span class="math inline">\(n_1 = n_2 = 10,000\)</span>.</li>
<li>: <span class="math inline">\(p_1 = 0.651\)</span> and <span class="math inline">\(p_2 = 0.676\)</span>.</li>
<li>: <span class="math inline">\(-3.74\)</span>.</li>
<li>: <span class="math inline">\(0.00018\)</span>.</li>
</ul>
<p>The significant result indicates that the difference in power between
the two methods is statistically significant at the 0.05 level.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ol style="list-style-type: decimal">
<li>Admin. (2021). Standard Error | Definition, Formula for Mean and
Estimate, Calculation &amp; Example. BYJU’S. <a href="https://byjus.com/maths/standard-error/" class="uri">https://byjus.com/maths/standard-error/</a></li>
<li>James Lani. (2024). Pearson Correlation Assumptions. Statistics
Solutions. <a href="https://www.statisticssolutions.com/pearson-product-moment-correlation/" class="uri">https://www.statisticssolutions.com/pearson-product-moment-correlation/</a></li>
<li>Correlation. (2016). bu.edu. <a href="https://sphweb.bumc.bu.edu/otlt/MPH-Modules/BS/R/R5_Correlation-Regression/R5_Correlation-Regression3.html" class="uri">https://sphweb.bumc.bu.edu/otlt/MPH-Modules/BS/R/R5_Correlation-Regression/R5_Correlation-Regression3.html</a></li>
<li>Hypothesis testing and power. (2023). ouhsc.edu. <a href="https://ouhsc.edu/bserdac/dthompso/web/CDM/power/hypoth.htm" class="uri">https://ouhsc.edu/bserdac/dthompso/web/CDM/power/hypoth.htm</a></li>
</ol>
</div>
<div id="classwork-data" class="section level2">
<h2>Classwork Data</h2>
<p>d1 &lt;- c(-2.961, 0.478, -0.391, -0.869, -0.460, -0.937, 0.779,
-1.409, 0.027, -1.569) d2 &lt;- c(1.608, 1.009, 0.878, 1.600, -0.263,
0.680, 2.280, 2.390, 1.793, 8.091, 1.468)</p>
</div>
<div id="the-answer-of-original-statistic-sample-standard-error-and-bootstrap-standard-error-are-summarized-below" class="section level2">
<h2>The answer of original statistic, sample standard error, and
bootstrap standard error are summarized below</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Data vectors</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>, <span class="fl">0.878</span>, <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>, <span class="fl">0.680</span>, <span class="fl">2.280</span>, <span class="fl">2.390</span>, <span class="fl">1.793</span>, <span class="fl">8.091</span>, <span class="fl">1.468</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co"># Original statistic: mean difference</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>mean_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(d1) <span class="sc">-</span> <span class="fu">mean</span>(d2)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co"># Sample standard error of the mean difference</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(d1)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(d2)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>sample_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(d1) <span class="sc">/</span> n1 <span class="sc">+</span> <span class="fu">var</span>(d2) <span class="sc">/</span> n2)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co"># Bootstrap procedure</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>boot_diff <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co"># Setting a seed for reproducibility</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>boot_sample_d1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(d1, n1, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>boot_sample_d2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(d2, n2, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>boot_diff[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_sample_d1) <span class="sc">-</span> <span class="fu">mean</span>(boot_sample_d2)</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>}</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co"># Bootstrap standard error</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>bootstrap_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_diff)</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co"># Output the results</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Original Mean Difference:&quot;</span>, mean_diff, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; Original Mean Difference: -2.688836</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample Standard Error:&quot;</span>, sample_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; Sample Standard Error: 0.7393791</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap Standard Error:&quot;</span>, bootstrap_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co">#&gt; Bootstrap Standard Error: 0.7139026</span></span></code></pre></div>
</div>
<div id="homework-4-pages-212-statistical-computating-with-r." class="section level2">
<h2>Homework 4 (pages 212, Statistical Computating with R).</h2>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Of N = 1000 hypotheses, 950 are null and 50 are alternative. The
p-value under any null hypothesis is uniformly distributed (use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level α = 0.1 for each of the two adjustment methods
based on m = 10000 simulation replicates. You should output the 6
numbers (3 ) to a 3 × 2 table (column names: Bonferroni correction, B-H
correction; row names: FWER, FDR, TPR). Comment the results.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>   <span class="co"># Total number of hypotheses</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of simulation replicates</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>  <span class="co"># Nominal significance level</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>num_null <span class="ot">&lt;-</span> <span class="dv">950</span>  <span class="co"># Number of null hypotheses</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>num_alt <span class="ot">&lt;-</span> <span class="dv">50</span>   <span class="co"># Number of alternative hypotheses</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co"># Vectors to store FWER, FDR, and TPR for each correction method</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>fwer_bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>fdr_bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>tpr_bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>fwer_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>fdr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>tpr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co"># Simulation loop</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>  <span class="co"># Generate p-values for null hypotheses (uniform distribution)</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>  pvals_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(num_null)</span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>  </span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>  <span class="co"># Generate p-values for alternative hypotheses (beta distribution)</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a>  pvals_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(num_alt, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a>  </span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>  <span class="co"># Combine all p-values</span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a>  pvals <span class="ot">&lt;-</span> <span class="fu">c</span>(pvals_null, pvals_alt)</span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a>  </span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a>  <span class="co"># Apply Bonferroni correction</span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a>  pvals_bonf <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pvals, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a>  rejections_bonf <span class="ot">&lt;-</span> <span class="fu">which</span>(pvals_bonf <span class="sc">&lt;</span> alpha)</span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a>  </span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a>  <span class="co"># Apply Benjamini-Hochberg correction</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a>  pvals_bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pvals, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a>  rejections_bh <span class="ot">&lt;-</span> <span class="fu">which</span>(pvals_bh <span class="sc">&lt;</span> alpha)</span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a>  </span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a>  <span class="co"># Calculate FWER, FDR, and TPR for Bonferroni correction</span></span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a>  num_false_rejections_bonf <span class="ot">&lt;-</span> <span class="fu">sum</span>(rejections_bonf <span class="sc">&lt;=</span> num_null)</span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a>  num_true_rejections_bonf <span class="ot">&lt;-</span> <span class="fu">sum</span>(rejections_bonf <span class="sc">&gt;</span> num_null)</span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a>  </span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a>  fwer_bonf[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(num_false_rejections_bonf <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a>  fdr_bonf[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(rejections_bonf) <span class="sc">&gt;</span> <span class="dv">0</span>, num_false_rejections_bonf <span class="sc">/</span> <span class="fu">length</span>(rejections_bonf), <span class="dv">0</span>)</span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a>  tpr_bonf[i] <span class="ot">&lt;-</span> num_true_rejections_bonf <span class="sc">/</span> num_alt</span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a>  </span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a>  <span class="co"># Calculate FWER, FDR, and TPR for Benjamini-Hochberg correction</span></span>
<span id="cb18-49"><a href="#cb18-49" tabindex="-1"></a>  num_false_rejections_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(rejections_bh <span class="sc">&lt;=</span> num_null)</span>
<span id="cb18-50"><a href="#cb18-50" tabindex="-1"></a>  num_true_rejections_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(rejections_bh <span class="sc">&gt;</span> num_null)</span>
<span id="cb18-51"><a href="#cb18-51" tabindex="-1"></a>  </span>
<span id="cb18-52"><a href="#cb18-52" tabindex="-1"></a>  fwer_bh[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(num_false_rejections_bh <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb18-53"><a href="#cb18-53" tabindex="-1"></a>  fdr_bh[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(rejections_bh) <span class="sc">&gt;</span> <span class="dv">0</span>, num_false_rejections_bh <span class="sc">/</span> <span class="fu">length</span>(rejections_bh), <span class="dv">0</span>)</span>
<span id="cb18-54"><a href="#cb18-54" tabindex="-1"></a>  tpr_bh[i] <span class="ot">&lt;-</span> num_true_rejections_bh <span class="sc">/</span> num_alt</span>
<span id="cb18-55"><a href="#cb18-55" tabindex="-1"></a>}</span>
<span id="cb18-56"><a href="#cb18-56" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" tabindex="-1"></a><span class="co"># Calculate average FWER, FDR, and TPR over all simulations for both methods</span></span>
<span id="cb18-58"><a href="#cb18-58" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(fwer_bonf), <span class="fu">mean</span>(fdr_bonf), <span class="fu">mean</span>(tpr_bonf),</span>
<span id="cb18-59"><a href="#cb18-59" tabindex="-1"></a>                    <span class="fu">mean</span>(fwer_bh), <span class="fu">mean</span>(fdr_bh), <span class="fu">mean</span>(tpr_bh)),</span>
<span id="cb18-60"><a href="#cb18-60" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-61"><a href="#cb18-61" tabindex="-1"></a></span>
<span id="cb18-62"><a href="#cb18-62" tabindex="-1"></a><span class="co"># Create a table with appropriate row and column names</span></span>
<span id="cb18-63"><a href="#cb18-63" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb18-64"><a href="#cb18-64" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni Correction&quot;</span>, <span class="st">&quot;B-H Correction&quot;</span>)</span>
<span id="cb18-65"><a href="#cb18-65" tabindex="-1"></a></span>
<span id="cb18-66"><a href="#cb18-66" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb18-67"><a href="#cb18-67" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Results:&quot;</span>)</span>
<span id="cb18-68"><a href="#cb18-68" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Results:&quot;</span></span>
<span id="cb18-69"><a href="#cb18-69" tabindex="-1"></a><span class="fu">print</span>(results)</span>
<span id="cb18-70"><a href="#cb18-70" tabindex="-1"></a><span class="co">#&gt;      Bonferroni Correction B-H Correction</span></span>
<span id="cb18-71"><a href="#cb18-71" tabindex="-1"></a><span class="co">#&gt; FWER           0.087300000     0.93050000</span></span>
<span id="cb18-72"><a href="#cb18-72" tabindex="-1"></a><span class="co">#&gt; FDR            0.004510088     0.09502215</span></span>
<span id="cb18-73"><a href="#cb18-73" tabindex="-1"></a><span class="co">#&gt; TPR            0.396736000     0.56106200</span></span></code></pre></div>
</div>
<div id="explaination-of-the-results" class="section level2">
<h2>Explaination of the results</h2>
<ul>
<li>Family-Wise Error Rate (FWER)</li>
</ul>
<p>The Family-Wise Error Rate (FWER) for the Bonferroni correction is
0.087, while for the B-H correction, it is 0.93. The Bonferroni
correction is designed to control FWER by being conservative, hence it
shows a slightly lower value compared to the B-H method, which maintains
the nominal level of significance more closely due to its more stringent
nature.</p>
<ul>
<li>False Discovery Rate (FDR)</li>
</ul>
<p>For the False Discovery Rate (FDR), the Bonferroni correction yields
0.045, and the B-H correction results in 0.095. The B-H method allows
for a higher FDR, reflecting its characteristic of being less
conservative and potentially allowing more false discoveries while still
controlling for multiple testing to some extent.</p>
<ul>
<li>True Positive Rate (TPR)</li>
</ul>
<p>The True Positive Rate (TPR) is estimated to be 0.40 for the
Bonferroni correction and 0.56 for the B-H correction. The B-H method
tends to detect more true positives compared to the Bonferroni
correction due to its ability to maintain a higher level of
significance, therefore, it is successfully identifying more alternative
hypotheses.</p>
<ul>
<li>Conclusion on the Results</li>
</ul>
<p>The results demonstrate the trade-offs between the two methods of
adjustment. The Bonferroni correction provides a less stringent control
over the all but at the expense of reducing TPR, which may lead to
higher risk of Type II errors. The B-H method, in contrast, provides
better TPR and allows for more discoveries but increases the FDR.</p>
</div>
<div id="question-7.4" class="section level2">
<h2>Question 7.4</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
airconditioning equipment [63, Example 1.1]: 3, 5, 7, 18, 43, 85, 91,
98, 100, 130, 230, 487. Assume that the times between failures follow an
exponential model Exp(λ). Obtain the MLE of the hazard rate λ and use
bootstrap to estimate the bias and standard error of the estimate.</p>
</div>
<div id="answers-7.4" class="section level2">
<h2>Answers 7.4</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co"># Load the required libraries</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co"># Air-conditioning data</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>aircondit_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co"># MLE estimation of lambda (hazard rate) for exponential distribution</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>mle_lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(aircondit_data)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE of lambda:&quot;</span>, mle_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; MLE of lambda: 0.00925212</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co"># Define a function to compute the MLE of lambda from a sample</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(sample_data))</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>}</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co"># Bootstrap to estimate the bias and standard error</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>bootstrap_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> aircondit_data, <span class="at">statistic =</span> lambda_mle, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="co"># Display bootstrap results</span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap estimate of bias:&quot;</span>, <span class="fu">mean</span>(bootstrap_results<span class="sc">$</span>t) <span class="sc">-</span> mle_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a><span class="co">#&gt; Bootstrap estimate of bias: 0.00151119</span></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap estimate of standard error:&quot;</span>, <span class="fu">sd</span>(bootstrap_results<span class="sc">$</span>t), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a><span class="co">#&gt; Bootstrap estimate of standard error: 0.004217765</span></span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a><span class="co"># Plot the bootstrap distribution</span></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a><span class="fu">plot</span>(bootstrap_results, <span class="at">main =</span> <span class="st">&quot;Bootstrap Distribution of MLE of Lambda&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question7.5" class="section level2">
<h2>Question7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
</div>
<div id="answers-7.5" class="section level2">
<h2>Answers 7.5</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co"># Load the required libraries</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co"># Air-conditioning data</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>aircondit_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co"># Define a function to compute the mean time between failures (1/lambda)</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>mean_time_failure <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(sample_data))</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>}</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co"># Perform bootstrap analysis</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>bootstrap_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> aircondit_data, <span class="at">statistic =</span> mean_time_failure, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co"># Compute 95% confidence intervals using different methods</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>ci_basic <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>ci_percentile <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>ci_bca <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% Bootstrap Confidence Intervals for Mean Time Between Failures (1/lambda):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="co">#&gt; 95% Bootstrap Confidence Intervals for Mean Time Between Failures (1/lambda):</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard Normal Method:&quot;</span>, ci_normal<span class="sc">$</span>normal[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co">#&gt; Standard Normal Method: 37.89861 182.5276</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Basic Method:&quot;</span>, ci_basic<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="co">#&gt; Basic Method: 32.6836 168.2415</span></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Percentile Method:&quot;</span>, ci_percentile<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a><span class="co">#&gt; Percentile Method: 47.92514 183.4831</span></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa Method:&quot;</span>, ci_bca<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a><span class="co">#&gt; BCa Method: 57.36206 217.5713</span></span></code></pre></div>
</div>
<div id="explaination" class="section level2">
<h2>Explaination</h2>
<ul>
<li><p>Standard Normal Method relies on the assumption that the
bootstrap distribution is approximately normal, which may not be
true.</p></li>
<li><p>Basic Method and Percentile Method take into account the
distribution shape, but the basic method uses the original estimate as a
reference point while the percentile method directly uses bootstrap
quantiles.</p></li>
<li><p>BCa Method adjusts for both bias and skewness in the bootstrap
distribution, making it more reliable when the bootstrap samples are
skewed.</p></li>
<li><p>The BCa method often provides more accurate intervals when there
is a non-normal distribution, while the other methods may be less
precise in such cases. Comparing the intervals helps assess the impact
of these factors on the confidence intervals</p></li>
</ul>
</div>
<div id="references-1" class="section level2">
<h2>References</h2>
<ul>
<li>Joram Soch. (2022). The p-value follows a uniform distribution under
the null hypothesis. The Book of Statistical Proofs. <a href="https://statproofbook.github.io/P/pval-h0.html" class="uri">https://statproofbook.github.io/P/pval-h0.html</a></li>
<li>GeeksforGeeks. (2022). Beta Distribution in R - GeeksforGeeks.
GeeksforGeeks. <a href="https://www.geeksforgeeks.org/beta-distribution-in-r/" class="uri">https://www.geeksforgeeks.org/beta-distribution-in-r/</a></li>
<li>Mark Miller. (2024). estimate alpha and beta from beta distribution
from a set of probabilities in R. Stack Overflow. <a href="https://stackoverflow.com/questions/76984811/estimate-alpha-and-beta-from-beta-distribution-from-a-set-of-probabilities-in-r" class="uri">https://stackoverflow.com/questions/76984811/estimate-alpha-and-beta-from-beta-distribution-from-a-set-of-probabilities-in-r</a></li>
</ul>
</div>
<div id="homework-5-pages-213-and-243-statistical-computing-with-r" class="section level2">
<h2>Homework 5 (pages 213 and 243, Statistical Computing with R)</h2>
<p>##Question 7.8</p>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-7.8" class="section level2">
<h2>Answer 7.8</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co">#Generate or use existing five-dimensional data matrix(example data)</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a> data_matrix<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="dv">5</span>),<span class="at">ncol=</span><span class="dv">5</span>) <span class="co">#100 observations,5 variables</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a> <span class="co">#Calculate the sample covariance matrix and eigenvalues for the original data</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a> cov_matrix<span class="ot">&lt;-</span><span class="fu">cov</span>(data_matrix)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a> eigenvalues<span class="ot">&lt;-</span><span class="fu">eigen</span>(cov_matrix)<span class="sc">$</span>values</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a> eigenvalues<span class="ot">&lt;-</span><span class="fu">sort</span>(eigenvalues,<span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a> <span class="co">#Sample estimate of theta</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a> theta_hat <span class="ot">&lt;-</span>eigenvalues[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigenvalues)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a> <span class="co">#Bootstrap Settings</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a> num_bootstrap<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a> theta_bootstrap<span class="ot">&lt;-</span><span class="fu">numeric</span>(num_bootstrap)</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a> <span class="co">#Bootstrap procedure</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_bootstrap){</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a> <span class="co">#Generate a bootstrap sample by resampling rows with replacement</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a> bootstrap_sample<span class="ot">&lt;-</span>data_matrix[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data_matrix),<span class="at">replace=</span><span class="cn">TRUE</span>),]</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a> <span class="co">#Calculate covariance matrix and eigenvalues for the bootstrap sample</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a> bootstrap_cov<span class="ot">&lt;-</span><span class="fu">cov</span>(bootstrap_sample)</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a> bootstrap_eigenvalues<span class="ot">&lt;-</span><span class="fu">eigen</span>(bootstrap_cov)<span class="sc">$</span>values</span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a> bootstrap_eigenvalues<span class="ot">&lt;-</span><span class="fu">sort</span>(bootstrap_eigenvalues,<span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a> <span class="co">#Calculate theta for the bootstrap sample</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a> theta_bootstrap[i]<span class="ot">&lt;-</span>bootstrap_eigenvalues[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(bootstrap_eigenvalues)</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a> }</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a> <span class="co">#Bootstrap bias and standard error</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a> bias_bootstrap<span class="ot">&lt;-</span><span class="fu">mean</span>(theta_bootstrap)<span class="sc">-</span>theta_hat</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a> standard_error_bootstrap<span class="ot">&lt;-</span><span class="fu">sd</span>(theta_bootstrap)</span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a> <span class="co">#Jackknife procedure</span></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a> n<span class="ot">&lt;-</span><span class="fu">nrow</span>(data_matrix)</span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a> theta_jackknife<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a> <span class="co">#Leave-one-outsample</span></span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a> jackknife_sample<span class="ot">&lt;-</span>data_matrix[<span class="sc">-</span>i,]</span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a> <span class="co">#Calculate covariance matrix and eigenvalues for the jackknife sample</span></span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a> jackknife_cov<span class="ot">&lt;-</span><span class="fu">cov</span>(jackknife_sample)</span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a> jackknife_eigenvalues<span class="ot">&lt;-</span><span class="fu">eigen</span>(jackknife_cov)<span class="sc">$</span>values</span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a> jackknife_eigenvalues<span class="ot">&lt;-</span><span class="fu">sort</span>(jackknife_eigenvalues,<span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a> <span class="co">#Calculate theta for the jackknife sample</span></span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a> theta_jackknife[i]<span class="ot">&lt;-</span>jackknife_eigenvalues[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(jackknife_eigenvalues)</span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a> }</span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a> <span class="co">#Jackknife bias and standard error</span></span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a> mean_theta_jackknife<span class="ot">&lt;-</span><span class="fu">mean</span>(theta_jackknife)</span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a> bias_jackknife<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(mean_theta_jackknife<span class="sc">-</span>theta_hat)</span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a> standard_error_jackknife<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta_jackknife<span class="sc">-</span>mean_theta_jackknife)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a> <span class="co">#Output results</span></span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a> <span class="fu">list</span>(</span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a> <span class="at">theta_hat =</span>theta_hat,</span>
<span id="cb21-48"><a href="#cb21-48" tabindex="-1"></a> <span class="at">bootstrap =</span><span class="fu">list</span>(<span class="at">bias=</span>bias_bootstrap,<span class="at">standard_error=</span>standard_error_bootstrap),</span>
<span id="cb21-49"><a href="#cb21-49" tabindex="-1"></a> <span class="at">jackknife=</span><span class="fu">list</span>(<span class="at">bias=</span>bias_jackknife,<span class="at">standard_error=</span>standard_error_jackknife)</span>
<span id="cb21-50"><a href="#cb21-50" tabindex="-1"></a> )</span>
<span id="cb21-51"><a href="#cb21-51" tabindex="-1"></a><span class="co">#&gt; $theta_hat</span></span>
<span id="cb21-52"><a href="#cb21-52" tabindex="-1"></a><span class="co">#&gt; [1] 0.2413916</span></span>
<span id="cb21-53"><a href="#cb21-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-54"><a href="#cb21-54" tabindex="-1"></a><span class="co">#&gt; $bootstrap</span></span>
<span id="cb21-55"><a href="#cb21-55" tabindex="-1"></a><span class="co">#&gt; $bootstrap$bias</span></span>
<span id="cb21-56"><a href="#cb21-56" tabindex="-1"></a><span class="co">#&gt; [1] 0.04634182</span></span>
<span id="cb21-57"><a href="#cb21-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-58"><a href="#cb21-58" tabindex="-1"></a><span class="co">#&gt; $bootstrap$standard_error</span></span>
<span id="cb21-59"><a href="#cb21-59" tabindex="-1"></a><span class="co">#&gt; [1] 0.0213022</span></span>
<span id="cb21-60"><a href="#cb21-60" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-61"><a href="#cb21-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-62"><a href="#cb21-62" tabindex="-1"></a><span class="co">#&gt; $jackknife</span></span>
<span id="cb21-63"><a href="#cb21-63" tabindex="-1"></a><span class="co">#&gt; $jackknife$bias</span></span>
<span id="cb21-64"><a href="#cb21-64" tabindex="-1"></a><span class="co">#&gt; [1] 0.08790778</span></span>
<span id="cb21-65"><a href="#cb21-65" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-66"><a href="#cb21-66" tabindex="-1"></a><span class="co">#&gt; $jackknife$standard_error</span></span>
<span id="cb21-67"><a href="#cb21-67" tabindex="-1"></a><span class="co">#&gt; [1] 0.01741762</span></span></code></pre></div>
</div>
<div id="question-7.10" class="section level2">
<h2>Question 7.10</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross-validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross-validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
</div>
<div id="answer-7.10" class="section level2">
<h2>Answer 7.10</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># Example data (replace with actual data if provided)</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a> y <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x<span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>) <span class="co"># Simulated cubic relationship</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a> <span class="co"># Prepare data frame</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a> data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a> <span class="co"># Define models</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a> models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a> <span class="at">linear =</span> <span class="cf">function</span>(data) <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data),</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a> <span class="at">quadratic =</span> <span class="cf">function</span>(data) <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> data),</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a> <span class="at">cubic =</span> <span class="cf">function</span>(data) <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> data),</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a> <span class="at">log_linear =</span> <span class="cf">function</span>(data) <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">log</span>(x), <span class="at">data =</span> data)</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a> )</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a> <span class="co"># Leave-One-Out Cross-Validation</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a> loo_cv_mse <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(model_func) {</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a> errors <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a> <span class="co"># Leave one out</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a> train_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>i, ]</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a> test_data <span class="ot">&lt;-</span> data[i, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a> <span class="co"># Fit model and predict left-out observation</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a> model <span class="ot">&lt;-</span> <span class="fu">model_func</span>(train_data)</span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a> prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test_data)</span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a> <span class="co"># Calculate squared error for left-out observation</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a> errors[i] <span class="ot">&lt;-</span> (test_data<span class="sc">$</span>y<span class="sc">-</span> prediction)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a> }</span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a> <span class="co"># Return mean squared error</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a> <span class="fu">mean</span>(errors)</span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a> })</span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a> <span class="co"># Fit models on entire dataset to get adjusted R^2 values</span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a> adjusted_r_squared <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(model_func) {</span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a> model <span class="ot">&lt;-</span> <span class="fu">model_func</span>(data)</span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a> <span class="fu">summary</span>(model)<span class="sc">$</span>adj.r.squared</span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a> })</span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a> <span class="co"># Find the best model according to LOO-CV MSE and adjusted R^2</span></span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a> best_model_loo <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which.min</span>(loo_cv_mse))</span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a> best_model_adj_r2 <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which.max</span>(adjusted_r_squared))</span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a> <span class="co"># Output results</span></span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a> <span class="fu">list</span>(</span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a> <span class="at">loo_cv_mse =</span> loo_cv_mse,</span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a> <span class="at">adjusted_r_squared =</span> adjusted_r_squared,</span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a> <span class="at">best_model_loo =</span> best_model_loo, <span class="at">best_model_adj_r2 =</span> best_model_adj_r2</span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a> )</span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a><span class="co">#&gt; $loo_cv_mse</span></span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a><span class="co">#&gt;     linear  quadratic      cubic log_linear </span></span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a><span class="co">#&gt;   8.860951   4.702982   3.929300  13.387477 </span></span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a><span class="co">#&gt; $adjusted_r_squared</span></span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a><span class="co">#&gt;     linear  quadratic      cubic log_linear </span></span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a><span class="co">#&gt;  0.6649643  0.8233524  0.8544300  0.4941953 </span></span>
<span id="cb22-53"><a href="#cb22-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-54"><a href="#cb22-54" tabindex="-1"></a><span class="co">#&gt; $best_model_loo</span></span>
<span id="cb22-55"><a href="#cb22-55" tabindex="-1"></a><span class="co">#&gt; [1] &quot;cubic&quot;</span></span>
<span id="cb22-56"><a href="#cb22-56" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-57"><a href="#cb22-57" tabindex="-1"></a><span class="co">#&gt; $best_model_adj_r2</span></span>
<span id="cb22-58"><a href="#cb22-58" tabindex="-1"></a><span class="co">#&gt; [1] &quot;cubic&quot;</span></span></code></pre></div>
</div>
<div id="question-8.1" class="section level2">
<h2>Question 8.1</h2>
<p>Implement the two-sample Cramér-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-8.1" class="section level2">
<h2>Answer 8.1</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a> <span class="co"># Load the chickwts data and examine its structure</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a> <span class="fu">data</span>(chickwts)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a> <span class="fu">attach</span>(chickwts)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a> <span class="fu">attributes</span>(chickwts)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; $names</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;weight&quot; &quot;feed&quot;  </span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; $class</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt; $row.names</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt; [51] 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a> chickwts<span class="sc">$</span>feed</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt;  [1] horsebean horsebean horsebean horsebean horsebean horsebean horsebean</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt;  [8] horsebean horsebean horsebean linseed   linseed   linseed   linseed  </span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt; [15] linseed   linseed   linseed   linseed   linseed   linseed   linseed  </span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt; [22] linseed   soybean   soybean   soybean   soybean   soybean   soybean  </span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt; [29] soybean   soybean   soybean   soybean   soybean   soybean   soybean  </span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt; [36] soybean   sunflower sunflower sunflower sunflower sunflower sunflower</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt; [43] sunflower sunflower sunflower sunflower sunflower sunflower meatmeal </span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt; [50] meatmeal  meatmeal  meatmeal  meatmeal  meatmeal  meatmeal  meatmeal </span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt; [57] meatmeal  meatmeal  meatmeal  casein    casein    casein    casein   </span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt; [64] casein    casein    casein    casein    casein    casein    casein   </span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="co">#&gt; [71] casein   </span></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="co">#&gt; Levels: casein horsebean linseed meatmeal soybean sunflower</span></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co"># Define the Cramér-von Mises permutation test function</span></span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a> Cvm.test_0 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">1000</span>) {</span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a> N <span class="ot">&lt;-</span> n <span class="sc">+</span> m</span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a> z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a> <span class="co"># Compute observed Cramér-von Mises statistic</span></span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a> Fn <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(i) <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> x)))</span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a> Gm <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(i) <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> y)))</span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a> cv1 <span class="ot">&lt;-</span> (n <span class="sc">*</span> m) <span class="sc">/</span> (n <span class="sc">+</span> m)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>((Fn<span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a> <span class="co"># Permutation test</span></span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a> cv_perm <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, {</span>
<span id="cb23-40"><a href="#cb23-40" tabindex="-1"></a> d <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb23-41"><a href="#cb23-41" tabindex="-1"></a> <span class="co"># Randomly permute the indices</span></span>
<span id="cb23-42"><a href="#cb23-42" tabindex="-1"></a> z_perm <span class="ot">&lt;-</span> z[d]</span>
<span id="cb23-43"><a href="#cb23-43" tabindex="-1"></a> x_perm <span class="ot">&lt;-</span> z_perm[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb23-44"><a href="#cb23-44" tabindex="-1"></a> y_perm <span class="ot">&lt;-</span> z_perm[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb23-45"><a href="#cb23-45" tabindex="-1"></a> <span class="co"># Compute the Cramér-von Mises statistic for permuted samples</span></span>
<span id="cb23-46"><a href="#cb23-46" tabindex="-1"></a> Fn_perm <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(i) <span class="fu">mean</span>(<span class="fu">as.integer</span>(z_perm[i] <span class="sc">&lt;=</span> x_perm)))</span>
<span id="cb23-47"><a href="#cb23-47" tabindex="-1"></a> Gm_perm <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(i) <span class="fu">mean</span>(<span class="fu">as.integer</span>(z_perm[i] <span class="sc">&lt;=</span> y_perm)))</span>
<span id="cb23-48"><a href="#cb23-48" tabindex="-1"></a> (n <span class="sc">*</span> m) <span class="sc">/</span> (n <span class="sc">+</span> m)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>((Fn_perm<span class="sc">-</span> Gm_perm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb23-49"><a href="#cb23-49" tabindex="-1"></a> })</span>
<span id="cb23-50"><a href="#cb23-50" tabindex="-1"></a> <span class="co"># Calculate p-value</span></span>
<span id="cb23-51"><a href="#cb23-51" tabindex="-1"></a> p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(cv_perm <span class="sc">&gt;=</span> cv1)</span>
<span id="cb23-52"><a href="#cb23-52" tabindex="-1"></a> <span class="co"># Return the observed statistic and p-value</span></span>
<span id="cb23-53"><a href="#cb23-53" tabindex="-1"></a> <span class="fu">list</span>(<span class="at">statistic =</span> cv1, <span class="at">p_value =</span> p_value)</span>
<span id="cb23-54"><a href="#cb23-54" tabindex="-1"></a> }</span>
<span id="cb23-55"><a href="#cb23-55" tabindex="-1"></a> <span class="co"># Extract soybean and linseed weights</span></span>
<span id="cb23-56"><a href="#cb23-56" tabindex="-1"></a> soybean_weights <span class="ot">&lt;-</span> chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]</span>
<span id="cb23-57"><a href="#cb23-57" tabindex="-1"></a> linseed_weights <span class="ot">&lt;-</span> chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]</span>
<span id="cb23-58"><a href="#cb23-58" tabindex="-1"></a> sunflower_weights <span class="ot">&lt;-</span> chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>]</span>
<span id="cb23-59"><a href="#cb23-59" tabindex="-1"></a> linseed_weights <span class="ot">&lt;-</span> chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]</span>
<span id="cb23-60"><a href="#cb23-60" tabindex="-1"></a> <span class="co"># Run the test</span></span>
<span id="cb23-61"><a href="#cb23-61" tabindex="-1"></a> result <span class="ot">&lt;-</span> <span class="fu">Cvm.test_0</span>(soybean_weights, linseed_weights)</span>
<span id="cb23-62"><a href="#cb23-62" tabindex="-1"></a> result</span>
<span id="cb23-63"><a href="#cb23-63" tabindex="-1"></a><span class="co">#&gt; $statistic</span></span>
<span id="cb23-64"><a href="#cb23-64" tabindex="-1"></a><span class="co">#&gt; [1] 0.1626162</span></span>
<span id="cb23-65"><a href="#cb23-65" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-66"><a href="#cb23-66" tabindex="-1"></a><span class="co">#&gt; $p_value</span></span>
<span id="cb23-67"><a href="#cb23-67" tabindex="-1"></a><span class="co">#&gt; [1] 0.369</span></span>
<span id="cb23-68"><a href="#cb23-68" tabindex="-1"></a></span>
<span id="cb23-69"><a href="#cb23-69" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">Cvm.test_0</span>(sunflower_weights,linseed_weights)</span>
<span id="cb23-70"><a href="#cb23-70" tabindex="-1"></a> result</span>
<span id="cb23-71"><a href="#cb23-71" tabindex="-1"></a><span class="co">#&gt; $statistic</span></span>
<span id="cb23-72"><a href="#cb23-72" tabindex="-1"></a><span class="co">#&gt; [1] 1.520833</span></span>
<span id="cb23-73"><a href="#cb23-73" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-74"><a href="#cb23-74" tabindex="-1"></a><span class="co">#&gt; $p_value</span></span>
<span id="cb23-75"><a href="#cb23-75" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
</div>
<div id="explaination-1" class="section level2">
<h2>Explaination</h2>
<ul>
<li>Soybean weigthts, compare to linseed Weights is not
significance.</li>
<li>Sunflower weights compare to listeed weights is significance</li>
</ul>
</div>
<div id="question8.2" class="section level2">
<h2>Question8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence[255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function corwith method=“spearman”.
Compare the achieved significance level of the permutation test with the
p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer8.2" class="section level2">
<h2>Answer8.2</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a> <span class="co">#Setup the Spearman rank correlation permutationtest function</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a> spearman_perm_test<span class="ot">&lt;-</span><span class="cf">function</span>(x,y,<span class="at">R=</span><span class="dv">1000</span>){</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a> <span class="co">#Calculate observed Spearman rank correlation</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a> observed_corr<span class="ot">&lt;-</span><span class="fu">cor</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a> <span class="co">#Initialize a vector to store permutation results</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a> permuted_corrs<span class="ot">&lt;-</span><span class="fu">numeric</span>(R)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a> <span class="co">#Generate permutation distribution by shufflingy</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a> <span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co">#for reproducibility</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a> y_permuted<span class="ot">&lt;-</span><span class="fu">sample</span>(y)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a> permuted_corrs[i]<span class="ot">&lt;-</span><span class="fu">cor</span>(x,y_permuted,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a> }</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a> <span class="co">#Calculatep-value for the two-sidedtest</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a> p_value<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">abs</span>(permuted_corrs)<span class="sc">&gt;=</span><span class="fu">abs</span>(observed_corr))</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a> <span class="co">#Return observed correlationand permutationp-value</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a> <span class="fu">list</span>(<span class="at">observed_correlation=</span>observed_corr,<span class="at">perm_p_value=</span>p_value)</span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a> }</span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a> <span class="co">#Generate some example data for x and y</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>)</span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a> y <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>)</span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a> <span class="co"># Run permutation test</span></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a> perm_test_result <span class="ot">&lt;-</span> <span class="fu">spearman_perm_test</span>(x, y)</span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a> <span class="co"># Use cor.test to get the traditional p-value for comparison</span></span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a> cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a> <span class="co"># Output both p-values for comparison</span></span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a> <span class="fu">list</span>(</span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a> <span class="at">observed_correlation =</span> perm_test_result<span class="sc">$</span>observed_correlation,</span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a> <span class="at">permutation_p_value =</span> perm_test_result<span class="sc">$</span>perm_p_value,</span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a> <span class="at">cor_test_p_value =</span> cor_test_result<span class="sc">$</span>p.value</span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a> )</span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a><span class="co">#&gt; $observed_correlation</span></span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a><span class="co">#&gt; [1] 0.3939933</span></span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-36"><a href="#cb24-36" tabindex="-1"></a><span class="co">#&gt; $permutation_p_value</span></span>
<span id="cb24-37"><a href="#cb24-37" tabindex="-1"></a><span class="co">#&gt; [1] 0.036</span></span>
<span id="cb24-38"><a href="#cb24-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-39"><a href="#cb24-39" tabindex="-1"></a><span class="co">#&gt; $cor_test_p_value</span></span>
<span id="cb24-40"><a href="#cb24-40" tabindex="-1"></a><span class="co">#&gt; [1] 0.03204408</span></span></code></pre></div>
</div>
<div id="homework-6-pages-277-278-statistical-computing-with-r." class="section level2">
<h2>Homework 6 (pages 277-278, Statistical Computing with R).</h2>
</div>
<div id="question-9.3" class="section level2">
<h2>Question 9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution. Recall that a Cauchy<span class="math inline">\((\theta,\eta)\)</span> distribution has density
function <span class="math display">\[
f(x) = \frac{1}{\theta \pi} \left(1 + \left(\frac{x -
\eta}{\theta}\right)^2\right) , \quad -\infty &lt; x &lt; \infty, \quad
\theta &gt; 0.
\]</span> The standard Cauchy has the Cauchy<span class="math inline">\((\theta = 1,\eta = 0)\)</span> density. (Note that
the standard Cauchy density is equal to the Student <span class="math inline">\(t\)</span> density with one degree of
freedom.)</p>
</div>
<div id="answer-9.3" class="section level2">
<h2>Answer 9.3</h2>
<p>To generate random variables from a standard Cauchy distribution
using the Metropolis-Hastings algorithm, we can follow these steps:</p>
<p>The target density function for the standard Cauchy distribution
<span class="math inline">\(f(x)\)</span> is given by: <span class="math display">\[
f(x) = \frac{1}{\pi (1 + x^2)}, \quad -\infty &lt; x &lt; \infty.
\]</span></p>
<p>A common choice for the proposal distribution <span class="math inline">\(q(x&#39;|x)\)</span> in the Metropolis-Hastings
algorithm is a symmetric distribution, such as a normal distribution
centered at the current state. For simplicity, we can use: <span class="math display">\[
q(x&#39;|x) = N(x, \sigma^2)
\]</span> where <span class="math inline">\(\sigma\)</span> is a small
positive number determining the step size.</p>
<p>-Start with an initial value {x_0}. - Propose a new state <span class="math inline">\(x&#39;\)</span> from the proposal distribution. -
Calculate the acceptance ratio: <span class="math display">\[
    \alpha = \frac{f(x&#39;)}{f(x)} \cdot
\frac{q(x|x&#39;)}{q(x&#39;|x)}.
    \]</span> Since <span class="math inline">\(q(x&#39;|x)\)</span> is
symmetric, this simplifies to: <span class="math display">\[
    \alpha = \frac{f(x&#39;)}{f(x)}.
    \]</span> - Accept the new state <span class="math inline">\(x&#39;\)</span> with probability <span class="math inline">\(\min(1, \alpha)\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#Metropolis-Hastings Algorithm for Standard Cauchy Distribution}</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co"># Set parameters</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">11000</span>     <span class="co"># Total number of iterations (including burn-in)</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co"># Standard deviation of the proposal distribution</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co"># Initialize</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>      <span class="co"># Initial value</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>accept_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co"># Metropolis-Hastings algorithm</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>  <span class="co"># Propose a new value from the proposal distribution (normal distribution)</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>  x_proposed <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x[t<span class="dv">-1</span>], <span class="at">sd =</span> sigma)</span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>  </span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>  <span class="co"># Compute acceptance probability</span></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a>  <span class="co"># For the standard Cauchy distribution, f(x) \propto 1 / (1 + x^2)</span></span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a>  f_current <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x[t<span class="dv">-1</span>]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a>  f_proposed <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x_proposed<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, f_proposed <span class="sc">/</span> f_current)</span>
<span id="cb25-26"><a href="#cb25-26" tabindex="-1"></a>  </span>
<span id="cb25-27"><a href="#cb25-27" tabindex="-1"></a>  <span class="co"># Accept or reject the proposed value</span></span>
<span id="cb25-28"><a href="#cb25-28" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb25-29"><a href="#cb25-29" tabindex="-1"></a>  <span class="cf">if</span> (u <span class="sc">&lt;=</span> alpha) {</span>
<span id="cb25-30"><a href="#cb25-30" tabindex="-1"></a>    x[t] <span class="ot">&lt;-</span> x_proposed  <span class="co"># Accept the proposal</span></span>
<span id="cb25-31"><a href="#cb25-31" tabindex="-1"></a>    accept_count <span class="ot">&lt;-</span> accept_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb25-32"><a href="#cb25-32" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb25-33"><a href="#cb25-33" tabindex="-1"></a>    x[t] <span class="ot">&lt;-</span> x[t<span class="dv">-1</span>]      <span class="co"># Reject the proposal</span></span>
<span id="cb25-34"><a href="#cb25-34" tabindex="-1"></a>  }</span>
<span id="cb25-35"><a href="#cb25-35" tabindex="-1"></a>}</span>
<span id="cb25-36"><a href="#cb25-36" tabindex="-1"></a></span>
<span id="cb25-37"><a href="#cb25-37" tabindex="-1"></a><span class="co"># Compute acceptance rate</span></span>
<span id="cb25-38"><a href="#cb25-38" tabindex="-1"></a>accept_rate <span class="ot">&lt;-</span> accept_count <span class="sc">/</span> (N <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb25-39"><a href="#cb25-39" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Acceptance rate:&quot;</span>, accept_rate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="co"># Discard burn-in samples</span></span>
<span id="cb25-40"><a href="#cb25-40" tabindex="-1"></a><span class="co">#&gt; Acceptance rate: 0.7738885</span></span>
<span id="cb25-41"><a href="#cb25-41" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> x[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb25-42"><a href="#cb25-42" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" tabindex="-1"></a><span class="co"># Compute deciles of the generated samples</span></span>
<span id="cb25-44"><a href="#cb25-44" tabindex="-1"></a>deciles_generated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x_samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb25-45"><a href="#cb25-45" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" tabindex="-1"></a><span class="co"># Compute theoretical deciles of the standard Cauchy distribution</span></span>
<span id="cb25-47"><a href="#cb25-47" tabindex="-1"></a>deciles_theoretical <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb25-48"><a href="#cb25-48" tabindex="-1"></a></span>
<span id="cb25-49"><a href="#cb25-49" tabindex="-1"></a><span class="co"># Compare the deciles</span></span>
<span id="cb25-50"><a href="#cb25-50" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-51"><a href="#cb25-51" tabindex="-1"></a>  <span class="at">Decile =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb25-52"><a href="#cb25-52" tabindex="-1"></a>  <span class="at">Generated =</span> deciles_generated,</span>
<span id="cb25-53"><a href="#cb25-53" tabindex="-1"></a>  <span class="at">Theoretical =</span> deciles_theoretical</span>
<span id="cb25-54"><a href="#cb25-54" tabindex="-1"></a>)</span>
<span id="cb25-55"><a href="#cb25-55" tabindex="-1"></a></span>
<span id="cb25-56"><a href="#cb25-56" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Comparison of Deciles:&quot;</span>) <span class="co"># Plotting the results</span></span>
<span id="cb25-57"><a href="#cb25-57" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Comparison of Deciles:&quot;</span></span>
<span id="cb25-58"><a href="#cb25-58" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))  <span class="co"># Set up plotting area</span></span>
<span id="cb25-59"><a href="#cb25-59" tabindex="-1"></a></span>
<span id="cb25-60"><a href="#cb25-60" tabindex="-1"></a><span class="co"># Histogram of the generated samples</span></span>
<span id="cb25-61"><a href="#cb25-61" tabindex="-1"></a><span class="fu">hist</span>(x_samples, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of Generated Samples&quot;</span>,</span>
<span id="cb25-62"><a href="#cb25-62" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>), <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb25-63"><a href="#cb25-63" tabindex="-1"></a></span>
<span id="cb25-64"><a href="#cb25-64" tabindex="-1"></a><span class="co"># Overlay the theoretical standard Cauchy density</span></span>
<span id="cb25-65"><a href="#cb25-65" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dcauchy</span>(x), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb25-66"><a href="#cb25-66" tabindex="-1"></a></span>
<span id="cb25-67"><a href="#cb25-67" tabindex="-1"></a><span class="co"># Q-Q plot to compare the distributions</span></span>
<span id="cb25-68"><a href="#cb25-68" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="fu">qcauchy</span>(<span class="fu">ppoints</span>(<span class="fu">length</span>(x_samples))), x_samples,</span>
<span id="cb25-69"><a href="#cb25-69" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;Q-Q Plot of Generated Samples vs. Standard Cauchy&quot;</span>,</span>
<span id="cb25-70"><a href="#cb25-70" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Theoretical Quantiles&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Sample Quantiles&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb25-71"><a href="#cb25-71" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-9.8" class="section level2">
<h2>Question 9.8</h2>
<p>This example appears in . Consider the bivariate density <span class="math display">\[
f(x, y) \propto n_x y^{x+a-1} (1 - y)^{n-x+b-1}, \quad x = 0, 1, \ldots,
n, \quad 0 \leq y \leq 1.
\]</span> It can be shown that for fixed <span class="math inline">\(a,
b, n\)</span>, the conditional distributions are <span class="math inline">\(Binomial (n, y)\)</span> and <span class="math inline">\(\text{Beta}(x+a, n-x+b)\)</span>. Use the Gibbs
sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
</div>
<div id="answer-9.8" class="section level2">
<h2>Answer 9.8</h2>
<p>To solve this problem, we’ll implement a Gibbs sampler for generating
samples from the bivariate density: <span class="math display">\[
f(x,y) \propto (n_x) y^x (1-y)^{n-x} (a-1)(1-b)^{b-1},
\]</span> where <span class="math inline">\(x = 0, 1, \ldots, n\)</span>
and <span class="math inline">\(0 \leq y \leq 1\)</span>.</p>
<p>The conditional distributions for this density are: <span class="math display">\[
x | y \sim \text{Binomial}(n,y)
\]</span> <span class="math display">\[
y | x \sim \text{Beta}(x+a,n-x+b)
\]</span></p>
<p>The Gibbs sampling process works by iteratively sampling each
variable from its conditional distribution given the other variable.
Here are the steps to set up the Gibbs sampler:</p>
<ul>
<li><p><strong>Initialize parameters:</strong> Set values for <span class="math inline">\(n\)</span>, <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and the number of iterations for the
Gibbs sampler.</p></li>
<li><p><strong>Initialize <span class="math inline">\(x\)</span> and
<span class="math inline">\(y\)</span>:</strong> Start with initial
values for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. These can be arbitrary but should be
within the valid range (e.g., <span class="math inline">\(x = 0\)</span>
and <span class="math inline">\(y = 0.5\)</span>). <strong>Iterate the
Gibbs sampler:</strong></p></li>
<li><p>Sample <span class="math inline">\(x\)</span> given <span class="math inline">\(y\)</span> from the Binomial distribution <span class="math inline">\(\text{Binomial}(n,y)\)</span>.</p></li>
<li><p>Sample <span class="math inline">\(y\)</span> given <span class="math inline">\(x\)</span> from the Beta distribution <span class="math inline">\(\text{Beta}(x+a,n-x+b)\)</span>. \end{itemize}
<strong>Store and analyze the samples:</strong> After generating a
sufficient number of samples, discard a few initial samples (burn-in) to
remove dependence on the initial values.</p></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Set parameters</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)    <span class="co"># For reproducibility</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>       <span class="co"># Total number of iterations</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># Burn-in period</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>          <span class="co"># Parameter of the Binomial distribution</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span>           <span class="co"># Beta distribution parameter</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span>           <span class="co"># Beta distribution parameter</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co"># Initialize storage for x and y</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span>                      <span class="co"># Starting value for y</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y[<span class="dv">1</span>])       <span class="co"># Sample initial x from Binomial(n, y[1])</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co"># Gibbs sampler</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a>  <span class="co"># Sample x given y</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a>  x[t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y[t <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>  </span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>  <span class="co"># Sample y given x</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>  y[t] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[t] <span class="sc">+</span> a, n <span class="sc">-</span> x[t] <span class="sc">+</span> b)</span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a>}</span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="co"># Discard burn-in samples</span></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> x[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> y[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a></span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a><span class="co"># Analyze the samples</span></span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a>mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x_samples)</span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a>var_x <span class="ot">&lt;-</span> <span class="fu">var</span>(x_samples)</span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(y_samples)</span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a>var_y <span class="ot">&lt;-</span> <span class="fu">var</span>(y_samples)</span>
<span id="cb26-35"><a href="#cb26-35" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated mean of x:&quot;</span>, mean_x, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) </span>
<span id="cb26-37"><a href="#cb26-37" tabindex="-1"></a><span class="co">#&gt; Estimated mean of x: 9.936222</span></span>
<span id="cb26-38"><a href="#cb26-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated variance of x:&quot;</span>, var_x, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) </span>
<span id="cb26-39"><a href="#cb26-39" tabindex="-1"></a><span class="co">#&gt; Estimated variance of x: 13.641</span></span>
<span id="cb26-40"><a href="#cb26-40" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated mean of y:&quot;</span>, mean_y, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) </span>
<span id="cb26-41"><a href="#cb26-41" tabindex="-1"></a><span class="co">#&gt; Estimated mean of y: 0.4972259</span></span>
<span id="cb26-42"><a href="#cb26-42" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated variance of y:&quot;</span>, var_y, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) </span>
<span id="cb26-43"><a href="#cb26-43" tabindex="-1"></a><span class="co">#&gt; Estimated variance of y: 0.02268271</span></span>
<span id="cb26-44"><a href="#cb26-44" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" tabindex="-1"></a><span class="co"># Plotting the results</span></span>
<span id="cb26-46"><a href="#cb26-46" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))  <span class="co"># Adjust margins: c(bottom, left, top, right)</span></span>
<span id="cb26-47"><a href="#cb26-47" tabindex="-1"></a></span>
<span id="cb26-48"><a href="#cb26-48" tabindex="-1"></a><span class="co"># Trace plots</span></span>
<span id="cb26-49"><a href="#cb26-49" tabindex="-1"></a><span class="fu">plot</span>(x_samples, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">main =</span> <span class="st">&quot;Trace Plot of x&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Iteration&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb26-50"><a href="#cb26-50" tabindex="-1"></a><span class="fu">plot</span>(y_samples, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">main =</span> <span class="st">&quot;Trace Plot of y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Iteration&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb26-51"><a href="#cb26-51" tabindex="-1"></a></span>
<span id="cb26-52"><a href="#cb26-52" tabindex="-1"></a><span class="co"># Histograms</span></span>
<span id="cb26-53"><a href="#cb26-53" tabindex="-1"></a><span class="fu">hist</span>(x_samples, <span class="at">breaks =</span> (n <span class="sc">+</span> <span class="dv">1</span>), <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of x&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb26-54"><a href="#cb26-54" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb26-55"><a href="#cb26-55" tabindex="-1"></a><span class="fu">hist</span>(y_samples, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb26-56"><a href="#cb26-56" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>) </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co"># Compute the correlation between x and y</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>cor_xy <span class="ot">&lt;-</span> <span class="fu">cor</span>(x_samples, y_samples)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated correlation between x and y:&quot;</span>, cor_xy, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#&gt; Estimated correlation between x and y: 0.8218289</span></span></code></pre></div>
<p>##Question 9.3 b</p>
<p>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(R &lt;
1.2\)</span>. Discard the first 1000 iterations of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution. Recall that a Cauchy<span class="math inline">\((\theta,\eta)\)</span> distribution has the
density function. <span class="math display">\[
f(x) = \frac{1}{\theta \pi \left(1 + \left(\frac{x -
\eta}{\theta}\right)^2\right)}, \quad -\infty &lt; x &lt; \infty, \quad
\theta &gt; 0.
\]</span> ## Answer 9.3 (b) To solve this problem, we will use the
Gelman-Rubin method to monitor convergence of a chain generated by an
MCMC sampler for the standard Cauchy distribution. The Gelman-Rubin
diagnostic, or <span class="math inline">\(\hat{R}\)</span>, is used to
assess the convergence of multiple chains in Markov Chain Monte Carlo
(MCMC) simulations. When <span class="math inline">\(\hat{R} \approx
1\)</span>, it suggests that the chains have converged to the target
distribution and to compute <span class="math inline">\(\hat{R}\)</span>:</p>
<ul>
<li>Run multiple chains (say, <span class="math inline">\(m\)</span>
chains) starting from different initial values.</li>
<li>Compute the within-chain variance <span class="math inline">\(W\)</span>: This is the average variance within
each chain.
<ul>
<li>Compute the between-chain variance <span class="math inline">\(B\)</span>: This is the variance of the means of
each chain, scaled by the number of iterations <span class="math inline">\(n\)</span>.</li>
<li>Calculate the estimated variance of the target distribution <span class="math inline">\(\hat{V}\)</span>: <span class="math display">\[
\hat{V} = \frac{n - 1}{n} W + \frac{1}{n} B
\]</span></li>
<li>Calculate <span class="math inline">\(\hat{R}\)</span>: <span class="math display">\[
\hat{R} = \frac{\hat{V}}{\sqrt{W}}
\]</span></li>
<li>If <span class="math inline">\(\hat{R} &lt; 1.2\)</span>, it is
generally considered an indication that the chains have converged to the
target distribution.</li>
</ul></li>
</ul>
<p>We want to simulate samples from a distribution, which is a Cauchy
distribution with parameters <span class="math inline">\(\theta =
1\)</span> and <span class="math inline">\(\eta = 0\)</span>: <span class="math display">\[
f(x) = \frac{1}{\pi(1 + x^2)}, \quad -\infty &lt; x &lt; \infty.
\]</span></p>
<ul>
<li><strong>Initialize Multiple Chains:</strong> Start multiple chains
with different initial values.</li>
<li><strong>Generate Samples:</strong> For each chain, use a method like
Metropolis-Hastings or Gibbs sampling to generate samples from the
Cauchy distribution.</li>
<li><strong>Compute <span class="math inline">\(\hat{R}\)</span>:</strong> After each set of
iterations, compute <span class="math inline">\(\hat{R}\)</span> using
the steps described above. Repeat until <span class="math inline">\(\hat{R} &lt; 1.2\)</span> for all chains.</li>
<li><strong>Discard Burn-in:</strong> Once convergence is achieved,
discard the first 1000 samples from each chain to ensure the samples are
not influenced by the initial values.</li>
<li><strong>Calculate Deciles of the Generated Observations:</strong>
After discarding burn-in, combine the samples from all chains and
calculate their deciles. The deciles are the quantiles that divide the
data into ten equal parts (0.1, 0.2, , 0.9).</li>
<li><strong>Calculate Theoretical Deciles of the Standard
Cauchy:</strong> For a standard Cauchy distribution, the theoretical
deciles can be obtained using the quantile function for the Cauchy
distribution: <span class="math display">\[
    Q(p) = \tan\left(\pi\left(p - \frac{1}{2}\right)\right)
    \]</span> or equivalently in statistical software, for <span class="math inline">\(p = 0.1, 0.2, \ldots, 0.9\)</span>.</li>
<li><strong>Compare Deciles:</strong> Compare the empirical deciles from
the generated observations with the theoretical deciles of the standard
Cauchy distribution. Ideally, they should be close if the samples have
converged to the correct target distribution.</li>
</ul>
<p>The solution to monitor convergence and compare deciles involves
these key mathematical steps:</p>
<ul>
<li>Compute the Gelman-Rubin statistic <span class="math inline">\(\hat{R}\)</span> until it falls below 1.2,
indicating convergence.</li>
<li>Discard the first 1000 samples from each chain as burn-in.</li>
<li>Calculate and compare the deciles of the remaining samples with the
theoretical deciles of the standard Cauchy distribution using its
quantile function.</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co"># Step 1: Define target density function for standard Cauchy</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> (pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>}</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co"># Metropolis-Hastings Algorithm for standard Cauchy</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma, initial) {</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>  </span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>    <span class="co"># Propose a new value from a normal distribution centered at the current value</span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>    x_new <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x[i<span class="dv">-1</span>], <span class="at">sd =</span> sigma)</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>    </span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>    <span class="co"># Calculate acceptance ratio</span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">f</span>(x_new) <span class="sc">/</span> <span class="fu">f</span>(x[i<span class="dv">-1</span>])</span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>    </span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>    <span class="co"># Accept or reject the new value</span></span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fu">min</span>(<span class="dv">1</span>, alpha)) {</span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x_new</span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb28-28"><a href="#cb28-28" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]  <span class="co"># Stay at the current value</span></span>
<span id="cb28-29"><a href="#cb28-29" tabindex="-1"></a>    }</span>
<span id="cb28-30"><a href="#cb28-30" tabindex="-1"></a>  }</span>
<span id="cb28-31"><a href="#cb28-31" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb28-32"><a href="#cb28-32" tabindex="-1"></a>}</span>
<span id="cb28-33"><a href="#cb28-33" tabindex="-1"></a></span>
<span id="cb28-34"><a href="#cb28-34" tabindex="-1"></a><span class="co"># Step 2: Run multiple chains and check convergence using Gelman-Rubin</span></span>
<span id="cb28-35"><a href="#cb28-35" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb28-36"><a href="#cb28-36" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb28-37"><a href="#cb28-37" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-38"><a href="#cb28-38" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-39"><a href="#cb28-39" tabindex="-1"></a></span>
<span id="cb28-40"><a href="#cb28-40" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb28-41"><a href="#cb28-41" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_chains) {</span>
<span id="cb28-42"><a href="#cb28-42" tabindex="-1"></a>  chains[[j]] <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(n_samples, sigma, <span class="fu">rnorm</span>(<span class="dv">1</span>))</span>
<span id="cb28-43"><a href="#cb28-43" tabindex="-1"></a>}</span>
<span id="cb28-44"><a href="#cb28-44" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" tabindex="-1"></a><span class="co"># Convert chains to a matrix for convergence diagnostics</span></span>
<span id="cb28-46"><a href="#cb28-46" tabindex="-1"></a>mcmc_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(chains, mcmc))</span>
<span id="cb28-47"><a href="#cb28-47" tabindex="-1"></a></span>
<span id="cb28-48"><a href="#cb28-48" tabindex="-1"></a><span class="co"># Calculate Gelman-Rubin diagnostic</span></span>
<span id="cb28-49"><a href="#cb28-49" tabindex="-1"></a>gelman_diag <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(mcmc_chains, <span class="at">autoburnin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-50"><a href="#cb28-50" tabindex="-1"></a><span class="fu">print</span>(gelman_diag) <span class="co"># Step 3: Check if \hat{R} &lt; 1.2</span></span>
<span id="cb28-51"><a href="#cb28-51" tabindex="-1"></a><span class="co">#&gt; Potential scale reduction factors:</span></span>
<span id="cb28-52"><a href="#cb28-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-53"><a href="#cb28-53" tabindex="-1"></a><span class="co">#&gt;      Point est. Upper C.I.</span></span>
<span id="cb28-54"><a href="#cb28-54" tabindex="-1"></a><span class="co">#&gt; [1,]       1.06       1.08</span></span>
<span id="cb28-55"><a href="#cb28-55" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(gelman_diag<span class="sc">$</span>psrf[,<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="fl">1.2</span>)) {</span>
<span id="cb28-56"><a href="#cb28-56" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Chains have converged based on Gelman-Rubin diagnostic.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb28-57"><a href="#cb28-57" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb28-58"><a href="#cb28-58" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Chains have not yet converged. Increase the number of iterations.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb28-59"><a href="#cb28-59" tabindex="-1"></a>} <span class="co"># Combine chains and discard burn-in samples</span></span>
<span id="cb28-60"><a href="#cb28-60" tabindex="-1"></a><span class="co">#&gt; Chains have converged based on Gelman-Rubin diagnostic.</span></span>
<span id="cb28-61"><a href="#cb28-61" tabindex="-1"></a>combined_samples <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c, <span class="fu">lapply</span>(chains, <span class="cf">function</span>(x) x[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n_samples]))</span>
<span id="cb28-62"><a href="#cb28-62" tabindex="-1"></a></span>
<span id="cb28-63"><a href="#cb28-63" tabindex="-1"></a><span class="co"># Step 4: Compare deciles with the standard Cauchy distribution</span></span>
<span id="cb28-64"><a href="#cb28-64" tabindex="-1"></a>generated_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(combined_samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb28-65"><a href="#cb28-65" tabindex="-1"></a>theoretical_deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb28-66"><a href="#cb28-66" tabindex="-1"></a></span>
<span id="cb28-67"><a href="#cb28-67" tabindex="-1"></a><span class="co"># Display comparison of deciles</span></span>
<span id="cb28-68"><a href="#cb28-68" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-69"><a href="#cb28-69" tabindex="-1"></a>  <span class="at">Decile =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb28-70"><a href="#cb28-70" tabindex="-1"></a>  <span class="at">Generated =</span> generated_deciles,</span>
<span id="cb28-71"><a href="#cb28-71" tabindex="-1"></a>  <span class="at">Theoretical =</span> theoretical_deciles</span>
<span id="cb28-72"><a href="#cb28-72" tabindex="-1"></a>)</span>
<span id="cb28-73"><a href="#cb28-73" tabindex="-1"></a></span>
<span id="cb28-74"><a href="#cb28-74" tabindex="-1"></a><span class="fu">print</span>(comparison) <span class="co"># Optional: Plot the generated samples and compare with theoretical deciles</span></span>
<span id="cb28-75"><a href="#cb28-75" tabindex="-1"></a><span class="co">#&gt;     Decile  Generated Theoretical</span></span>
<span id="cb28-76"><a href="#cb28-76" tabindex="-1"></a><span class="co">#&gt; 10%    0.1 -2.6556673  -3.0776835</span></span>
<span id="cb28-77"><a href="#cb28-77" tabindex="-1"></a><span class="co">#&gt; 20%    0.2 -1.2445419  -1.3763819</span></span>
<span id="cb28-78"><a href="#cb28-78" tabindex="-1"></a><span class="co">#&gt; 30%    0.3 -0.6314573  -0.7265425</span></span>
<span id="cb28-79"><a href="#cb28-79" tabindex="-1"></a><span class="co">#&gt; 40%    0.4 -0.2430912  -0.3249197</span></span>
<span id="cb28-80"><a href="#cb28-80" tabindex="-1"></a><span class="co">#&gt; 50%    0.5  0.0984828   0.0000000</span></span>
<span id="cb28-81"><a href="#cb28-81" tabindex="-1"></a><span class="co">#&gt; 60%    0.6  0.4580972   0.3249197</span></span>
<span id="cb28-82"><a href="#cb28-82" tabindex="-1"></a><span class="co">#&gt; 70%    0.7  0.9602569   0.7265425</span></span>
<span id="cb28-83"><a href="#cb28-83" tabindex="-1"></a><span class="co">#&gt; 80%    0.8  1.8569930   1.3763819</span></span>
<span id="cb28-84"><a href="#cb28-84" tabindex="-1"></a><span class="co">#&gt; 90%    0.9  4.8187167   3.0776835</span></span>
<span id="cb28-85"><a href="#cb28-85" tabindex="-1"></a><span class="fu">hist</span>(combined_samples, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of Generated Samples vs. Standard Cauchy PDF&quot;</span>,</span>
<span id="cb28-86"><a href="#cb28-86" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb28-87"><a href="#cb28-87" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dcauchy</span>(x), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb28-88"><a href="#cb28-88" tabindex="-1"></a><span class="fu">points</span>(theoretical_deciles, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(theoretical_deciles)), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb28-89"><a href="#cb28-89" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Generated Samples&quot;</span>, <span class="st">&quot;Theoretical Deciles&quot;</span>),</span>
<span id="cb28-90"><a href="#cb28-90" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">16</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="cn">NA</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-9.8-b" class="section level2">
<h2>Question 9.8 b</h2>
<p>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R} &lt;
1.2\)</span>. Consider the bivariate density <span class="math display">\[
f(x,y) \propto (n_x) y^{x+a-1} (1-y)^{n-x+b-1}, \quad x = 0, 1, \ldots,
n, \quad 0 \leq y \leq 1.
\]</span> It can be shown that for fixed <span class="math inline">\(a,
b,\)</span> and <span class="math inline">\(n\)</span>, the conditional
distributions are <span class="math inline">\(x | y \sim
\text{Binomial}(n,y)\)</span> and <span class="math inline">\(y | x \sim
\text{Beta}(x+a,n-x+b)\)</span>. Use the Gibbs sampler to generate a
chain with target joint density <span class="math inline">\(f(x,y)\)</span>.<br />
</p>
</div>
<div id="answer-9.8-b" class="section level2">
<h2>Answer 9.8 b</h2>
<p>To solve this problem, we will use the Gelman-Rubin method to monitor
convergence of a Gibbs sampler applied to the target bivariate density:
<span class="math display">\[
f(x,y) \propto (n_x) y^{x+a-1} (1-y)^{n-x+b-1}, \quad x = 0, 1, \ldots,
n, \quad 0 \leq y \leq 1.
\]</span></p>
<p>The goal is to generate samples from this joint distribution <span class="math inline">\(f(x,y)\)</span> using the Gibbs sampler and to
monitor convergence with the Gelman-Rubin method. Here are the
steps:</p>
<p>From the given density, the conditional distributions are: <span class="math display">\[
x | y \sim \text{Binomial}(n,y)
\]</span> <span class="math display">\[
y | x \sim \text{Beta}(x+a,n-x+b)
\]</span> The Gibbs sampler iteratively samples each variable from its
conditional distribution given the other variable.</p>
<p>To monitor convergence with the Gelman-Rubin diagnostic, we need to
run multiple chains with different initial values. Let <span class="math inline">\(m\)</span> be the number of chains and <span class="math inline">\(n\)</span> the number of iterations per chain.</p>
<ul>
<li><p>Initialize <span class="math inline">\(m\)</span> chains with
different starting values <span class="math inline">\((x^{(j)}_0,
y^{(j)}_0)\)</span>, where <span class="math inline">\(j = 1, 2, \ldots,
m\)</span>.</p></li>
<li><p>For each iteration <span class="math inline">\(t\)</span> in each
chain <span class="math inline">\(j\)</span>:</p></li>
<li><p>Sample <span class="math inline">\(x^{(j)}_t \sim
\text{Binomial}(n,y^{(j)}_{t-1})\)</span>.</p></li>
<li><p>Sample <span class="math inline">\(y^{(j)}_t \sim
\text{Beta}(x^{(j)}_t+a,n-x^{(j)}_t+b)\)</span>.</p></li>
</ul>
<p>Calculate the Gelman-Rubin Diagnostic <span class="math inline">\(\hat{R}\)</span>: The Gelman-Rubin diagnostic, or
potential scale reduction factor (PSRF), assesses if the chains have
converged.</p>
<p>Compute the within-chain variance <span class="math inline">\(W\)</span>: <span class="math display">\[
W = \frac{1}{m} \sum_{j=1}^{m} s_j^2
\]</span> where <span class="math inline">\(s_j^2\)</span> is the sample
variance of chain <span class="math inline">\(j\)</span>.</p>
<p>Compute the between-chain variance <span class="math inline">\(B\)</span>: Calculate the mean of each chain <span class="math inline">\(\bar{\theta}^{(j)}\)</span> and the overall mean
<span class="math inline">\(\bar{\theta}\)</span>: <span class="math display">\[
\bar{\theta} = \frac{1}{m} \sum_{j=1}^{m} \bar{\theta}^{(j)}
\]</span> Then calculate <span class="math inline">\(B\)</span> as:
<span class="math display">\[
B = \frac{n}{m-1} \sum_{j=1}^{m} (\bar{\theta}^{(j)} - \bar{\theta})^2
\]</span></p>
<p>Estimate the marginal posterior variance <span class="math inline">\(\hat{V}\)</span>: <span class="math display">\[
\hat{V} = \frac{n-1}{n} W + \frac{1}{n} B
\]</span></p>
<p>Compute <span class="math inline">\(\hat{R}\)</span>: <span class="math display">\[
\hat{R} = \frac{\hat{V}}{\sqrt{W}}
\]</span> If <span class="math inline">\(\hat{R} &lt; 1.2\)</span>, the
chains are considered to have converged to the target distribution.</p>
<p>Continue the Gibbs sampler and recompute <span class="math inline">\(\hat{R}\)</span> periodically until <span class="math inline">\(\hat{R} &lt; 1.2\)</span>, indicating approximate
convergence.</p>
<p>After confirming convergence, discard the first 1000 samples from
each chain to remove the effect of initial values. Then, combine the
samples from all chains for further analysis.</p>
<ul>
<li><strong>Calculate Deciles:</strong> Calculate the deciles of the
combined samples of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> after discarding the burn-in
period.</li>
<li><strong>Compare with Theoretical Deciles:</strong> If you have a
theoretical distribution for comparison (like a standard Cauchy),
compute the theoretical deciles using its quantile function and compare
them with the empirical deciles of the generated.</li>
</ul>
<p><strong>Summary of Mathematical Solution:</strong></p>
<ul>
<li>Run multiple chains of the Gibbs sampler to sample from <span class="math inline">\(f(x,y)\)</span>.</li>
<li>Monitor convergence using the Gelman-Rubin diagnostic <span class="math inline">\(\hat{R}\)</span>, and ensure <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</li>
<li>Discard burn-in samples to avoid initialization bias.</li>
<li>Combine and analyze the samples by comparing empirical deciles to
theoretical deciles, if applicable.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co"># Load necessary library for the Gelman-Rubin diagnostic</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>          <span class="co"># Number of trials for the binomial</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>           <span class="co"># Alpha parameter for Beta distribution</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span>           <span class="co"># Beta parameter for Beta distribution</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>num_iter <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of iterations for each Gibbs chain</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">4</span>    <span class="co"># Number of chains for the Gelman-Rubin diagnostic</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>    <span class="co"># Burn-in period to discard initial samples</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co"># Function to run the Gibbs sampler for a single chain</span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>run_gibbs_chain <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, num_iter) {</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span>          <span class="co"># Initialize x</span></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fl">0.5</span>        <span class="co"># Initialize y</span></span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>  </span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iter)</span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iter)</span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a>  </span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_iter) {</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>    <span class="co"># Sample x given y from Binomial(n, y)</span></span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a>    </span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a>    <span class="co"># Sample y given x from Beta(x + a, n - x + b)</span></span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a>    </span>
<span id="cb29-29"><a href="#cb29-29" tabindex="-1"></a>    <span class="co"># Store samples</span></span>
<span id="cb29-30"><a href="#cb29-30" tabindex="-1"></a>    x_samples[i] <span class="ot">&lt;-</span> x</span>
<span id="cb29-31"><a href="#cb29-31" tabindex="-1"></a>    y_samples[i] <span class="ot">&lt;-</span> y</span>
<span id="cb29-32"><a href="#cb29-32" tabindex="-1"></a>  }</span>
<span id="cb29-33"><a href="#cb29-33" tabindex="-1"></a>  </span>
<span id="cb29-34"><a href="#cb29-34" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x_samples =</span> x_samples, <span class="at">y_samples =</span> y_samples))</span>
<span id="cb29-35"><a href="#cb29-35" tabindex="-1"></a>}</span>
<span id="cb29-36"><a href="#cb29-36" tabindex="-1"></a></span>
<span id="cb29-37"><a href="#cb29-37" tabindex="-1"></a><span class="co"># Run multiple chains and store the results</span></span>
<span id="cb29-38"><a href="#cb29-38" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, num_chains)</span>
<span id="cb29-39"><a href="#cb29-39" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_chains) {</span>
<span id="cb29-40"><a href="#cb29-40" tabindex="-1"></a>  chains[[j]] <span class="ot">&lt;-</span> <span class="fu">run_gibbs_chain</span>(n, a, b, num_iter)</span>
<span id="cb29-41"><a href="#cb29-41" tabindex="-1"></a>}</span>
<span id="cb29-42"><a href="#cb29-42" tabindex="-1"></a></span>
<span id="cb29-43"><a href="#cb29-43" tabindex="-1"></a><span class="co"># Combine the chains into a format suitable for the Gelman-Rubin diagnostic</span></span>
<span id="cb29-44"><a href="#cb29-44" tabindex="-1"></a>x_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(chains, <span class="cf">function</span>(chain) <span class="fu">mcmc</span>(chain<span class="sc">$</span>x_samples)))</span>
<span id="cb29-45"><a href="#cb29-45" tabindex="-1"></a>y_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(chains, <span class="cf">function</span>(chain) <span class="fu">mcmc</span>(chain<span class="sc">$</span>y_samples)))</span>
<span id="cb29-46"><a href="#cb29-46" tabindex="-1"></a></span>
<span id="cb29-47"><a href="#cb29-47" tabindex="-1"></a><span class="co"># Calculate Gelman-Rubin diagnostic for both x and y chains</span></span>
<span id="cb29-48"><a href="#cb29-48" tabindex="-1"></a>gelman_diag_x <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(x_chains, <span class="at">autoburnin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-49"><a href="#cb29-49" tabindex="-1"></a>gelman_diag_y <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(y_chains, <span class="at">autoburnin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-50"><a href="#cb29-50" tabindex="-1"></a></span>
<span id="cb29-51"><a href="#cb29-51" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Gelman-Rubin Diagnostic for X:</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="co"># Gelman-Rubin Diagnostic for X:</span></span>
<span id="cb29-52"><a href="#cb29-52" tabindex="-1"></a><span class="co">#&gt; Gelman-Rubin Diagnostic for X:</span></span>
<span id="cb29-53"><a href="#cb29-53" tabindex="-1"></a><span class="fu">print</span>(gelman_diag_x) </span>
<span id="cb29-54"><a href="#cb29-54" tabindex="-1"></a><span class="co">#&gt; Potential scale reduction factors:</span></span>
<span id="cb29-55"><a href="#cb29-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-56"><a href="#cb29-56" tabindex="-1"></a><span class="co">#&gt;      Point est. Upper C.I.</span></span>
<span id="cb29-57"><a href="#cb29-57" tabindex="-1"></a><span class="co">#&gt; [1,]          1          1</span></span>
<span id="cb29-58"><a href="#cb29-58" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Gelman-Rubin Diagnostic for Y:</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="co"># Gelman-Rubin Diagnostic for Y:</span></span>
<span id="cb29-59"><a href="#cb29-59" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-60"><a href="#cb29-60" tabindex="-1"></a><span class="co">#&gt; Gelman-Rubin Diagnostic for Y:</span></span>
<span id="cb29-61"><a href="#cb29-61" tabindex="-1"></a><span class="fu">print</span>(gelman_diag_y)</span>
<span id="cb29-62"><a href="#cb29-62" tabindex="-1"></a><span class="co">#&gt; Potential scale reduction factors:</span></span>
<span id="cb29-63"><a href="#cb29-63" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-64"><a href="#cb29-64" tabindex="-1"></a><span class="co">#&gt;      Point est. Upper C.I.</span></span>
<span id="cb29-65"><a href="#cb29-65" tabindex="-1"></a><span class="co">#&gt; [1,]          1          1</span></span>
<span id="cb29-66"><a href="#cb29-66" tabindex="-1"></a></span>
<span id="cb29-67"><a href="#cb29-67" tabindex="-1"></a><span class="co"># Check if both x and y have converged (R_hat &lt; 1.2)</span></span>
<span id="cb29-68"><a href="#cb29-68" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(gelman_diag_x<span class="sc">$</span>psrf[, <span class="dv">1</span>] <span class="sc">&lt;</span> <span class="fl">1.2</span>) <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(gelman_diag_y<span class="sc">$</span>psrf[, <span class="dv">1</span>] <span class="sc">&lt;</span> <span class="fl">1.2</span>)) {</span>
<span id="cb29-69"><a href="#cb29-69" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Chains have converged based on Gelman-Rubin diagnostic.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb29-70"><a href="#cb29-70" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-71"><a href="#cb29-71" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Chains have not yet converged. Increase the number of iterations.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb29-72"><a href="#cb29-72" tabindex="-1"></a>}</span>
<span id="cb29-73"><a href="#cb29-73" tabindex="-1"></a><span class="co">#&gt; Chains have converged based on Gelman-Rubin diagnostic.</span></span>
<span id="cb29-74"><a href="#cb29-74" tabindex="-1"></a></span>
<span id="cb29-75"><a href="#cb29-75" tabindex="-1"></a><span class="co"># Discard burn-in samples and combine samples from all chains</span></span>
<span id="cb29-76"><a href="#cb29-76" tabindex="-1"></a>x_samples_combined <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(chains, <span class="cf">function</span>(chain) chain<span class="sc">$</span>x_samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>num_iter]))</span>
<span id="cb29-77"><a href="#cb29-77" tabindex="-1"></a>y_samples_combined <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(chains, <span class="cf">function</span>(chain) chain<span class="sc">$</span>y_samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>num_iter]))</span>
<span id="cb29-78"><a href="#cb29-78" tabindex="-1"></a></span>
<span id="cb29-79"><a href="#cb29-79" tabindex="-1"></a><span class="co"># Step 6: Analyze the Samples</span></span>
<span id="cb29-80"><a href="#cb29-80" tabindex="-1"></a><span class="co"># Calculate deciles of the combined samples</span></span>
<span id="cb29-81"><a href="#cb29-81" tabindex="-1"></a>x_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x_samples_combined, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb29-82"><a href="#cb29-82" tabindex="-1"></a>y_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y_samples_combined, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb29-83"><a href="#cb29-83" tabindex="-1"></a></span>
<span id="cb29-84"><a href="#cb29-84" tabindex="-1"></a><span class="co"># Display deciles</span></span>
<span id="cb29-85"><a href="#cb29-85" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Deciles of X Samples:</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="co"># Deciles of X Samples:</span></span>
<span id="cb29-86"><a href="#cb29-86" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-87"><a href="#cb29-87" tabindex="-1"></a><span class="co">#&gt; Deciles of X Samples:</span></span>
<span id="cb29-88"><a href="#cb29-88" tabindex="-1"></a><span class="fu">print</span>(x_deciles) </span>
<span id="cb29-89"><a href="#cb29-89" tabindex="-1"></a><span class="co">#&gt; 10% 20% 30% 40% 50% 60% 70% 80% 90% </span></span>
<span id="cb29-90"><a href="#cb29-90" tabindex="-1"></a><span class="co">#&gt;   1   2   2   3   4   5   5   6   8</span></span>
<span id="cb29-91"><a href="#cb29-91" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Deciles of Y Samples:</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="co"># Deciles of Y Samples:</span></span>
<span id="cb29-92"><a href="#cb29-92" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-93"><a href="#cb29-93" tabindex="-1"></a><span class="co">#&gt; Deciles of Y Samples:</span></span>
<span id="cb29-94"><a href="#cb29-94" tabindex="-1"></a><span class="fu">print</span>(y_deciles)</span>
<span id="cb29-95"><a href="#cb29-95" tabindex="-1"></a><span class="co">#&gt;       10%       20%       30%       40%       50%       60%       70%       80% </span></span>
<span id="cb29-96"><a href="#cb29-96" tabindex="-1"></a><span class="co">#&gt; 0.1447073 0.2138672 0.2765326 0.3345830 0.3905311 0.4502939 0.5148022 0.5887506 </span></span>
<span id="cb29-97"><a href="#cb29-97" tabindex="-1"></a><span class="co">#&gt;       90% </span></span>
<span id="cb29-98"><a href="#cb29-98" tabindex="-1"></a><span class="co">#&gt; 0.6866267</span></span>
<span id="cb29-99"><a href="#cb29-99" tabindex="-1"></a></span>
<span id="cb29-100"><a href="#cb29-100" tabindex="-1"></a><span class="co"># Optional: Plot the samples </span></span>
<span id="cb29-101"><a href="#cb29-101" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb29-102"><a href="#cb29-102" tabindex="-1"></a><span class="fu">hist</span>(x_samples_combined, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of X Samples&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>)</span>
<span id="cb29-103"><a href="#cb29-103" tabindex="-1"></a><span class="fu">hist</span>(y_samples_combined, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of Y Samples&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="last-question-proof-of-stationarity-for-metropolis-hastings-algorithm" class="section level2">
<h2>Last Question; Proof of Stationarity for Metropolis-Hastings
Algorithm</h2>
<p><strong>Algorithm (Continuous Situation):</strong></p>
<ul>
<li>Target pdf: <span class="math inline">\(f(x)\)</span>.</li>
<li>Replace <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> with <span class="math inline">\(s\)</span> and <span class="math inline">\(r\)</span> respectively.</li>
<li>Proposal distribution (pdf): <span class="math inline">\(g(r|s)\)</span>.</li>
<li>Acceptance probability: <span class="math display">\[
    \alpha(s,r) = \min\left(\frac{f(r)g(s|r)}{f(s)g(r|s)}, 1\right).
    \]</span></li>
<li>Transition kernel (mixture distribution): <span class="math display">\[
    K(r,s) = I(s \neq r) \alpha(r,s) g(s|r) + I(s = r) \left[1 - \int
\alpha(r,s) g(s|r) \, dr\right].
    \]</span></li>
<li>Stationarity: <span class="math display">\[
    K(s,r) f(s) = K(r,s) f(r).
    \]</span></li>
</ul>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p><strong>Metropolis-Hastings Algorithm Description and Proof of
Stationarity</strong></p>
<p>-<strong>Target PDF</strong> <span class="math inline">\(f(x)\)</span>: This is the probability density
function (pdf) of the target distribution we want to sample from.</p>
<p>-<strong>Proposal Distribution</strong> <span class="math inline">\(g(r|s)\)</span>: This distribution is used to
propose a new candidate state <span class="math inline">\(r\)</span>
given the current state <span class="math inline">\(s\)</span>.</p>
<ul>
<li><strong>Acceptance Probability</strong> <span class="math inline">\(\alpha(s,r)\)</span>: The probability of accepting
the proposed state <span class="math inline">\(r\)</span> when at the
current state <span class="math inline">\(s\)</span>. It is given by:
<span class="math display">\[
\alpha(s,r) = \min\left(\frac{f(r)g(s|r)}{f(s)g(r|s)}, 1\right).
\]</span></li>
</ul>
<p>-<strong>Transition Kernel</strong> <span class="math inline">\(K(r,s)\)</span>: The transition kernel is defined
as a mixture of accepting or rejecting the proposed state. The formula
given is: <span class="math display">\[
    K(r,s) = I(s \neq r) \alpha(r,s) g(s|r) + I(s = r) \left[1 - \int
\alpha(r,s) g(s|r) \, dr\right],
    \]</span> where <span class="math inline">\(I\)</span> is an
indicator function that differentiates between cases where the new state
is accepted or rejected.</p>
<ul>
<li><strong>Stationarity Condition:</strong> The condition to prove is
that <span class="math inline">\(K(s,r) f(s) = K(r,s) f(r)\)</span>,
which demonstrates that the target distribution <span class="math inline">\(f\)</span> is stationary under the transition
kernel <span class="math inline">\(K\)</span>, meaning it remains
unchanged in expectation after each transition. \end{itemize}</li>
</ul>
<p><strong>Proof Sketch for Stationarity</strong></p>
<p>To show stationarity, we need to verify that the target distribution
<span class="math inline">\(f(x)\)</span> satisfies the detailed balance
condition with respect to <span class="math inline">\(K(r,s)\)</span>,
meaning: <span class="math display">\[
f(s) K(s,r) = f(r) K(r,s).
\]</span></p>
<p>Substitute <span class="math inline">\(K(r,s)\)</span> as defined and
use the definition of the acceptance probability <span class="math inline">\(\alpha(s,r)\)</span>.</p>
<p><strong>Evaluate Cases:</strong></p>
<ul>
<li>For <span class="math inline">\(s \neq r\)</span>: <span class="math display">\[
f(s) K(s,r) = f(s) \alpha(s,r) g(r|s).
\]</span> Using <span class="math inline">\(\alpha(s,r) =
\min\left(\frac{f(r)g(s|r)}{f(s)g(r|s)}, 1\right)\)</span>, split into
two cases:</li>
</ul>
<p><strong>Case 1:</strong> If <span class="math inline">\(\frac{f(r)g(s|r)}{f(s)g(r|s)} \leq 1\)</span>,
then <span class="math inline">\(\alpha(s,r) =
\frac{f(r)g(s|r)}{f(s)g(r|s)}\)</span>, and <span class="math display">\[
        f(s) K(s,r) = f(s) \cdot \frac{f(r)g(s|r)}{f(s)g(r|s)} \cdot
g(r|s) = f(r) g(s|r).
        \]</span></p>
<ul>
<li>If <span class="math inline">\(\frac{f(r)g(s|r)}{f(s)g(r|s)} &gt;
1\)</span>, then <span class="math inline">\(\alpha(s,r) = 1\)</span>,
and <span class="math display">\[
   f(s) K(s,r) = f(s) g(r|s) = f(r) \alpha(r,s) g(s|r) = f(r) K(r,s).
   \]</span></li>
</ul>
<p><strong>Self-Transition (when <span class="math inline">\(s =
r\)</span>):</strong> Show that the probability of staying in the
current state <span class="math inline">\(s = r\)</span> preserves the
balance. ## Conclusion If both cases satisfy <span class="math inline">\(f(s) K(s,r) = f(r) K(r,s)\)</span>, we have proved
stationarity for the target distribution under the transition kernel
<span class="math inline">\(K\)</span>, hence validating the
algorithm.</p>
</div>
<div id="homework-7-pages-353-354-statistical-computing-with-r." class="section level2">
<h2>Homework 7 (pages 353-354, Statistical Computing with R).</h2>
</div>
<div id="question-11.3" class="section level2">
<h2>Question 11.3</h2>
<ul>
<li><p>[(a)] Write a function to compute the <span class="math inline">\(k\)</span>-th term in <span class="math display">\[
\sum_{k=0}^\infty (-1)^k \frac{\|a\|^{2k+2}}{k! \, 2^k \, (2k+1)(2k+2)
\, \Gamma\left(\frac{d+1}{2}\right) \, \Gamma\left(\frac{k+3}{2}\right)
\, \Gamma\left(\frac{k+d}{2} + 1\right)},
\]</span> where <span class="math inline">\(d \geq 1\)</span> is an
integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm.
Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large <span class="math inline">\(k\)</span> and
<span class="math inline">\(d\)</span>. (This sum converges for all
<span class="math inline">\(a \in \mathbb{R}^d\)</span>.)</p></li>
<li><p>[(b)] Modify the function so that it computes and returns the
sum.</p></li>
<li><p>[(c)] Evaluate the sum when <span class="math inline">\(a = (1,
2)^T\)</span>.</p></li>
</ul>
</div>
<div id="answer-11.3" class="section level2">
<h2>Answer 11.3</h2>
<p>To solve the problem mathematically, we will develop the necessary
functions step by step.</p>
<p><strong>Function to Compute the <span class="math inline">\(k\)</span>-th Term</strong> We are tasked with
deriving the <span class="math inline">\(k\)</span>-th term of the
infinite series: <span class="math display">\[
T_k = (-1)^k \frac{\|a\|^{2k+2}}{k! \, 2^k \, (2k+1)(2k+2) \,
\Gamma\left(\frac{d+1}{2}\right) \, \Gamma\left(\frac{k+3}{2}\right) \,
\Gamma\left(\frac{k+d}{2} + 1\right)}.
\]</span></p>
<p><strong>Steps to Compute <span class="math inline">\(T_k\)</span>:</strong></p>
<ul>
<li><p> The norm <span class="math inline">\(\|a\|\)</span> is computed
as: <span class="math display">\[
\|a\| = \sqrt{a_1^2 + a_2^2 + \cdots + a_d^2}.
\]</span></p></li>
<li><p> The gamma function values needed for the calculation are
available from ’s function.</p></li>
<li><p> Utilize ’s built-in function for the <span class="math inline">\(k!\)</span> computation.</p></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co"># Load the necessary library for gamma function</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a> <span class="fu">library</span>(stats)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a> <span class="co"># Function to compute the k-th term of the series</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a> compute_kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k, d) {</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a> <span class="co"># Check if d is a positive integer</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a> <span class="cf">if</span> (d <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (d <span class="sc">%%</span> <span class="dv">1</span>) <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>   <span class="fu">stop</span>(<span class="st">&quot;d must bean integer greater than or equa l to 1.&quot;</span>)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a> }</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a> <span class="co">#Calculate the Euclidean norm of vector a</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a> norm_a<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a> <span class="co">#Compute the k-th term</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a> term<span class="ot">&lt;-</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span><span class="fu">factorial</span>(k)) <span class="sc">*</span>(norm_a<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))<span class="sc">*</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a> (<span class="fu">gamma</span>((d<span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span> <span class="dv">2</span>)<span class="sc">/</span> ((<span class="dv">2</span><span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">*</span> (<span class="dv">2</span><span class="sc">*</span>k <span class="sc">+</span> <span class="dv">2</span>)<span class="sc">*</span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a> <span class="fu">gamma</span>((k<span class="sc">+</span> <span class="dv">3</span>)<span class="sc">/</span> <span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">+</span>(d<span class="sc">/</span> <span class="dv">2</span>)<span class="sc">+</span> <span class="dv">1</span>)))</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a> <span class="fu">return</span>(term)</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a> }</span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a> <span class="co">#Example usage</span></span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a> d_value<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a> k_value<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a> a_value<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)<span class="co">#Corresponding to vector a</span></span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a> kth_term<span class="ot">&lt;-</span><span class="fu">compute_kth_term</span>(a_value,k_value,d_value)</span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a> <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;The% d-th term is:%.6f</span><span class="sc">\n</span><span class="st">&quot;</span>,k_value,kth_term))</span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a><span class="co">#&gt; The 0-th term is:2.500000</span></span>
<span id="cb30-25"><a href="#cb30-25" tabindex="-1"></a> <span class="do">##The 0-th term is:2.500000</span></span>
<span id="cb30-26"><a href="#cb30-26" tabindex="-1"></a> <span class="co">#Function to  compute the sum of the series up to max_k</span></span>
<span id="cb30-27"><a href="#cb30-27" tabindex="-1"></a> compute_series_sum<span class="ot">&lt;-</span><span class="cf">function</span>(a,max_k,d){</span>
<span id="cb30-28"><a href="#cb30-28" tabindex="-1"></a> <span class="co">#Initializetotal sum</span></span>
<span id="cb30-29"><a href="#cb30-29" tabindex="-1"></a> total_sum<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb30-30"><a href="#cb30-30" tabindex="-1"></a> <span class="co">#Loop through each term from 0 to max_k</span></span>
<span id="cb30-31"><a href="#cb30-31" tabindex="-1"></a> <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>max_k){</span>
<span id="cb30-32"><a href="#cb30-32" tabindex="-1"></a> total_sum<span class="ot">&lt;-</span>total_sum <span class="sc">+</span><span class="fu">compute_kth_term</span>(a,k,d)</span>
<span id="cb30-33"><a href="#cb30-33" tabindex="-1"></a> }</span>
<span id="cb30-34"><a href="#cb30-34" tabindex="-1"></a> <span class="fu">return</span>(total_sum)</span>
<span id="cb30-35"><a href="#cb30-35" tabindex="-1"></a> }</span>
<span id="cb30-36"><a href="#cb30-36" tabindex="-1"></a> <span class="co">#Example usage</span></span>
<span id="cb30-37"><a href="#cb30-37" tabindex="-1"></a> max_k_value <span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb30-38"><a href="#cb30-38" tabindex="-1"></a> series_sum<span class="ot">&lt;-</span><span class="fu">compute_series_sum</span>(a_value,max_k_value,d_value)</span>
<span id="cb30-39"><a href="#cb30-39" tabindex="-1"></a> <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;The sum of the series up to k=%dis:%.6f</span><span class="sc">\n</span><span class="st">&quot;</span>,max_k_value,series_sum))</span>
<span id="cb30-40"><a href="#cb30-40" tabindex="-1"></a><span class="co">#&gt; The sum of the series up to k=10is:1.777006</span></span></code></pre></div>
</div>
<div id="question-11.5" class="section level2">
<h2>Question 11.5</h2>
<p>Write a function to solve the equation <span class="math display">\[
2\frac{\Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi}(k -
1)\Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}} \left(1 +
\frac{u^2}{k - 1}\right)^{-k/2} \, du =
2\frac{\Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi
k}\Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_k} \left(1 +
\frac{u^2}{k}\right)^{-(k+1)/2} \, du
\]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[
c_k = \sqrt{\frac{a^2 k}{k + 1 - a^2}}.
\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
</div>
<div id="answer-11.5" class="section level2">
<h2>Answer 11.5</h2>
<p>To solve the given equation: <span class="math display">\[
2 \frac{\Gamma\left(\frac{k}{2}\right)}{\pi (k-1)
\Gamma\left(\frac{k-1}{2}\right)}
\int_0^\infty \frac{c_{k-1}^k}{(1+u^2)^{k/2}} \, du =
2 \frac{\Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}
\Gamma\left(\frac{k}{2}\right)}
\int_0^\infty \frac{c_k^k}{(1+u^2)^{(k+1)/2}} \, du,
\]</span> where <span class="math display">\[
c_k = \frac{a^{2k}}{k+1 - a^2},
\]</span> we will follow a systematic approach involving simplification
of integrals, and it will also include a comparison with the points
<span class="math inline">\(A(k)\)</span> from Exercise 11.4.</p>
</div>
<div id="step-1-integral-calculation" class="section level2">
<h2>Step 1: Integral Calculation</h2>
<p>We start by calculating the integrals on both sides of the equation
separately.</p>
<p><strong>The left side can be expressed as:</strong> <span class="math display">\[
I_L = \int_0^\infty \frac{c_{k-1}^k}{(1+u^2)^{k/2}} \, du.
\]</span> Substituting for <span class="math inline">\(c_{k-1}\)</span>:
<span class="math display">\[
I_L = \int_0^\infty \frac{a^{2k}}{(k+1 - a^2)^{k-1} (1+u^2)^{k/2}} \,
du.
\]</span> Using the known formula for the integral: <span class="math display">\[
\int_0^\infty \frac{1}{(1+u^2)^\alpha} \, du = \frac{\pi}{2
\sin\left(\frac{\pi \alpha}{2}\right)}, \quad 0 &lt; \alpha &lt; 2,
\]</span> we obtain: <span class="math display">\[
I_L = \frac{a^{2k}}{(k+1 - a^2)^{k-1}} \cdot \frac{\pi}{2
\sin\left(\frac{\pi (k-1)}{4}\right)}.
\]</span></p>
<p><strong>The right side can be deduced similarly:</strong> <span class="math display">\[
I_R = \int_0^\infty \frac{c_k^k}{(1+u^2)^{(k+1)/2}} \, du,
\]</span> substituting for <span class="math inline">\(c_k\)</span>:
<span class="math display">\[
I_R = \int_0^\infty \frac{a^{2k}}{(k+1 - a^2)^k (1+u^2)^{(k+1)/2}} \,
du.
\]</span> Using the integral formula: <span class="math display">\[
I_R = \frac{a^{2k}}{(k+1 - a^2)^k} \cdot \frac{\pi}{2
\sin\left(\frac{\pi (k+1)}{4}\right)}.
\]</span></p>
<p><strong>Step 2: Setting Up the Equation</strong></p>
<p>Now, by substituting <span class="math inline">\(I_L\)</span> and
<span class="math inline">\(I_R\)</span> back into the equation, we
obtain: <span class="math display">\[
2 \frac{\Gamma\left(\frac{k}{2}\right)}{\pi (k-1)
\Gamma\left(\frac{k-1}{2}\right)}
\cdot \frac{a^{2k}}{(k+1 - a^2)^{k-1}} \cdot \frac{\pi}{2
\sin\left(\frac{\pi (k-1)}{4}\right)} =
2 \frac{\Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}
\Gamma\left(\frac{k}{2}\right)}
\cdot \frac{a^{2k}}{(k+1 - a^2)^k} \cdot \frac{\pi}{2
\sin\left(\frac{\pi (k+1)}{4}\right)}.
\]</span></p>
<p><strong>Step 3: Solve for <span class="math inline">\(a\)</span></strong></p>
<p>Rearranging and simplifying the terms will lead to a polynomial
equation in terms of <span class="math inline">\(a^2\)</span> based on
the comparisons made from both integrals. Identifying a clear pattern or
relying on suitable substitutions will facilitate isolating <span class="math inline">\(a\)</span>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="co">#R code for solving the equation and finding the intersection points of Sk-1(a) and Sk(a)</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a> <span class="fu">library</span>(stats)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a> <span class="co">#Function to compute Sk(a)for a given k and a</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a> evaluate_Sk<span class="ot">&lt;-</span><span class="cf">function</span>(k,a){</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a> <span class="cf">if</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;=</span>k <span class="sc">+</span><span class="dv">1</span>){</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a> <span class="fu">return</span>(<span class="cn">NA</span>) <span class="co">#Avoid invalid values under the square root</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a> }</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a> prob<span class="ot">&lt;-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span>k)<span class="sc">/</span> (k<span class="sc">+</span> <span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),<span class="at">df=</span>k,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a> <span class="fu">return</span>(prob)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a> }</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a> <span class="co">#FunctiontocomputeSk-1(a)foragivenkanda</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a> evaluate_Sk_minus_1<span class="ot">&lt;-</span><span class="cf">function</span>(k,a){</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a> <span class="cf">if</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;=</span>k){</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a> <span class="fu">return</span>(<span class="cn">NA</span>) <span class="co">#Avoid invalid values under the square root</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a> }</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a> prob<span class="ot">&lt;-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span>(k<span class="dv">-1</span>)) <span class="sc">/</span> (k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),<span class="at">df=</span>k<span class="dv">-1</span>,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a> <span class="fu">return</span>(prob)</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a> }</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a> <span class="co">#Function to find the intersection point A(k) for given k</span></span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a> find_intersection<span class="ot">&lt;-</span><span class="cf">function</span>(k,<span class="at">lower=</span><span class="fl">0.01</span>,<span class="at">upper=</span> <span class="fu">sqrt</span>(k) <span class="sc">*</span><span class="fl">0.99</span>){</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a> f<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a> <span class="fu">evaluate_Sk_minus_1</span>(k,a)<span class="sc">-</span><span class="fu">evaluate_Sk</span>(k,a)</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a> }</span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a> result<span class="ot">&lt;-</span><span class="fu">tryCatch</span>({</span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a> <span class="fu">uniroot</span>(f,<span class="at">lower=</span>lower,<span class="at">upper=</span>upper)<span class="sc">$</span>root</span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a> },<span class="at">error=</span><span class="cf">function</span>(e){</span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a> <span class="cn">NA</span> <span class="co">#Return NA if the solution cannot be found</span></span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a> })</span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a> <span class="fu">return</span>(result)</span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a> }</span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a> <span class="co">#Calculate intersection points for specified k values</span></span>
<span id="cb31-33"><a href="#cb31-33" tabindex="-1"></a> k_values<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb31-34"><a href="#cb31-34" tabindex="-1"></a> intersection_points<span class="ot">&lt;-</span><span class="fu">sapply</span>(k_values,find_intersection)</span>
<span id="cb31-35"><a href="#cb31-35" tabindex="-1"></a> <span class="co">#Print the results</span></span>
<span id="cb31-36"><a href="#cb31-36" tabindex="-1"></a> intersection_results<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">k =</span>k_values,<span class="at">A_k=</span>intersection_points)</span>
<span id="cb31-37"><a href="#cb31-37" tabindex="-1"></a> <span class="fu">print</span>(intersection_results)</span>
<span id="cb31-38"><a href="#cb31-38" tabindex="-1"></a><span class="co">#&gt;       k       A_k</span></span>
<span id="cb31-39"><a href="#cb31-39" tabindex="-1"></a><span class="co">#&gt; 1     4  1.492098</span></span>
<span id="cb31-40"><a href="#cb31-40" tabindex="-1"></a><span class="co">#&gt; 2     5  1.533544</span></span>
<span id="cb31-41"><a href="#cb31-41" tabindex="-1"></a><span class="co">#&gt; 3     6  1.562745</span></span>
<span id="cb31-42"><a href="#cb31-42" tabindex="-1"></a><span class="co">#&gt; 4     7  1.584429</span></span>
<span id="cb31-43"><a href="#cb31-43" tabindex="-1"></a><span class="co">#&gt; 5     8  1.601168</span></span>
<span id="cb31-44"><a href="#cb31-44" tabindex="-1"></a><span class="co">#&gt; 6     9  1.614516</span></span>
<span id="cb31-45"><a href="#cb31-45" tabindex="-1"></a><span class="co">#&gt; 7    10  1.625383</span></span>
<span id="cb31-46"><a href="#cb31-46" tabindex="-1"></a><span class="co">#&gt; 8    11  1.634411</span></span>
<span id="cb31-47"><a href="#cb31-47" tabindex="-1"></a><span class="co">#&gt; 9    12  1.642026</span></span>
<span id="cb31-48"><a href="#cb31-48" tabindex="-1"></a><span class="co">#&gt; 10   13  1.648547</span></span>
<span id="cb31-49"><a href="#cb31-49" tabindex="-1"></a><span class="co">#&gt; 11   14  1.654174</span></span>
<span id="cb31-50"><a href="#cb31-50" tabindex="-1"></a><span class="co">#&gt; 12   15  1.659098</span></span>
<span id="cb31-51"><a href="#cb31-51" tabindex="-1"></a><span class="co">#&gt; 13   16  1.663447</span></span>
<span id="cb31-52"><a href="#cb31-52" tabindex="-1"></a><span class="co">#&gt; 14   17  1.667287</span></span>
<span id="cb31-53"><a href="#cb31-53" tabindex="-1"></a><span class="co">#&gt; 15   18  1.670732</span></span>
<span id="cb31-54"><a href="#cb31-54" tabindex="-1"></a><span class="co">#&gt; 16   19  1.673831</span></span>
<span id="cb31-55"><a href="#cb31-55" tabindex="-1"></a><span class="co">#&gt; 17   20  1.676633</span></span>
<span id="cb31-56"><a href="#cb31-56" tabindex="-1"></a><span class="co">#&gt; 18   21  1.679147</span></span>
<span id="cb31-57"><a href="#cb31-57" tabindex="-1"></a><span class="co">#&gt; 19   22  1.681467</span></span>
<span id="cb31-58"><a href="#cb31-58" tabindex="-1"></a><span class="co">#&gt; 20   23  1.683593</span></span>
<span id="cb31-59"><a href="#cb31-59" tabindex="-1"></a><span class="co">#&gt; 21   24  1.685546</span></span>
<span id="cb31-60"><a href="#cb31-60" tabindex="-1"></a><span class="co">#&gt; 22   25  1.687348</span></span>
<span id="cb31-61"><a href="#cb31-61" tabindex="-1"></a><span class="co">#&gt; 23  100  1.720599</span></span>
<span id="cb31-62"><a href="#cb31-62" tabindex="-1"></a><span class="co">#&gt; 24  500 22.137073</span></span>
<span id="cb31-63"><a href="#cb31-63" tabindex="-1"></a><span class="co">#&gt; 25 1000 31.306549</span></span>
<span id="cb31-64"><a href="#cb31-64" tabindex="-1"></a> <span class="fu">cat</span>(<span class="st">&quot;Intersection points A(k) for k = 4:25, 100, 500, 1000:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb31-65"><a href="#cb31-65" tabindex="-1"></a><span class="co">#&gt; Intersection points A(k) for k = 4:25, 100, 500, 1000:</span></span>
<span id="cb31-66"><a href="#cb31-66" tabindex="-1"></a>  <span class="fu">print</span>(intersection_results)</span>
<span id="cb31-67"><a href="#cb31-67" tabindex="-1"></a><span class="co">#&gt;       k       A_k</span></span>
<span id="cb31-68"><a href="#cb31-68" tabindex="-1"></a><span class="co">#&gt; 1     4  1.492098</span></span>
<span id="cb31-69"><a href="#cb31-69" tabindex="-1"></a><span class="co">#&gt; 2     5  1.533544</span></span>
<span id="cb31-70"><a href="#cb31-70" tabindex="-1"></a><span class="co">#&gt; 3     6  1.562745</span></span>
<span id="cb31-71"><a href="#cb31-71" tabindex="-1"></a><span class="co">#&gt; 4     7  1.584429</span></span>
<span id="cb31-72"><a href="#cb31-72" tabindex="-1"></a><span class="co">#&gt; 5     8  1.601168</span></span>
<span id="cb31-73"><a href="#cb31-73" tabindex="-1"></a><span class="co">#&gt; 6     9  1.614516</span></span>
<span id="cb31-74"><a href="#cb31-74" tabindex="-1"></a><span class="co">#&gt; 7    10  1.625383</span></span>
<span id="cb31-75"><a href="#cb31-75" tabindex="-1"></a><span class="co">#&gt; 8    11  1.634411</span></span>
<span id="cb31-76"><a href="#cb31-76" tabindex="-1"></a><span class="co">#&gt; 9    12  1.642026</span></span>
<span id="cb31-77"><a href="#cb31-77" tabindex="-1"></a><span class="co">#&gt; 10   13  1.648547</span></span>
<span id="cb31-78"><a href="#cb31-78" tabindex="-1"></a><span class="co">#&gt; 11   14  1.654174</span></span>
<span id="cb31-79"><a href="#cb31-79" tabindex="-1"></a><span class="co">#&gt; 12   15  1.659098</span></span>
<span id="cb31-80"><a href="#cb31-80" tabindex="-1"></a><span class="co">#&gt; 13   16  1.663447</span></span>
<span id="cb31-81"><a href="#cb31-81" tabindex="-1"></a><span class="co">#&gt; 14   17  1.667287</span></span>
<span id="cb31-82"><a href="#cb31-82" tabindex="-1"></a><span class="co">#&gt; 15   18  1.670732</span></span>
<span id="cb31-83"><a href="#cb31-83" tabindex="-1"></a><span class="co">#&gt; 16   19  1.673831</span></span>
<span id="cb31-84"><a href="#cb31-84" tabindex="-1"></a><span class="co">#&gt; 17   20  1.676633</span></span>
<span id="cb31-85"><a href="#cb31-85" tabindex="-1"></a><span class="co">#&gt; 18   21  1.679147</span></span>
<span id="cb31-86"><a href="#cb31-86" tabindex="-1"></a><span class="co">#&gt; 19   22  1.681467</span></span>
<span id="cb31-87"><a href="#cb31-87" tabindex="-1"></a><span class="co">#&gt; 20   23  1.683593</span></span>
<span id="cb31-88"><a href="#cb31-88" tabindex="-1"></a><span class="co">#&gt; 21   24  1.685546</span></span>
<span id="cb31-89"><a href="#cb31-89" tabindex="-1"></a><span class="co">#&gt; 22   25  1.687348</span></span>
<span id="cb31-90"><a href="#cb31-90" tabindex="-1"></a><span class="co">#&gt; 23  100  1.720599</span></span>
<span id="cb31-91"><a href="#cb31-91" tabindex="-1"></a><span class="co">#&gt; 24  500 22.137073</span></span>
<span id="cb31-92"><a href="#cb31-92" tabindex="-1"></a><span class="co">#&gt; 25 1000 31.306549</span></span></code></pre></div>
</div>
<div id="question-b" class="section level2">
<h2>Question B</h2>
<p>Suppose <span class="math inline">\(T_1, \dots, T_n\)</span> are
i.i.d. samples drawn from the exponential distribution with expectation
<span class="math inline">\(\lambda\)</span>. Those values greater than
<span class="math inline">\(\tau\)</span> are not observed due to right
censorship, so that the observed values are: <span class="math display">\[
Y_i = T_i I(T_i \leq \tau) + \tau I(T_i &gt; \tau), \quad i = 1, \dots,
n.
\]</span> Suppose <span class="math inline">\(\tau = 1\)</span> and the
observed <span class="math inline">\(Y_i\)</span> values are as follows:
<span class="math display">\[
0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85.
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, and compare your result with the
observed data MLE (note: <span class="math inline">\(Y_i\)</span>
follows a mixture distribution).</p>
</div>
<div id="answer-b" class="section level2">
<h2>Answer B</h2>
<p>To estimate <span class="math inline">\(\lambda\)</span> using the
Expectation-Maximization (E-M) algorithm for the right-censored
exponential distribution, we need to iteratively estimate the missing
(censored) data and update <span class="math inline">\(\lambda\)</span>.
Here’s how to approach this:</p>
<ul>
<li>The observed data <span class="math inline">\(Y_1, \dots,
Y_n\)</span> with right-censorship threshold <span class="math inline">\(\tau = 1\)</span>.</li>
<li>Observed data: <span class="math inline">\(0.54, 0.48, 0.33, 0.43,
1.00, 1.00, 0.91, 1.00, 0.21, 0.85\)</span>.</li>
<li>Distribution: <span class="math inline">\(T_i \sim
\text{Exponential}(\lambda)\)</span>, with the density function: <span class="math display">\[
f(t \mid \lambda) = \lambda e^{-\lambda t}, \quad t \geq 0.
\]</span></li>
</ul>
</div>
<div id="e-m-algorithm-steps" class="section level2">
<h2>E-M Algorithm Steps</h2>
<p>Start with an initial guess for <span class="math inline">\(\lambda\)</span>, say <span class="math inline">\(\lambda^{(0)}\)</span>.</p>
</div>
<div id="expection" class="section level2">
<h2>Expection</h2>
<p>Calculate the expected value of the censored observations,
conditional on the current estimate of <span class="math inline">\(\lambda\)</span>. For censored values <span class="math inline">\(Y_i = \tau\)</span>, the expected value is: <span class="math display">\[
\mathbb{E}[T_i \mid T_i &gt; \tau, \lambda^{(k)}] = \tau +
\frac{1}{\lambda^{(k)}}.
\]</span></p>
</div>
<div id="maximization" class="section level2">
<h2>Maximization</h2>
<p>Update <span class="math inline">\(\lambda\)</span> by maximizing the
expected complete-data log-likelihood: <span class="math display">\[
\lambda^{(k+1)} = \frac{n}{\sum_{i=1}^n Y&#39;_i(\lambda^{(k)})}
\]</span> where <span class="math inline">\(Y&#39;_i(\lambda^{(k)})\)</span> is the observed
<span class="math inline">\(Y_i\)</span> for uncensored data and the
expected value for censored data.</p>
</div>
<div id="iteration" class="section level2">
<h2>Iteration</h2>
<p>Repeat the E-step and M-step until convergence (i.e., until <span class="math inline">\(\lambda^{(k+1)}\)</span> and <span class="math inline">\(\lambda^{(k)}\)</span> are sufficiently
close).</p>
</div>
<div id="applying-the-algorithm-to-the-given-data" class="section level2">
<h2>Applying the Algorithm to the Given Data</h2>
<ul>
<li>Observed data: <span class="math inline">\(0.54, 0.48, 0.33, 0.43,
1.00, 1.00, 0.91, 1.00, 0.21, 0.85\)</span>.</li>
<li>Censored values: <span class="math inline">\(1.00\)</span>
(indicating right-censored data points).</li>
</ul>
</div>
<div id="initialization" class="section level2">
<h2>Initialization</h2>
<p>Start with <span class="math inline">\(\lambda^{(0)} = 1\)</span> (or
any reasonable initial guess).</p>
<p>For the censored data points (<span class="math inline">\(Y_i =
1\)</span>), calculate: <span class="math display">\[
\mathbb{E}[T_i \mid T_i &gt; 1, \lambda^{(k)}] = 1 +
\frac{1}{\lambda^{(k)}}.
\]</span></p>
<p>Update <span class="math inline">\(\lambda\)</span>: <span class="math display">\[
\lambda^{(k+1)} = \frac{n}{\sum_{i=1}^n Y&#39;_i(\lambda^{(k)})}.
\]</span></p>
</div>
<div id="direct-mle-calculation-for-comparison" class="section level2">
<h2>Direct MLE Calculation for Comparison</h2>
<p>For the MLE, we maximize the likelihood function: <span class="math display">\[
L(\lambda) = \lambda^n e^{-\lambda \sum_{i=1}^n Y_i}.
\]</span></p>
<p>Taking the derivative and solving for <span class="math inline">\(\lambda\)</span>: <span class="math display">\[
\hat{\lambda}_{\text{MLE}} = \frac{n}{\sum_{i=1}^n Y_i}.
\]</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co">#Given observed data</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a> observed_data<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">0.91</span>,<span class="fl">1.00</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a> <span class="co">#Initial estimate of lambda</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a> lambda_est<span class="ot">&lt;-</span><span class="fl">1.0</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a> tolerance <span class="ot">&lt;-</span><span class="fl">1e-6</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a> max_iterations<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a> n<span class="ot">&lt;-</span><span class="fu">length</span>(observed_data)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a> censored_threshold<span class="ot">&lt;-</span><span class="fl">1.0</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a> <span class="co">#E-Malgorithm</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a> <span class="cf">for</span>(iteration <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iterations){</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a> <span class="co">#E-step: Calculate the expected values for censored data</span></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a> expected_values<span class="ot">&lt;-</span><span class="fu">ifelse</span>(</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a> observed_data <span class="sc">==</span>censored_threshold,</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a> censored_threshold <span class="sc">+</span><span class="dv">1</span> <span class="sc">/</span> lambda_est,</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a> observed_data</span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a> )</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a> <span class="co">#M-step:Update lambda</span></span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a> new_lambda_est<span class="ot">&lt;-</span>n<span class="sc">/</span><span class="fu">sum</span>(expected_values)</span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a> <span class="co">#Check for convergence</span></span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">abs</span>(new_lambda_est<span class="sc">-</span>lambda_est)<span class="sc">&lt;</span> tolerance){</span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a> <span class="cf">break</span></span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a> }</span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a> lambda_est<span class="ot">&lt;-</span>new_lambda_est</span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a> }</span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a> <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Estimated lambda using E-M:%.4f</span><span class="sc">\n</span><span class="st">&quot;</span>,lambda_est))</span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a><span class="co">#&gt; Estimated lambda using E-M:1.0370</span></span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a> <span class="do">##Estimated lambda using E-M:1.0370</span></span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a> <span class="co">#Compare with direct MLE</span></span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a> lambda_mle<span class="ot">&lt;-</span>n <span class="sc">/</span><span class="fu">sum</span>(observed_data)</span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a> <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;MLE estimate ofl ambda:%.4f</span><span class="sc">\n</span><span class="st">&quot;</span>,lambda_mle))</span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a><span class="co">#&gt; MLE estimate ofl ambda:1.4815</span></span></code></pre></div>
</div>
<div id="references-2" class="section level2">
<h2>References</h2>
<ul>
<li>Gamma % 20 Function.pdf. (2021). charleston.edu. <a href="https://williamsgj.people.charleston.edu/Gamma%" class="uri">https://williamsgj.people.charleston.edu/Gamma%</a> 20
Function.pdf</li>
<li>Daniel Kaplan (2020). Chapter 8 Integrals and integration
|RforCalculus. github.io. https:
//dtkaplan.github.io/RforCalculus/integrals-and-integration.html</li>
</ul>
</div>
<div id="homework-8-page-354-statistical-computing-with-r." class="section level2">
<h2>Homework 8 (page 354, Statistical Computing with R).</h2>
</div>
<div id="question-11.7" class="section level2">
<h2>Question 11.7</h2>
<p>Use the simplex algorithm to solve the following problem. Minimize
<span class="math inline">\(4x + 2y + 9z\)</span> subject to <span class="math display">\[
2x + y + z \leq 2
\]</span> <span class="math display">\[
x - y + 3z \leq 3
\]</span> <span class="math display">\[
x \geq 0, \quad y \geq 0, \quad z \geq 0.
\]</span></p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>We are tasked with solving the following linear programming problem
using the Simplex method:</p>
<p><span class="math display">\[
\text{Minimize } Z = 4x + 2y + 9z
\]</span> Subject to: <span class="math display">\[
2x + y + z \leq 2
\]</span> <span class="math display">\[
x - y + 3z \leq 3
\]</span> <span class="math display">\[
x \geq 0, \quad y \geq 0, \quad z \geq 0
\]</span></p>
<div id="step-1-convert-the-inequalities-to-equalities" class="section level3">
<h3>Step 1: Convert the inequalities to equalities</h3>
<p>To convert the inequalities into equalities, we introduce slack
variables <span class="math inline">\(s_1\)</span> and <span class="math inline">\(s_2\)</span> for each constraint: <span class="math display">\[
2x + y + z + s_1 = 2
\]</span> <span class="math display">\[
x - y + 3z + s_2 = 3
\]</span> where <span class="math inline">\(s_1, s_2 \geq
0\)</span>.</p>
</div>
<div id="step-2-set-up-the-initial-simplex-tableau" class="section level3">
<h3>Step 2: Set up the initial Simplex tableau</h3>
<p>The objective function is to minimize <span class="math inline">\(Z =
4x + 2y + 9z\)</span>, which we rewrite as a maximization problem by
minimizing <span class="math inline">\(-Z\)</span>, i.e., maximizing
<span class="math inline">\(-4x - 2y - 9z\)</span>.</p>
<p>The initial Simplex tableau is:</p>
<p><span class="math display">\[
\begin{array}{|c|c|c|c|c|c|c|}
\hline
\text{Basic Variables} &amp; x &amp; y &amp; z &amp; s_1 &amp; s_2 &amp;
\text{RHS} \\
\hline
s_1 &amp; 2 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 2 \\
s_2 &amp; 1 &amp; -1 &amp; 3 &amp; 0 &amp; 1 &amp; 3 \\
\hline
-Z &amp; -4 &amp; -2 &amp; -9 &amp; 0 &amp; 0 &amp; 0 \\
\hline
\end{array}
\]</span></p>
<p>Where: - The first two rows represent the constraints with slack
variables <span class="math inline">\(s_1\)</span> and <span class="math inline">\(s_2\)</span>. - The last row represents the
objective function, with the negative coefficients of the decision
variables.</p>
</div>
<div id="step-3-apply-the-simplex-method" class="section level3">
<h3>Step 3: Apply the Simplex method</h3>
<div id="iteration-1" class="section level4">
<h4>Iteration 1:</h4>
<ul>
<li>The most negative value in the objective row is <span class="math inline">\(-9\)</span> (for the <span class="math inline">\(z\)</span>-column), so <span class="math inline">\(z\)</span> enters the basis.</li>
<li>The pivot row is <span class="math inline">\(s_2\)</span>, as the
smallest ratio of RHS to the positive pivot column value is <span class="math inline">\(\frac{3}{3} = 1\)</span>.</li>
</ul>
<p>Performing the pivot operation results in the following updated
tableau:</p>
<p><span class="math display">\[
\begin{array}{|c|c|c|c|c|c|c|}
\hline
\text{Basic Variables} &amp; x &amp; y &amp; z &amp; s_1 &amp; s_2 &amp;
\text{RHS} \\
\hline
s_1 &amp; 1 &amp; 2 &amp; 0 &amp; 1 &amp; -1 &amp; 1 \\
z &amp; \frac{1}{3} &amp; -\frac{1}{3} &amp; 1 &amp; 0 &amp; \frac{1}{3}
&amp; 1 \\
\hline
-Z &amp; 0 &amp; -\frac{4}{3} &amp; 0 &amp; 0 &amp; 3 &amp; 9 \\
\hline
\end{array}
\]</span></p>
</div>
<div id="iteration-2" class="section level4">
<h4>Iteration 2:</h4>
<ul>
<li>The most negative value in the objective row is <span class="math inline">\(-\frac{4}{3}\)</span> (for the <span class="math inline">\(y\)</span>-column), so <span class="math inline">\(y\)</span> enters the basis.</li>
<li>The pivot row is <span class="math inline">\(s_1\)</span>, as the
smallest ratio of RHS to the positive pivot column value is <span class="math inline">\(\frac{1}{2}\)</span>.</li>
</ul>
<p>Performing the pivot operation results in the following updated
tableau:</p>
<p><span class="math display">\[
\begin{array}{|c|c|c|c|c|c|c|}
\hline
\text{Basic Variables} &amp; x &amp; y &amp; z &amp; s_1 &amp; s_2 &amp;
\text{RHS} \\
\hline
y &amp; \frac{3}{2} &amp; 1 &amp; 0 &amp; \frac{1}{2} &amp; -\frac{1}{2}
&amp; \frac{1}{2} \\
z &amp; -\frac{1}{3} &amp; 0 &amp; 1 &amp; \frac{1}{3} &amp; \frac{2}{3}
&amp; 1 \\
\hline
-Z &amp; 2 &amp; 0 &amp; 0 &amp; 2 &amp; 0 &amp; 10 \\
\hline
\end{array}
\]</span></p>
</div>
<div id="iteration-3" class="section level4">
<h4>Iteration 3:</h4>
<ul>
<li>The most negative value in the objective row is <span class="math inline">\(2\)</span> (for the <span class="math inline">\(x\)</span>-column), so <span class="math inline">\(x\)</span> enters the basis.</li>
<li>The pivot row is <span class="math inline">\(y\)</span>, as the
smallest ratio of RHS to the positive pivot column value is <span class="math inline">\(\frac{1}{3}\)</span>.</li>
</ul>
<p>Performing the pivot operation results in the following updated
tableau:</p>
<p><span class="math display">\[
\begin{array}{|c|c|c|c|c|c|c|}
\hline
\text{Basic Variables} &amp; x &amp; y &amp; z &amp; s_1 &amp; s_2 &amp;
\text{RHS} \\
\hline
x &amp; 1 &amp; 0 &amp; 0 &amp; \frac{1}{3} &amp; -\frac{1}{3} &amp;
\frac{1}{3} \\
z &amp; 0 &amp; 0 &amp; 1 &amp; \frac{1}{2} &amp; \frac{1}{2} &amp;
\frac{2}{3} \\
\hline
-Z &amp; 0 &amp; 0 &amp; 0 &amp; 4 &amp; 4 &amp; 12 \\
\hline
\end{array}
\]</span></p>
</div>
</div>
<div id="step-4-final-solution" class="section level3">
<h3>Step 4: Final Solution</h3>
<p>At this point, there are no more negative values in the objective
row, indicating that the optimal solution has been reached.</p>
<p>The values of the variables are:</p>
<p><span class="math display">\[
x = \frac{1}{3}, \quad y = \frac{1}{2}, \quad z = \frac{2}{3}
\]</span></p>
<p>The minimum value of the objective function is:</p>
<p><span class="math display">\[
Z = 12
\]</span></p>
<p>Thus, the optimal solution is:</p>
<p><span class="math display">\[
\boxed{x = \frac{1}{3}, \quad y = \frac{1}{2}, \quad z = \frac{2}{3}}
\]</span> with the minimum value of the objective function being <span class="math inline">\(Z = 12\)</span>.</p>
</div>
</div>
<div id="question-3-page-204" class="section level2">
<h2>Question 3 page 204</h2>
<p>Use both for loops and to fit linear models to the using the formulas
stored in this list:</p>
<p><span class="math display">\[
\texttt{formulas} \leftarrow \texttt{list}(
\texttt{mpg} \sim \texttt{disp},
\texttt{mpg} \sim \texttt{I(1 / disp)},
\texttt{mpg} \sim \texttt{disp + wt},
\texttt{mpg} \sim \texttt{I(1 / disp) + wt}
)
\]</span></p>
</div>
<div id="answer-3-page-204" class="section level2">
<h2>Answer 3 page 204</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co"># List of formulas</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>)</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="co"># List to store model results</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>lm_results_for <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="co"># Loop through the formulas</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(formulas)) {</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>  lm_results_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>}</span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="co"># Print summary of models</span></span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a><span class="fu">lapply</span>(lm_results_for, summary)</span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a><span class="co">#&gt; -4.8922 -2.2022 -0.9631  1.6272  7.2305 </span></span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-32"><a href="#cb33-32" tabindex="-1"></a><span class="co">#&gt; (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***</span></span>
<span id="cb33-33"><a href="#cb33-33" tabindex="-1"></a><span class="co">#&gt; disp        -0.041215   0.004712  -8.747 9.38e-10 ***</span></span>
<span id="cb33-34"><a href="#cb33-34" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-35"><a href="#cb33-35" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-36"><a href="#cb33-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-37"><a href="#cb33-37" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.251 on 30 degrees of freedom</span></span>
<span id="cb33-38"><a href="#cb33-38" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 </span></span>
<span id="cb33-39"><a href="#cb33-39" tabindex="-1"></a><span class="co">#&gt; F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10</span></span>
<span id="cb33-40"><a href="#cb33-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-41"><a href="#cb33-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-42"><a href="#cb33-42" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb33-43"><a href="#cb33-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-44"><a href="#cb33-44" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-45"><a href="#cb33-45" tabindex="-1"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb33-46"><a href="#cb33-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-47"><a href="#cb33-47" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb33-48"><a href="#cb33-48" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb33-49"><a href="#cb33-49" tabindex="-1"></a><span class="co">#&gt; -3.7383 -1.8216 -0.0751  1.0487  4.6105 </span></span>
<span id="cb33-50"><a href="#cb33-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-51"><a href="#cb33-51" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-52"><a href="#cb33-52" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-53"><a href="#cb33-53" tabindex="-1"></a><span class="co">#&gt; (Intercept)   10.7520     0.7994   13.45 3.06e-14 ***</span></span>
<span id="cb33-54"><a href="#cb33-54" tabindex="-1"></a><span class="co">#&gt; I(1/disp)   1557.6739   114.8935   13.56 2.49e-14 ***</span></span>
<span id="cb33-55"><a href="#cb33-55" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-56"><a href="#cb33-56" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-57"><a href="#cb33-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-58"><a href="#cb33-58" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.295 on 30 degrees of freedom</span></span>
<span id="cb33-59"><a href="#cb33-59" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8597, Adjusted R-squared:  0.855 </span></span>
<span id="cb33-60"><a href="#cb33-60" tabindex="-1"></a><span class="co">#&gt; F-statistic: 183.8 on 1 and 30 DF,  p-value: 2.494e-14</span></span>
<span id="cb33-61"><a href="#cb33-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-62"><a href="#cb33-62" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-63"><a href="#cb33-63" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb33-64"><a href="#cb33-64" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-65"><a href="#cb33-65" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-66"><a href="#cb33-66" tabindex="-1"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb33-67"><a href="#cb33-67" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-68"><a href="#cb33-68" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb33-69"><a href="#cb33-69" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb33-70"><a href="#cb33-70" tabindex="-1"></a><span class="co">#&gt; -3.4087 -2.3243 -0.7683  1.7721  6.3484 </span></span>
<span id="cb33-71"><a href="#cb33-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-72"><a href="#cb33-72" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-73"><a href="#cb33-73" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-74"><a href="#cb33-74" tabindex="-1"></a><span class="co">#&gt; (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***</span></span>
<span id="cb33-75"><a href="#cb33-75" tabindex="-1"></a><span class="co">#&gt; disp        -0.01773    0.00919  -1.929  0.06362 .  </span></span>
<span id="cb33-76"><a href="#cb33-76" tabindex="-1"></a><span class="co">#&gt; wt          -3.35082    1.16413  -2.878  0.00743 ** </span></span>
<span id="cb33-77"><a href="#cb33-77" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-78"><a href="#cb33-78" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-79"><a href="#cb33-79" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-80"><a href="#cb33-80" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.917 on 29 degrees of freedom</span></span>
<span id="cb33-81"><a href="#cb33-81" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 </span></span>
<span id="cb33-82"><a href="#cb33-82" tabindex="-1"></a><span class="co">#&gt; F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10</span></span>
<span id="cb33-83"><a href="#cb33-83" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-84"><a href="#cb33-84" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-85"><a href="#cb33-85" tabindex="-1"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb33-86"><a href="#cb33-86" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-87"><a href="#cb33-87" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-88"><a href="#cb33-88" tabindex="-1"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb33-89"><a href="#cb33-89" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-90"><a href="#cb33-90" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb33-91"><a href="#cb33-91" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb33-92"><a href="#cb33-92" tabindex="-1"></a><span class="co">#&gt; -2.7085 -1.5121 -0.6191  1.5142  4.2314 </span></span>
<span id="cb33-93"><a href="#cb33-93" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-94"><a href="#cb33-94" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-95"><a href="#cb33-95" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-96"><a href="#cb33-96" tabindex="-1"></a><span class="co">#&gt; (Intercept)   19.0242     3.4520   5.511 6.13e-06 ***</span></span>
<span id="cb33-97"><a href="#cb33-97" tabindex="-1"></a><span class="co">#&gt; I(1/disp)   1142.5600   199.8427   5.717 3.47e-06 ***</span></span>
<span id="cb33-98"><a href="#cb33-98" tabindex="-1"></a><span class="co">#&gt; wt            -1.7976     0.7327  -2.453   0.0204 *  </span></span>
<span id="cb33-99"><a href="#cb33-99" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-100"><a href="#cb33-100" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-101"><a href="#cb33-101" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-102"><a href="#cb33-102" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.124 on 29 degrees of freedom</span></span>
<span id="cb33-103"><a href="#cb33-103" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8838, Adjusted R-squared:  0.8758 </span></span>
<span id="cb33-104"><a href="#cb33-104" tabindex="-1"></a><span class="co">#&gt; F-statistic: 110.3 on 2 and 29 DF,  p-value: 2.788e-14</span></span>
<span id="cb33-105"><a href="#cb33-105" tabindex="-1"></a></span>
<span id="cb33-106"><a href="#cb33-106" tabindex="-1"></a><span class="co"># Using lapply to apply linear models</span></span>
<span id="cb33-107"><a href="#cb33-107" tabindex="-1"></a>lm_results_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data =</span> mtcars))</span>
<span id="cb33-108"><a href="#cb33-108" tabindex="-1"></a></span>
<span id="cb33-109"><a href="#cb33-109" tabindex="-1"></a><span class="co"># Print summary of models</span></span>
<span id="cb33-110"><a href="#cb33-110" tabindex="-1"></a><span class="fu">lapply</span>(lm_results_lapply, summary)</span>
<span id="cb33-111"><a href="#cb33-111" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb33-112"><a href="#cb33-112" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-113"><a href="#cb33-113" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-114"><a href="#cb33-114" tabindex="-1"></a><span class="co">#&gt; lm(formula = f, data = mtcars)</span></span>
<span id="cb33-115"><a href="#cb33-115" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-116"><a href="#cb33-116" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb33-117"><a href="#cb33-117" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb33-118"><a href="#cb33-118" tabindex="-1"></a><span class="co">#&gt; -4.8922 -2.2022 -0.9631  1.6272  7.2305 </span></span>
<span id="cb33-119"><a href="#cb33-119" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-120"><a href="#cb33-120" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-121"><a href="#cb33-121" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-122"><a href="#cb33-122" tabindex="-1"></a><span class="co">#&gt; (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***</span></span>
<span id="cb33-123"><a href="#cb33-123" tabindex="-1"></a><span class="co">#&gt; disp        -0.041215   0.004712  -8.747 9.38e-10 ***</span></span>
<span id="cb33-124"><a href="#cb33-124" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-125"><a href="#cb33-125" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-126"><a href="#cb33-126" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-127"><a href="#cb33-127" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.251 on 30 degrees of freedom</span></span>
<span id="cb33-128"><a href="#cb33-128" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 </span></span>
<span id="cb33-129"><a href="#cb33-129" tabindex="-1"></a><span class="co">#&gt; F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10</span></span>
<span id="cb33-130"><a href="#cb33-130" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-131"><a href="#cb33-131" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-132"><a href="#cb33-132" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb33-133"><a href="#cb33-133" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-134"><a href="#cb33-134" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-135"><a href="#cb33-135" tabindex="-1"></a><span class="co">#&gt; lm(formula = f, data = mtcars)</span></span>
<span id="cb33-136"><a href="#cb33-136" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-137"><a href="#cb33-137" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb33-138"><a href="#cb33-138" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb33-139"><a href="#cb33-139" tabindex="-1"></a><span class="co">#&gt; -3.7383 -1.8216 -0.0751  1.0487  4.6105 </span></span>
<span id="cb33-140"><a href="#cb33-140" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-141"><a href="#cb33-141" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-142"><a href="#cb33-142" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-143"><a href="#cb33-143" tabindex="-1"></a><span class="co">#&gt; (Intercept)   10.7520     0.7994   13.45 3.06e-14 ***</span></span>
<span id="cb33-144"><a href="#cb33-144" tabindex="-1"></a><span class="co">#&gt; I(1/disp)   1557.6739   114.8935   13.56 2.49e-14 ***</span></span>
<span id="cb33-145"><a href="#cb33-145" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-146"><a href="#cb33-146" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-147"><a href="#cb33-147" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-148"><a href="#cb33-148" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.295 on 30 degrees of freedom</span></span>
<span id="cb33-149"><a href="#cb33-149" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8597, Adjusted R-squared:  0.855 </span></span>
<span id="cb33-150"><a href="#cb33-150" tabindex="-1"></a><span class="co">#&gt; F-statistic: 183.8 on 1 and 30 DF,  p-value: 2.494e-14</span></span>
<span id="cb33-151"><a href="#cb33-151" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-152"><a href="#cb33-152" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-153"><a href="#cb33-153" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb33-154"><a href="#cb33-154" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-155"><a href="#cb33-155" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-156"><a href="#cb33-156" tabindex="-1"></a><span class="co">#&gt; lm(formula = f, data = mtcars)</span></span>
<span id="cb33-157"><a href="#cb33-157" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-158"><a href="#cb33-158" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb33-159"><a href="#cb33-159" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb33-160"><a href="#cb33-160" tabindex="-1"></a><span class="co">#&gt; -3.4087 -2.3243 -0.7683  1.7721  6.3484 </span></span>
<span id="cb33-161"><a href="#cb33-161" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-162"><a href="#cb33-162" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-163"><a href="#cb33-163" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-164"><a href="#cb33-164" tabindex="-1"></a><span class="co">#&gt; (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***</span></span>
<span id="cb33-165"><a href="#cb33-165" tabindex="-1"></a><span class="co">#&gt; disp        -0.01773    0.00919  -1.929  0.06362 .  </span></span>
<span id="cb33-166"><a href="#cb33-166" tabindex="-1"></a><span class="co">#&gt; wt          -3.35082    1.16413  -2.878  0.00743 ** </span></span>
<span id="cb33-167"><a href="#cb33-167" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-168"><a href="#cb33-168" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-169"><a href="#cb33-169" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-170"><a href="#cb33-170" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.917 on 29 degrees of freedom</span></span>
<span id="cb33-171"><a href="#cb33-171" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 </span></span>
<span id="cb33-172"><a href="#cb33-172" tabindex="-1"></a><span class="co">#&gt; F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10</span></span>
<span id="cb33-173"><a href="#cb33-173" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-174"><a href="#cb33-174" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-175"><a href="#cb33-175" tabindex="-1"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb33-176"><a href="#cb33-176" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-177"><a href="#cb33-177" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-178"><a href="#cb33-178" tabindex="-1"></a><span class="co">#&gt; lm(formula = f, data = mtcars)</span></span>
<span id="cb33-179"><a href="#cb33-179" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-180"><a href="#cb33-180" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb33-181"><a href="#cb33-181" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb33-182"><a href="#cb33-182" tabindex="-1"></a><span class="co">#&gt; -2.7085 -1.5121 -0.6191  1.5142  4.2314 </span></span>
<span id="cb33-183"><a href="#cb33-183" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-184"><a href="#cb33-184" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-185"><a href="#cb33-185" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-186"><a href="#cb33-186" tabindex="-1"></a><span class="co">#&gt; (Intercept)   19.0242     3.4520   5.511 6.13e-06 ***</span></span>
<span id="cb33-187"><a href="#cb33-187" tabindex="-1"></a><span class="co">#&gt; I(1/disp)   1142.5600   199.8427   5.717 3.47e-06 ***</span></span>
<span id="cb33-188"><a href="#cb33-188" tabindex="-1"></a><span class="co">#&gt; wt            -1.7976     0.7327  -2.453   0.0204 *  </span></span>
<span id="cb33-189"><a href="#cb33-189" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-190"><a href="#cb33-190" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-191"><a href="#cb33-191" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-192"><a href="#cb33-192" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.124 on 29 degrees of freedom</span></span>
<span id="cb33-193"><a href="#cb33-193" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8838, Adjusted R-squared:  0.8758 </span></span>
<span id="cb33-194"><a href="#cb33-194" tabindex="-1"></a><span class="co">#&gt; F-statistic: 110.3 on 2 and 29 DF,  p-value: 2.788e-14</span></span></code></pre></div>
</div>
<div id="question-4-page-204" class="section level2">
<h2>Question 4 page 204</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply(). Can you do it
without an anonymous function? bootstraps &lt;- lapply(1:10, function(i)
{ rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
</div>
<div id="answers-4-page-204" class="section level2">
<h2>Answers 4 page 204</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co"># Function to fit the model mpg ~ disp</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>}</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="co"># Bootstrapping mtcars dataset</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)  <span class="co"># Sampling with replacement</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>})</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="co"># List to store model results</span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>lm_results_for <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a><span class="co"># Fit the model for each bootstrap replicate using a for loop</span></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bootstraps)) {</span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>  lm_results_for[[i]] <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(bootstraps[[i]])</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>}</span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a><span class="co"># Print summaries of models</span></span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a><span class="fu">lapply</span>(lm_results_for, summary)</span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-29"><a href="#cb34-29" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-30"><a href="#cb34-30" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb34-31"><a href="#cb34-31" tabindex="-1"></a><span class="co">#&gt; -5.1644 -2.8672 -0.7795  2.3960  5.4357 </span></span>
<span id="cb34-32"><a href="#cb34-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-33"><a href="#cb34-33" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-34"><a href="#cb34-34" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-35"><a href="#cb34-35" tabindex="-1"></a><span class="co">#&gt; (Intercept) 31.927933   1.135160   28.13  &lt; 2e-16 ***</span></span>
<span id="cb34-36"><a href="#cb34-36" tabindex="-1"></a><span class="co">#&gt; disp        -0.048714   0.004554  -10.70  9.3e-12 ***</span></span>
<span id="cb34-37"><a href="#cb34-37" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-38"><a href="#cb34-38" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-39"><a href="#cb34-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-40"><a href="#cb34-40" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.307 on 30 degrees of freedom</span></span>
<span id="cb34-41"><a href="#cb34-41" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7923, Adjusted R-squared:  0.7854 </span></span>
<span id="cb34-42"><a href="#cb34-42" tabindex="-1"></a><span class="co">#&gt; F-statistic: 114.4 on 1 and 30 DF,  p-value: 9.304e-12</span></span>
<span id="cb34-43"><a href="#cb34-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-44"><a href="#cb34-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-45"><a href="#cb34-45" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb34-46"><a href="#cb34-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-47"><a href="#cb34-47" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-48"><a href="#cb34-48" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-49"><a href="#cb34-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-50"><a href="#cb34-50" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-51"><a href="#cb34-51" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb34-52"><a href="#cb34-52" tabindex="-1"></a><span class="co">#&gt; -5.4312 -1.6423  0.1941  2.0114  5.3901 </span></span>
<span id="cb34-53"><a href="#cb34-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-54"><a href="#cb34-54" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-55"><a href="#cb34-55" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-56"><a href="#cb34-56" tabindex="-1"></a><span class="co">#&gt; (Intercept) 30.355141   1.076090  28.209  &lt; 2e-16 ***</span></span>
<span id="cb34-57"><a href="#cb34-57" tabindex="-1"></a><span class="co">#&gt; disp        -0.042506   0.004606  -9.228 2.87e-10 ***</span></span>
<span id="cb34-58"><a href="#cb34-58" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-59"><a href="#cb34-59" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-60"><a href="#cb34-60" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-61"><a href="#cb34-61" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.865 on 30 degrees of freedom</span></span>
<span id="cb34-62"><a href="#cb34-62" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7395, Adjusted R-squared:  0.7308 </span></span>
<span id="cb34-63"><a href="#cb34-63" tabindex="-1"></a><span class="co">#&gt; F-statistic: 85.16 on 1 and 30 DF,  p-value: 2.87e-10</span></span>
<span id="cb34-64"><a href="#cb34-64" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-65"><a href="#cb34-65" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-66"><a href="#cb34-66" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb34-67"><a href="#cb34-67" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-68"><a href="#cb34-68" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-69"><a href="#cb34-69" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-70"><a href="#cb34-70" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-71"><a href="#cb34-71" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-72"><a href="#cb34-72" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb34-73"><a href="#cb34-73" tabindex="-1"></a><span class="co">#&gt; -3.020 -2.107 -1.183  2.278  5.936 </span></span>
<span id="cb34-74"><a href="#cb34-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-75"><a href="#cb34-75" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-76"><a href="#cb34-76" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-77"><a href="#cb34-77" tabindex="-1"></a><span class="co">#&gt; (Intercept) 27.789131   1.160276  23.950  &lt; 2e-16 ***</span></span>
<span id="cb34-78"><a href="#cb34-78" tabindex="-1"></a><span class="co">#&gt; disp        -0.034961   0.004835  -7.231 4.76e-08 ***</span></span>
<span id="cb34-79"><a href="#cb34-79" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-80"><a href="#cb34-80" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-81"><a href="#cb34-81" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-82"><a href="#cb34-82" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.834 on 30 degrees of freedom</span></span>
<span id="cb34-83"><a href="#cb34-83" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.6354, Adjusted R-squared:  0.6232 </span></span>
<span id="cb34-84"><a href="#cb34-84" tabindex="-1"></a><span class="co">#&gt; F-statistic: 52.28 on 1 and 30 DF,  p-value: 4.765e-08</span></span>
<span id="cb34-85"><a href="#cb34-85" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-86"><a href="#cb34-86" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-87"><a href="#cb34-87" tabindex="-1"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb34-88"><a href="#cb34-88" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-89"><a href="#cb34-89" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-90"><a href="#cb34-90" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-91"><a href="#cb34-91" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-92"><a href="#cb34-92" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-93"><a href="#cb34-93" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb34-94"><a href="#cb34-94" tabindex="-1"></a><span class="co">#&gt; -4.3822 -2.1781 -0.6815  2.5706  5.8627 </span></span>
<span id="cb34-95"><a href="#cb34-95" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-96"><a href="#cb34-96" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-97"><a href="#cb34-97" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-98"><a href="#cb34-98" tabindex="-1"></a><span class="co">#&gt; (Intercept) 31.250392   1.149925   27.18  &lt; 2e-16 ***</span></span>
<span id="cb34-99"><a href="#cb34-99" tabindex="-1"></a><span class="co">#&gt; disp        -0.045191   0.003815  -11.85 7.69e-13 ***</span></span>
<span id="cb34-100"><a href="#cb34-100" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-101"><a href="#cb34-101" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-102"><a href="#cb34-102" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-103"><a href="#cb34-103" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.777 on 30 degrees of freedom</span></span>
<span id="cb34-104"><a href="#cb34-104" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8239, Adjusted R-squared:  0.818 </span></span>
<span id="cb34-105"><a href="#cb34-105" tabindex="-1"></a><span class="co">#&gt; F-statistic: 140.3 on 1 and 30 DF,  p-value: 7.688e-13</span></span>
<span id="cb34-106"><a href="#cb34-106" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-107"><a href="#cb34-107" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-108"><a href="#cb34-108" tabindex="-1"></a><span class="co">#&gt; [[5]]</span></span>
<span id="cb34-109"><a href="#cb34-109" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-110"><a href="#cb34-110" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-111"><a href="#cb34-111" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-112"><a href="#cb34-112" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-113"><a href="#cb34-113" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-114"><a href="#cb34-114" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb34-115"><a href="#cb34-115" tabindex="-1"></a><span class="co">#&gt; -4.4333 -1.7285 -0.7182  1.3525  7.9074 </span></span>
<span id="cb34-116"><a href="#cb34-116" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-117"><a href="#cb34-117" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-118"><a href="#cb34-118" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-119"><a href="#cb34-119" tabindex="-1"></a><span class="co">#&gt; (Intercept) 28.762347   1.184340  24.286  &lt; 2e-16 ***</span></span>
<span id="cb34-120"><a href="#cb34-120" tabindex="-1"></a><span class="co">#&gt; disp        -0.038956   0.004499  -8.658 1.17e-09 ***</span></span>
<span id="cb34-121"><a href="#cb34-121" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-122"><a href="#cb34-122" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-123"><a href="#cb34-123" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-124"><a href="#cb34-124" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.883 on 30 degrees of freedom</span></span>
<span id="cb34-125"><a href="#cb34-125" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7142, Adjusted R-squared:  0.7047 </span></span>
<span id="cb34-126"><a href="#cb34-126" tabindex="-1"></a><span class="co">#&gt; F-statistic: 74.97 on 1 and 30 DF,  p-value: 1.171e-09</span></span>
<span id="cb34-127"><a href="#cb34-127" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-128"><a href="#cb34-128" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-129"><a href="#cb34-129" tabindex="-1"></a><span class="co">#&gt; [[6]]</span></span>
<span id="cb34-130"><a href="#cb34-130" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-131"><a href="#cb34-131" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-132"><a href="#cb34-132" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-133"><a href="#cb34-133" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-134"><a href="#cb34-134" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-135"><a href="#cb34-135" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb34-136"><a href="#cb34-136" tabindex="-1"></a><span class="co">#&gt; -6.1134 -2.4803 -0.0128  2.2116  6.0971 </span></span>
<span id="cb34-137"><a href="#cb34-137" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-138"><a href="#cb34-138" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-139"><a href="#cb34-139" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-140"><a href="#cb34-140" tabindex="-1"></a><span class="co">#&gt; (Intercept) 31.70970    1.29040  24.574  &lt; 2e-16 ***</span></span>
<span id="cb34-141"><a href="#cb34-141" tabindex="-1"></a><span class="co">#&gt; disp        -0.04652    0.00471  -9.876 6.12e-11 ***</span></span>
<span id="cb34-142"><a href="#cb34-142" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-143"><a href="#cb34-143" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-144"><a href="#cb34-144" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-145"><a href="#cb34-145" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.241 on 30 degrees of freedom</span></span>
<span id="cb34-146"><a href="#cb34-146" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7648, Adjusted R-squared:  0.7569 </span></span>
<span id="cb34-147"><a href="#cb34-147" tabindex="-1"></a><span class="co">#&gt; F-statistic: 97.53 on 1 and 30 DF,  p-value: 6.116e-11</span></span>
<span id="cb34-148"><a href="#cb34-148" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-149"><a href="#cb34-149" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-150"><a href="#cb34-150" tabindex="-1"></a><span class="co">#&gt; [[7]]</span></span>
<span id="cb34-151"><a href="#cb34-151" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-152"><a href="#cb34-152" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-153"><a href="#cb34-153" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-154"><a href="#cb34-154" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-155"><a href="#cb34-155" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-156"><a href="#cb34-156" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb34-157"><a href="#cb34-157" tabindex="-1"></a><span class="co">#&gt; -5.289 -2.619 -1.377  2.326  7.015 </span></span>
<span id="cb34-158"><a href="#cb34-158" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-159"><a href="#cb34-159" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-160"><a href="#cb34-160" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-161"><a href="#cb34-161" tabindex="-1"></a><span class="co">#&gt; (Intercept) 29.682086   1.586750  18.706  &lt; 2e-16 ***</span></span>
<span id="cb34-162"><a href="#cb34-162" tabindex="-1"></a><span class="co">#&gt; disp        -0.039336   0.005661  -6.948 1.02e-07 ***</span></span>
<span id="cb34-163"><a href="#cb34-163" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-164"><a href="#cb34-164" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-165"><a href="#cb34-165" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-166"><a href="#cb34-166" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.784 on 30 degrees of freedom</span></span>
<span id="cb34-167"><a href="#cb34-167" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.6168, Adjusted R-squared:  0.604 </span></span>
<span id="cb34-168"><a href="#cb34-168" tabindex="-1"></a><span class="co">#&gt; F-statistic: 48.28 on 1 and 30 DF,  p-value: 1.02e-07</span></span>
<span id="cb34-169"><a href="#cb34-169" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-170"><a href="#cb34-170" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-171"><a href="#cb34-171" tabindex="-1"></a><span class="co">#&gt; [[8]]</span></span>
<span id="cb34-172"><a href="#cb34-172" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-173"><a href="#cb34-173" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-174"><a href="#cb34-174" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-175"><a href="#cb34-175" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-176"><a href="#cb34-176" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-177"><a href="#cb34-177" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb34-178"><a href="#cb34-178" tabindex="-1"></a><span class="co">#&gt; -3.734 -2.247 -1.237  2.384  5.830 </span></span>
<span id="cb34-179"><a href="#cb34-179" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-180"><a href="#cb34-180" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-181"><a href="#cb34-181" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-182"><a href="#cb34-182" tabindex="-1"></a><span class="co">#&gt; (Intercept) 29.831145   1.292734   23.08  &lt; 2e-16 ***</span></span>
<span id="cb34-183"><a href="#cb34-183" tabindex="-1"></a><span class="co">#&gt; disp        -0.041153   0.004736   -8.69 1.08e-09 ***</span></span>
<span id="cb34-184"><a href="#cb34-184" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-185"><a href="#cb34-185" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-186"><a href="#cb34-186" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-187"><a href="#cb34-187" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.267 on 30 degrees of freedom</span></span>
<span id="cb34-188"><a href="#cb34-188" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7157, Adjusted R-squared:  0.7062 </span></span>
<span id="cb34-189"><a href="#cb34-189" tabindex="-1"></a><span class="co">#&gt; F-statistic: 75.51 on 1 and 30 DF,  p-value: 1.083e-09</span></span>
<span id="cb34-190"><a href="#cb34-190" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-191"><a href="#cb34-191" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-192"><a href="#cb34-192" tabindex="-1"></a><span class="co">#&gt; [[9]]</span></span>
<span id="cb34-193"><a href="#cb34-193" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-194"><a href="#cb34-194" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-195"><a href="#cb34-195" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-196"><a href="#cb34-196" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-197"><a href="#cb34-197" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-198"><a href="#cb34-198" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb34-199"><a href="#cb34-199" tabindex="-1"></a><span class="co">#&gt; -4.266 -1.894 -1.125  1.813  6.902 </span></span>
<span id="cb34-200"><a href="#cb34-200" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-201"><a href="#cb34-201" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-202"><a href="#cb34-202" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-203"><a href="#cb34-203" tabindex="-1"></a><span class="co">#&gt; (Intercept) 28.536799   1.089632  26.189  &lt; 2e-16 ***</span></span>
<span id="cb34-204"><a href="#cb34-204" tabindex="-1"></a><span class="co">#&gt; disp        -0.038606   0.004365  -8.845 7.35e-10 ***</span></span>
<span id="cb34-205"><a href="#cb34-205" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-206"><a href="#cb34-206" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-207"><a href="#cb34-207" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-208"><a href="#cb34-208" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.899 on 30 degrees of freedom</span></span>
<span id="cb34-209"><a href="#cb34-209" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7228, Adjusted R-squared:  0.7136 </span></span>
<span id="cb34-210"><a href="#cb34-210" tabindex="-1"></a><span class="co">#&gt; F-statistic: 78.24 on 1 and 30 DF,  p-value: 7.35e-10</span></span>
<span id="cb34-211"><a href="#cb34-211" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-212"><a href="#cb34-212" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-213"><a href="#cb34-213" tabindex="-1"></a><span class="co">#&gt; [[10]]</span></span>
<span id="cb34-214"><a href="#cb34-214" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-215"><a href="#cb34-215" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-216"><a href="#cb34-216" tabindex="-1"></a><span class="co">#&gt; lm(formula = mpg ~ disp, data = data)</span></span>
<span id="cb34-217"><a href="#cb34-217" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-218"><a href="#cb34-218" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb34-219"><a href="#cb34-219" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb34-220"><a href="#cb34-220" tabindex="-1"></a><span class="co">#&gt; -2.619 -1.837 -1.176  1.888  5.375 </span></span>
<span id="cb34-221"><a href="#cb34-221" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-222"><a href="#cb34-222" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-223"><a href="#cb34-223" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-224"><a href="#cb34-224" tabindex="-1"></a><span class="co">#&gt; (Intercept) 28.471976   1.087423  26.183  &lt; 2e-16 ***</span></span>
<span id="cb34-225"><a href="#cb34-225" tabindex="-1"></a><span class="co">#&gt; disp        -0.036243   0.004028  -8.998 5.03e-10 ***</span></span>
<span id="cb34-226"><a href="#cb34-226" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-227"><a href="#cb34-227" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-228"><a href="#cb34-228" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-229"><a href="#cb34-229" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.682 on 30 degrees of freedom</span></span>
<span id="cb34-230"><a href="#cb34-230" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7297, Adjusted R-squared:  0.7207 </span></span>
<span id="cb34-231"><a href="#cb34-231" tabindex="-1"></a><span class="co">#&gt; F-statistic: 80.97 on 1 and 30 DF,  p-value: 5.034e-10</span></span></code></pre></div>
</div>
<div id="question-5-page-204" class="section level2">
<h2>Question 5 Page 204</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<p><span class="math display">\[
\texttt{rsq} \leftarrow \texttt{function(mod) summary(mod)\$r.squared}
\]</span></p>
</div>
<div id="answer-5-page-204" class="section level2">
<h2>Answer 5 Page 204</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="co"># Define the function to extract R^2</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="co"># Assuming lm_results_for is the list of models fitted with a for loop (from previous step)</span></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>rsq_results_for <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(lm_results_for))</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="co"># Extract R^2 for each model</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lm_results_for)) {</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  rsq_results_for[i] <span class="ot">&lt;-</span> <span class="fu">rsq</span>(lm_results_for[[i]])</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>}</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="co"># Print R^2 values</span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="fu">print</span>(rsq_results_for)</span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a><span class="co">#&gt;  [1] 0.7922909 0.7394926 0.6353980 0.8238884 0.7141976 0.7647638 0.6167564</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a><span class="co">#&gt;  [8] 0.7156652 0.7228334 0.7296627</span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a><span class="co"># Define the function to extract R^2</span></span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a><span class="co"># Assuming lm_results_lapply is the list of models fitted with lapply() (from previous step)</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a>rsq_results_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lm_results_lapply, rsq)</span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a><span class="co"># Print R^2 values</span></span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a><span class="fu">print</span>(rsq_results_lapply)</span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a><span class="co">#&gt; [1] 0.7183433</span></span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb35-30"><a href="#cb35-30" tabindex="-1"></a><span class="co">#&gt; [1] 0.8596865</span></span>
<span id="cb35-31"><a href="#cb35-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-32"><a href="#cb35-32" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb35-33"><a href="#cb35-33" tabindex="-1"></a><span class="co">#&gt; [1] 0.7809306</span></span>
<span id="cb35-34"><a href="#cb35-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-35"><a href="#cb35-35" tabindex="-1"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb35-36"><a href="#cb35-36" tabindex="-1"></a><span class="co">#&gt; [1] 0.8838038</span></span></code></pre></div>
</div>
<div id="question-3-page-213-214-advanced-r" class="section level2">
<h2>Question 3 Page 213-214 Advanced R</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use and an anonymous function to extract the p-value
from every trial.</p>
<p><span class="math display">\[
\texttt{trials} \leftarrow \texttt{replicate}(
100,
\texttt{t.test(rpois(10, 10), rpois(7, 10))},
\texttt{simplify = FALSE}
)
\]</span></p>
<p>Extra challenge: get rid of the anonymous function by using
directly.</p>
</div>
<div id="answers-3-page-213-214-advanced-r" class="section level2">
<h2>Answers 3 Page 213-214 Advanced R</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="co"># Simulate 100 trials and perform t-tests</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>)</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="co"># Use sapply() with an anonymous function to extract p-values</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="sc">$</span>p.value)</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="co"># Print the p-values</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a><span class="fu">print</span>(p_values)</span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="co">#&gt;   [1] 0.04591340 0.72286853 0.10768216 0.23358731 0.61109975 0.21861728</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a><span class="co">#&gt;   [7] 0.04220791 0.79754173 0.54027186 0.40905638 0.29768116 0.17099283</span></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a><span class="co">#&gt;  [13] 0.98498278 0.53114773 0.98870615 0.35966758 0.54338688 0.79595899</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a><span class="co">#&gt;  [19] 0.47973796 0.17509911 0.85123156 0.69213088 0.50127986 0.46506804</span></span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a><span class="co">#&gt;  [25] 0.47702090 0.03588512 0.55668486 0.05449223 0.03281478 0.23264769</span></span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a><span class="co">#&gt;  [31] 0.35586647 0.52077998 0.56234155 0.97829784 0.35618175 0.33785426</span></span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a><span class="co">#&gt;  [37] 0.76302401 0.06825937 0.28819849 0.80172043 0.70030795 0.38708899</span></span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a><span class="co">#&gt;  [43] 0.03969765 0.91135647 0.72619871 0.22534177 0.34237422 0.38158295</span></span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a><span class="co">#&gt;  [49] 0.06695925 0.72307439 0.10253147 0.95592858 0.89664656 0.72159982</span></span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a><span class="co">#&gt;  [55] 0.21872199 0.96002318 0.71448210 0.18060273 0.47159117 0.08039981</span></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a><span class="co">#&gt;  [61] 0.33632643 0.91174589 0.24981096 0.27366916 0.88724261 0.81258100</span></span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a><span class="co">#&gt;  [67] 0.83198016 0.24863525 0.28091408 0.42010108 0.70576540 0.82610797</span></span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a><span class="co">#&gt;  [73] 0.92346515 0.55124542 0.51483179 0.45936064 0.55383986 0.85441921</span></span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a><span class="co">#&gt;  [79] 0.64114175 0.53170612 0.41517080 0.70996997 0.59016885 0.54673004</span></span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a><span class="co">#&gt;  [85] 0.35577264 0.80768979 0.37155575 0.82064315 0.88262237 0.88287608</span></span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a><span class="co">#&gt;  [91] 0.73312421 0.42975950 0.87036302 0.24551361 0.32989690 0.39195851</span></span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a><span class="co">#&gt;  [97] 0.34205477 0.09825618 0.98034816 0.10977667</span></span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a><span class="co"># Extract p-values using sapply() and [[ directly</span></span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>p_values_no_anon <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a></span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a><span class="co"># Print the p-values</span></span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a><span class="fu">print</span>(p_values_no_anon)</span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a><span class="co">#&gt;   [1] 0.04591340 0.72286853 0.10768216 0.23358731 0.61109975 0.21861728</span></span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a><span class="co">#&gt;   [7] 0.04220791 0.79754173 0.54027186 0.40905638 0.29768116 0.17099283</span></span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a><span class="co">#&gt;  [13] 0.98498278 0.53114773 0.98870615 0.35966758 0.54338688 0.79595899</span></span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a><span class="co">#&gt;  [19] 0.47973796 0.17509911 0.85123156 0.69213088 0.50127986 0.46506804</span></span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a><span class="co">#&gt;  [25] 0.47702090 0.03588512 0.55668486 0.05449223 0.03281478 0.23264769</span></span>
<span id="cb36-42"><a href="#cb36-42" tabindex="-1"></a><span class="co">#&gt;  [31] 0.35586647 0.52077998 0.56234155 0.97829784 0.35618175 0.33785426</span></span>
<span id="cb36-43"><a href="#cb36-43" tabindex="-1"></a><span class="co">#&gt;  [37] 0.76302401 0.06825937 0.28819849 0.80172043 0.70030795 0.38708899</span></span>
<span id="cb36-44"><a href="#cb36-44" tabindex="-1"></a><span class="co">#&gt;  [43] 0.03969765 0.91135647 0.72619871 0.22534177 0.34237422 0.38158295</span></span>
<span id="cb36-45"><a href="#cb36-45" tabindex="-1"></a><span class="co">#&gt;  [49] 0.06695925 0.72307439 0.10253147 0.95592858 0.89664656 0.72159982</span></span>
<span id="cb36-46"><a href="#cb36-46" tabindex="-1"></a><span class="co">#&gt;  [55] 0.21872199 0.96002318 0.71448210 0.18060273 0.47159117 0.08039981</span></span>
<span id="cb36-47"><a href="#cb36-47" tabindex="-1"></a><span class="co">#&gt;  [61] 0.33632643 0.91174589 0.24981096 0.27366916 0.88724261 0.81258100</span></span>
<span id="cb36-48"><a href="#cb36-48" tabindex="-1"></a><span class="co">#&gt;  [67] 0.83198016 0.24863525 0.28091408 0.42010108 0.70576540 0.82610797</span></span>
<span id="cb36-49"><a href="#cb36-49" tabindex="-1"></a><span class="co">#&gt;  [73] 0.92346515 0.55124542 0.51483179 0.45936064 0.55383986 0.85441921</span></span>
<span id="cb36-50"><a href="#cb36-50" tabindex="-1"></a><span class="co">#&gt;  [79] 0.64114175 0.53170612 0.41517080 0.70996997 0.59016885 0.54673004</span></span>
<span id="cb36-51"><a href="#cb36-51" tabindex="-1"></a><span class="co">#&gt;  [85] 0.35577264 0.80768979 0.37155575 0.82064315 0.88262237 0.88287608</span></span>
<span id="cb36-52"><a href="#cb36-52" tabindex="-1"></a><span class="co">#&gt;  [91] 0.73312421 0.42975950 0.87036302 0.24551361 0.32989690 0.39195851</span></span>
<span id="cb36-53"><a href="#cb36-53" tabindex="-1"></a><span class="co">#&gt;  [97] 0.34205477 0.09825618 0.98034816 0.10977667</span></span></code></pre></div>
</div>
<div id="question-6-page-213-214-advanced-r" class="section level2">
<h2>Question 6 page 213-214 Advanced R</h2>
<p>Implement a combination of and to create an variant that iterates in
parallel over all of its inputs and stores its outputs in a vector (or a
matrix). What arguments should the function take?</p>
</div>
<div id="answer-6-page-213-214-advanced-r" class="section level2">
<h2>Answer 6 page 213-214 Advanced R</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="co"># Custom function that uses Map() and vapply()</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>parallel_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(..., FUN, FUN.VALUE) {</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="co"># Use Map to iterate in parallel over all inputs</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>  result_list <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, ...)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>  </span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>  <span class="co"># Use vapply to ensure the output is stored in a vector (or matrix)</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">vapply</span>(result_list, <span class="at">FUN.VALUE =</span> FUN.VALUE, <span class="at">FUN =</span> identity)</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>  </span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>}</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a><span class="co"># Define some example functions and data</span></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a><span class="co"># Apply a function (e.g., summing corresponding elements of x, y, z)</span></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a><span class="fu">parallel_lapply</span>(x, y, z, <span class="at">FUN =</span> <span class="cf">function</span>(a, b, c) a <span class="sc">+</span> b <span class="sc">+</span> c, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a><span class="co">#&gt; [1] 18 21 24 27 30</span></span></code></pre></div>
</div>
<div id="question-4-page-365-advanced-r" class="section level2">
<h2>Question 4 page 365 Advanced R</h2>
<p>Make a faster version of that only computes the chi-square test
statistic when the input is two numeric vectors with no missing values.
You can try simplifying or by coding from the mathematical definition
(url{<a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test" class="uri">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a>}).</p>
</div>
<div id="answer-4-page-365-advanced-r" class="section level2">
<h2>Answer 4 page 365 Advanced R</h2>
<p>Given two categorical variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, the Pearson chi-square statistic is
calculated as:</p>
<p><span class="math display">\[
\chi^2 = \sum_{i,j} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}
\]</span></p>
<p>Where: - <span class="math inline">\(O_{ij}\)</span> is the observed
count in cell <span class="math inline">\(i,j\)</span>. - <span class="math inline">\(E_{ij}\)</span> is the expected count in cell
<span class="math inline">\(i,j\)</span>, calculated as:</p>
<p><span class="math display">\[
E_{ij} = \frac{(\text{row sum}_i \times \text{column
sum}_j)}{\text{total sum}}
\]</span></p>
<p>We can directly implement the chi-square statistic from these
formulas.</p>
:
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  <span class="co"># Remove missing values</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  valid_data <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(x, y)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[valid_data]</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y[valid_data]</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>  </span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>  <span class="co"># Calculate observed frequencies (contingency table)</span></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>  obs <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>  </span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>  <span class="co"># Calculate row and column totals</span></span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>  row_totals <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(obs)</span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>  col_totals <span class="ot">&lt;-</span> <span class="fu">colSums</span>(obs)</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>  </span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>  <span class="co"># Calculate expected frequencies under the assumption of independence</span></span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(obs)</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_totals, col_totals, <span class="at">FUN =</span> <span class="st">&quot;*&quot;</span>) <span class="sc">/</span> total</span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a>  </span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>  <span class="co"># Calculate the chi-square statistic</span></span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>  chi_square_statistic <span class="ot">&lt;-</span> <span class="fu">sum</span>((obs <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a>  </span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a>  <span class="fu">return</span>(chi_square_statistic)</span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a>}</span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a><span class="co"># Example usage with two numeric vectors</span></span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb38-28"><a href="#cb38-28" tabindex="-1"></a></span>
<span id="cb38-29"><a href="#cb38-29" tabindex="-1"></a><span class="co"># Apply the fast chi-square test</span></span>
<span id="cb38-30"><a href="#cb38-30" tabindex="-1"></a>chi_square_statistic <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb38-31"><a href="#cb38-31" tabindex="-1"></a><span class="fu">print</span>(chi_square_statistic)</span>
<span id="cb38-32"><a href="#cb38-32" tabindex="-1"></a><span class="co">#&gt; [1] 7.291667</span></span></code></pre></div>
</div>
<div id="question-5-page-365-advanced-r" class="section level2">
<h2>Question 5 page 365 Advanced R</h2>
<p>Can you make a faster version of for the case of an input of two
integer vectors with no missing values? Can you use it to speed up your
chi-square test?</p>
</div>
<div id="answer-5-page-365-advanced-r" class="section level2">
<h2>Answer 5 page 365 Advanced R</h2>
<p></p>
<p>Now, to speed up the chi-square test, we can compute the chi-square
statistic directly from the contingency table produced by .</p>
<p>The formula for the chi-square statistic is:</p>
<p><span class="math display">\[
\chi^2 = \sum_{i,j} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}
\]</span></p>
<p>Where: - <span class="math inline">\(O_{ij}\)</span> is the observed
frequency in cell <span class="math inline">\(i,j\)</span>. - <span class="math inline">\(E_{ij}\)</span> is the expected frequency in cell
<span class="math inline">\(i,j\)</span>, which is calculated as:</p>
<p><span class="math display">\[
E_{ij} = \frac{\text{row sum} \times \text{column sum}}{\text{total
sum}}
\]</span></p>
<p>Here is how you can implement this faster chi-square test:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>  <span class="co"># Ensure both inputs are integer vectors with no missing values</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.integer</span>(y)) {</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Both x and y must be integer vectors.&quot;</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>  }</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(x)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(y))) {</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Both x and y must not contain missing values.&quot;</span>)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  }</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>  <span class="co"># Compute unique pairs (x, y) directly by combining the vectors</span></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>  pairs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, y)</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>  </span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>  <span class="co"># Use a hash-based approach to count the occurrences of each pair</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>  unique_pairs <span class="ot">&lt;-</span> <span class="fu">unique</span>(pairs)  <span class="co"># Find unique pairs</span></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  n_pairs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(unique_pairs)  <span class="co"># Number of unique pairs</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">integer</span>(n_pairs)  <span class="co"># Vector to store counts</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>  </span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>  <span class="co"># Count each pair&#39;s frequency</span></span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(n_pairs)) {</span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>    counts[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>((pairs[,<span class="dv">1</span>] <span class="sc">==</span> unique_pairs[i,<span class="dv">1</span>]) <span class="sc">&amp;</span> (pairs[,<span class="dv">2</span>] <span class="sc">==</span> unique_pairs[i,<span class="dv">2</span>]))</span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>  }</span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>  </span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a>  <span class="co"># Return the frequency counts as a named vector</span></span>
<span id="cb39-25"><a href="#cb39-25" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">setNames</span>(counts, <span class="fu">apply</span>(unique_pairs, <span class="dv">1</span>, <span class="cf">function</span>(v) <span class="fu">paste</span>(v, <span class="at">collapse =</span> <span class="st">&quot;_&quot;</span>))))</span>
<span id="cb39-26"><a href="#cb39-26" tabindex="-1"></a>}</span>
<span id="cb39-27"><a href="#cb39-27" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" tabindex="-1"></a><span class="co"># Fast chi-square test using optimized table function</span></span>
<span id="cb39-29"><a href="#cb39-29" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb39-30"><a href="#cb39-30" tabindex="-1"></a>  <span class="co"># Check if inputs are integer vectors without missing values</span></span>
<span id="cb39-31"><a href="#cb39-31" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.integer</span>(y)) {</span>
<span id="cb39-32"><a href="#cb39-32" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Both inputs must be integer vectors.&quot;</span>)</span>
<span id="cb39-33"><a href="#cb39-33" tabindex="-1"></a>  }</span>
<span id="cb39-34"><a href="#cb39-34" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(x)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(y))) {</span>
<span id="cb39-35"><a href="#cb39-35" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Both input vectors must not contain missing values.&quot;</span>)</span>
<span id="cb39-36"><a href="#cb39-36" tabindex="-1"></a>  }</span>
<span id="cb39-37"><a href="#cb39-37" tabindex="-1"></a>  </span>
<span id="cb39-38"><a href="#cb39-38" tabindex="-1"></a>  <span class="co"># Generate the contingency table using the fast_table() function</span></span>
<span id="cb39-39"><a href="#cb39-39" tabindex="-1"></a>  obs <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb39-40"><a href="#cb39-40" tabindex="-1"></a>  </span>
<span id="cb39-41"><a href="#cb39-41" tabindex="-1"></a>  <span class="co"># Create the expected table using the standard method</span></span>
<span id="cb39-42"><a href="#cb39-42" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(obs)  <span class="co"># Total number of observations</span></span>
<span id="cb39-43"><a href="#cb39-43" tabindex="-1"></a>  row_totals <span class="ot">&lt;-</span> <span class="fu">sum</span>(obs)  <span class="co"># Row sums (same for one-dimensional table)</span></span>
<span id="cb39-44"><a href="#cb39-44" tabindex="-1"></a>  col_totals <span class="ot">&lt;-</span> <span class="fu">sum</span>(obs)  <span class="co"># Column sums (same for one-dimensional table)</span></span>
<span id="cb39-45"><a href="#cb39-45" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> row_totals <span class="sc">*</span> col_totals <span class="sc">/</span> n  <span class="co"># Expected frequency calculation</span></span>
<span id="cb39-46"><a href="#cb39-46" tabindex="-1"></a>  </span>
<span id="cb39-47"><a href="#cb39-47" tabindex="-1"></a>  <span class="co"># Calculate chi-square statistic</span></span>
<span id="cb39-48"><a href="#cb39-48" tabindex="-1"></a>  chi_sq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((obs <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb39-49"><a href="#cb39-49" tabindex="-1"></a>  </span>
<span id="cb39-50"><a href="#cb39-50" tabindex="-1"></a>  <span class="co"># Return the chi-square statistic</span></span>
<span id="cb39-51"><a href="#cb39-51" tabindex="-1"></a>  <span class="fu">return</span>(chi_sq_stat)</span>
<span id="cb39-52"><a href="#cb39-52" tabindex="-1"></a>}</span>
<span id="cb39-53"><a href="#cb39-53" tabindex="-1"></a></span>
<span id="cb39-54"><a href="#cb39-54" tabindex="-1"></a><span class="co"># Example Usage:</span></span>
<span id="cb39-55"><a href="#cb39-55" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>))  <span class="co"># Make sure the inputs are integer vectors</span></span>
<span id="cb39-56"><a href="#cb39-56" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb39-57"><a href="#cb39-57" tabindex="-1"></a></span>
<span id="cb39-58"><a href="#cb39-58" tabindex="-1"></a><span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb39-59"><a href="#cb39-59" tabindex="-1"></a><span class="co">#&gt; [1] 25</span></span></code></pre></div>
</div>
<div id="references-3" class="section level2">
<h2>References</h2>
<ul>
<li>Linear programming: Simplex method example. (2024). phpsimplex.com.
<a href="https://www.phpsimplex.com/en/simplex_method_example.htm" class="uri">https://www.phpsimplex.com/en/simplex_method_example.htm</a></li>
<li>Omar Antolín Camarena. (2024). Introduction to the simplex method.
unam.mx. <a href="https://www.matem.unam.mx/~omar/math340/simplex-intro.html" class="uri">https://www.matem.unam.mx/~omar/math340/simplex-intro.html</a></li>
<li>RPubs - Linear Regression on mtcars data. (2024). rpubs.com. <a href="https://rpubs.com/aprasar/lm_mtcars" class="uri">https://rpubs.com/aprasar/lm_mtcars</a>.</li>
<li>Functionals · Advanced R. (2019). had.co.nz. <a href="http://adv-r.had.co.nz/Functionals.html" class="uri">http://adv-r.had.co.nz/Functionals.html</a></li>
<li>Malte Grosser &amp; Henning Bumann. (2024). 8 Functionals | Advanced
R Solutions. netlify.app. <a href="https://advanced-r-solutions-ed1.netlify.app/functionals.html" class="uri">https://advanced-r-solutions-ed1.netlify.app/functionals.html</a></li>
<li>Zach Bobbitt. (2022). How to Extract R-Squared from lm() Function in
R. Statology. <a href="https://www.statology.org/extract-r-squared-from-lm-in-r/" class="uri">https://www.statology.org/extract-r-squared-from-lm-in-r/</a></li>
<li>herbps10. (2024). Manually Calculating P value from t-value in
t-test. Cross Validated. <a href="https://stats.stackexchange.com/questions/45153/manually-calculating-p-value-from-t-value-in-t-test" class="uri">https://stats.stackexchange.com/questions/45153/manually-calculating-p-value-from-t-value-in-t-test</a></li>
<li>Hadley Wickham. (2024). 9 Functionals | Advanced R. hadley.nz. <a href="https://adv-r.hadley.nz/functionals.html" class="uri">https://adv-r.hadley.nz/functionals.html</a></li>
<li>Malte Grosser, Henning Bumann &amp; Hadley Wickham. (2024). 19
Improving performance | Advanced R Solutions. rbind.io. <a href="https://advanced-r-solutions.rbind.io/improving-performance" class="uri">https://advanced-r-solutions.rbind.io/improving-performance</a></li>
</ul>
</div>
<div id="homework-9-page-278-statistical-computing-with-r." class="section level2">
<h2>Homework 9 (page 278, Statistical Computing with R).</h2>
</div>
<div id="question-9.8-1" class="section level2">
<h2>Question 9.8</h2>
<p>Write an function for this example, which appears in .</p>
<p>Consider the bivariate density: <span class="math display">\[
f(x, y) \propto \binom{n}{x} y^{x+a-1} (1-y)^{n-x+b-1}, \quad x = 0, 1,
\ldots, n, \; 0 \leq y \leq 1.
\]</span></p>
<p>It can be shown (see, e.g., ) that for fixed <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(n\)</span>, the conditional distributions are:</p>
<ul>
<li><span class="math inline">\(X \mid Y \sim \text{Binomial}(n,
y)\)</span>,</li>
<li><span class="math inline">\(Y \mid X \sim \text{Beta}(x+a,
n-x+b)\)</span>. \end{itemize}</li>
</ul>
<p>Use the Gibbs sampler to generate a chain with the target joint
density <span class="math inline">\(f(x, y)\)</span>.</p>
</div>
<div id="answer-9.8-solution" class="section level2">
<h2>Answer 9.8 Solution</h2>
<p>To implement the Gibbs sampler:</p>
<ul>
<li><p>Start with initial values <span class="math inline">\(x_0\)</span> and <span class="math inline">\(y_0\)</span>.</p></li>
<li><p>Iteratively update:</p></li>
<li><p>Sample <span class="math inline">\(X^{(t+1)} \sim
\text{Binomial}(n, Y^{(t)})\)</span>,</p></li>
<li><p>Sample <span class="math inline">\(Y^{(t+1)} \sim
\text{Beta}(X^{(t+1)} + a, n - X^{(t+1)} + b)\)</span>.</p></li>
<li><p>Repeat for a large number of iterations to achieve convergence to
the target density.</p></li>
</ul>
<p>The implementation in is as follows:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="co"># Define the Rcpp function using cppFunction</span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>Rcpp<span class="sc">::</span><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a><span class="st">List gibbs_sampler(int n, double a, double b, int n_iter) {</span></span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a><span class="st">  // Initialize variables</span></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a><span class="st">  IntegerVector x_chain(n_iter);</span></span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a><span class="st">  NumericVector y_chain(n_iter);</span></span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a><span class="st">  // Initial values</span></span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a><span class="st">  int x = n / 2;  // Arbitrary starting value for x</span></span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a><span class="st">  double y = 0.5; // Arbitrary starting value for y</span></span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a><span class="st">  for (int i = 0; i &lt; n_iter; i++) {</span></span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a><span class="st">    // Sample x | y from Binomial(n, y)</span></span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a><span class="st">    x = R::rbinom(n, y);</span></span>
<span id="cb40-23"><a href="#cb40-23" tabindex="-1"></a><span class="st">    // Sample y | x from Beta(x + a, n - x + b)</span></span>
<span id="cb40-24"><a href="#cb40-24" tabindex="-1"></a><span class="st">    y = R::rbeta(x + a, n - x + b);</span></span>
<span id="cb40-25"><a href="#cb40-25" tabindex="-1"></a><span class="st">    // Store values in the chains</span></span>
<span id="cb40-26"><a href="#cb40-26" tabindex="-1"></a><span class="st">    x_chain[i] = x;</span></span>
<span id="cb40-27"><a href="#cb40-27" tabindex="-1"></a><span class="st">    y_chain[i] = y;</span></span>
<span id="cb40-28"><a href="#cb40-28" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb40-29"><a href="#cb40-29" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" tabindex="-1"></a><span class="st">  // Return the generated chains as a list</span></span>
<span id="cb40-31"><a href="#cb40-31" tabindex="-1"></a><span class="st">  return List::create(</span></span>
<span id="cb40-32"><a href="#cb40-32" tabindex="-1"></a><span class="st">    Named(&quot;x_chain&quot;) = x_chain,</span></span>
<span id="cb40-33"><a href="#cb40-33" tabindex="-1"></a><span class="st">    Named(&quot;y_chain&quot;) = y_chain</span></span>
<span id="cb40-34"><a href="#cb40-34" tabindex="-1"></a><span class="st">  );</span></span>
<span id="cb40-35"><a href="#cb40-35" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb40-36"><a href="#cb40-36" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb40-37"><a href="#cb40-37" tabindex="-1"></a><span class="co">#&gt; Warning: No function found for Rcpp::export attribute at file143455c2a14.cpp:5</span></span>
<span id="cb40-38"><a href="#cb40-38" tabindex="-1"></a></span>
<span id="cb40-39"><a href="#cb40-39" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb40-40"><a href="#cb40-40" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>         <span class="co"># Number of trials in Binomial distribution</span></span>
<span id="cb40-41"><a href="#cb40-41" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>          <span class="co"># Parameter &#39;a&#39; for Beta distribution</span></span>
<span id="cb40-42"><a href="#cb40-42" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span>          <span class="co"># Parameter &#39;b&#39; for Beta distribution</span></span>
<span id="cb40-43"><a href="#cb40-43" tabindex="-1"></a>n_iter <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># Number of iterations for the Gibbs sampler</span></span>
<span id="cb40-44"><a href="#cb40-44" tabindex="-1"></a></span>
<span id="cb40-45"><a href="#cb40-45" tabindex="-1"></a><span class="co"># Run Gibbs sampler</span></span>
<span id="cb40-46"><a href="#cb40-46" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb40-47"><a href="#cb40-47" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, n_iter)</span>
<span id="cb40-48"><a href="#cb40-48" tabindex="-1"></a></span>
<span id="cb40-49"><a href="#cb40-49" tabindex="-1"></a><span class="co"># Extract chains</span></span>
<span id="cb40-50"><a href="#cb40-50" tabindex="-1"></a>x_chain <span class="ot">&lt;-</span> result<span class="sc">$</span>x_chain</span>
<span id="cb40-51"><a href="#cb40-51" tabindex="-1"></a>y_chain <span class="ot">&lt;-</span> result<span class="sc">$</span>y_chain</span>
<span id="cb40-52"><a href="#cb40-52" tabindex="-1"></a></span>
<span id="cb40-53"><a href="#cb40-53" tabindex="-1"></a><span class="co"># Burn-in period (optional)</span></span>
<span id="cb40-54"><a href="#cb40-54" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb40-55"><a href="#cb40-55" tabindex="-1"></a>x_chain_burned <span class="ot">&lt;-</span> x_chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n_iter]</span>
<span id="cb40-56"><a href="#cb40-56" tabindex="-1"></a>y_chain_burned <span class="ot">&lt;-</span> y_chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n_iter]</span>
<span id="cb40-57"><a href="#cb40-57" tabindex="-1"></a></span>
<span id="cb40-58"><a href="#cb40-58" tabindex="-1"></a><span class="co"># Plot results</span></span>
<span id="cb40-59"><a href="#cb40-59" tabindex="-1"></a><span class="co"># Trace plot for y</span></span>
<span id="cb40-60"><a href="#cb40-60" tabindex="-1"></a><span class="fu">plot</span>(y_chain_burned, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb40-61"><a href="#cb40-61" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Trace Plot of y&quot;</span>,</span>
<span id="cb40-62"><a href="#cb40-62" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb40-63"><a href="#cb40-63" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="co"># Histogram for y</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="fu">hist</span>(y_chain_burned, <span class="at">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of y&quot;</span>,</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>     <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="co"># Overlay the theoretical Beta density</span></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, <span class="fu">mean</span>(x_chain_burned) <span class="sc">+</span> a, (n <span class="sc">-</span> <span class="fu">mean</span>(x_chain_burned)) <span class="sc">+</span> b),</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>      <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Summary of y_chain:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="co">#&gt; Summary of y_chain:</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(y_chain_burned))</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a><span class="co">#&gt; 0.003897 0.325349 0.500766 0.499826 0.673048 0.989291</span></span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a><span class="co"># Autocorrelation plot for y</span></span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a><span class="fu">acf</span>(y_chain_burned, <span class="at">main =</span> <span class="st">&quot;Autocorrelation of y Chain&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAwFBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZjpmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQkGaQkLaQtpCQttuQ29uQ2/+2ZgC2Zjq2ZpC2kGa2tma225C227a229u22/+2/9u2///bkDrbkJDbtmbbtpDb25Db27bb29vb2//b////tmb/25D/27b//7b//9v///85YBgkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJhklEQVR4nO2dC3ubNhhGlazJnK1tai+7NNnWbV3YtVnZuktIbP7/v5quIMzllWwcMLzneVockD+JgySEkbHISSdi6AKMHQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCRArKhDh9X1+9+blhZRSbG3F+X4tZX9sd5KcLIS7bNv71XAjx4k69TsXJbUgZ8mhBiczjurb28arJWhS1wumYkYLk4RNi2bxtfSUMavvBBK1XModFbXXSWK2iqBVul5jN++3iO647E24TJygTJ1/YgpsdkMaWulrpvz58LsSzL81+qgr97LV+Wa6WBfvhSpzeuaVsFEKcXN4Xgj6o4/ziNrcx/7DaKhF+lO858/av2Kjfo/dcRluY8rr6nsr3vJX1UnqSEStRijxNGbZyiBOUiPO/L0wlbhCUmiOkdynx63OxOrWv3FLXSFkY15gyk1TuZEVQLYLwakC5sRQkV+rDWFRDGd682nx9+V8ZRa0r83SCKjlECVI6XFvwBNnXDxc2/lLn+ur+caXW+6vl/+d3+b/FMlG16EEp12Hlfx/fm79NTJPZVoSzO/taU93ovMm117p0i6Lkfs9g8tdv8vIsBPk5RAnKVAFsKeqCEu+omdfpy3fV1amt8nZp3q0Pd9EH/fPLc93NeYLqEeT+uP2tbnSCTBsrW9jDRaXzNlFs9kWehSA/hxhBxfFcNglyu6hK6XW5/upiD+xShnLV2STbvDF/VwQ1RCgrRGN4K131CPctgsooZZ5FH+TnECOo2J/ze69ZOUEupDpsrpPM88rqbUGZqApSp5qz7/9ZVQU1RKi3nUp4U9brooY0NLEiipfn3oJc96XrYE3QbjXIDap0MhNtveqhBqlDVP3TddIv7yqCvDz3FeQNJRYuj0x09UHZi7fNnYRdesdVFy5zzX/Z0QdVBbX0QTqL597Qqnaad1G8PPcV5PotczR0N6/yK84eW2exS91irhtPM26ZiJPXuTzZ2Wqik6qY7gA0ncW2BDWfxWx/UPY7TQNFV4NcnvsKcqcg86LokIyOlnHQIt8axVQF2XGQU1HsxcLGbBoHbQlqCu+M+GPx4lLjMq/1Qf100kUztgftQeb48nfdD6rxsBw7mDHtVya5Hkmb1+XqbUH54xvpWfUK5Vns7K0+A+mY7/yRtBeh0ufWw2uyrYsie7H6bjtKmefenfRxkTVdVsczWUGPV/tfQSsmKkh3bi0ffMQxXUEnr3qJNFFB/UFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAjQsyBxNAwlqN9wh4OCABQEeGJBW037CDQNW4MoCISjIBCOgkA4CgLhKAiEoyAQjoJAOAoC4SgIhJuvoESIhf6acNu3QWcuKNXf8l+oL/S1fN1x3oI2N+o78vqb12nLk7PmLWi9ki0r098lzlq+UTxvQaxBiKIP0qraw81WEM9iPeVLQSAcBeUpz2Jx2fFD+6hwFATCzVeQe55V65N5Zi4odY/kydqezTNvQd74mZcaTeiLVQMvVpuIqkEjl3SoPshWoYA+aJaC3IMh2x80P3dBgeEoCISjIBCOgkA4CgLhKAiEm54gb4zcR74TFdR6qyI6XwoC4SgIhKOgWpT6Z9IU1BGOgkC4KQoqG8leT4KfqqCe86UgEG6KgjY36nc2Hi727IYmK2i9Mh8SuuV++RaCxmspVlDivLROz4wJNz1BAfcrYsJNT1DAHS+Ph4vWa//pCiprULuggNHSVAXlSfFLU0lHE7O3w2ZYg8p97tj53J3k5ijIVY4U/aRScnI7T0F26k/9h663kQrnKSgY9eOGcxa0+Qad5mVdm6+gtN+POyYmSP1yZ+AP1eN50pMTZEaBO16ItX0mPR1BiT6D7Xmlmk+3BtlrMQpqTajO3QE1KGKetKi8GB07dNIp7oNi5klPT5CpH11nsfhZrhMTlOum1vVxR8Q86YkKkvzZKog1CBE9T3pugqLnSc9OUGA4CgLhKAiEoyAQriZofJIoCEBBAAoCUBCAggAUBHhiQV2fSVNQPRwFgXCNgsYliYIAFASgIAAFAUYqaDySKAhAQYADCdr11vNcBO1863l8kg4iaPcbhzMRtPut55kI6q8GDS/pUH3QjreexyfpQGexXW89z0ZQYLhgQcNJGkrQRwoZ1CxzEbjMn2jp5XdgQRHzpEP/NYXa3r5rravHeuIaFPrrryPiaQX1Fa6P2hHWxw3bBx3DMnSP4gQFXqweAYcaKIZdrB4Bw15qHAHDXqweAYPVoKPhEIICLlYjg4YmHCpdXNI84GI1MujkBPUdlIJ6SkhBI00Xl/QAQSmop4QUNNJ0cUkPEHSugqYEBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvQvKAt71uDDp+9xan2rexkQNXWbce7mcceBpTyAoEzmm+G81yt967E79eZGbkrVA2ZBVDVdSW/GuWf6lkxgKfP+BZmbiwl6aG5mJkCA1OapunLvQTr9cDr1uw449/VKCQospaJvQcU+dabKxFLfvA5KLY90SDolCKdLz7+VgsJKqeld0Ceq3gY8GN8ICkmdnL4PSZeqJ12jdDKB6oOCS9m/INOwA5q3Ll1IanWbG6fLdGeO0qmmpQQFl/IIBGWuj0ZRNzfn9yidmnMxsKC+m5iZJhEUVfVV3en05oGbWHD3F9ZJp/7vMICoMhFIl9qpLyidz0CneSsIpXbzbYKGAxkcDmiSYU/zwUOwLGCgWP5YFYha7HRA7smwA0Vv1N+N7QA6U9smoRKAqOp52NdhuZtLjcBS8mIVQkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgKMVFACng7ydFAQgIIAoxdUTGyRL06+C5uy0idjF6RmgakJvmoycJ4Fzunpk5ELWn92a2bYmVl2CQVZ/D4oU22snLH3xIxdUCrE6W+y9qQUVMEJ0i1L/ccaVMUJMvPxheuDUgqy+DVovVKzyXkWq5CYCcBLM11Xn7zkqtNfQ+bG98tIBbUQ9O2KfjkWQboP0t8sfGKORZAaDQlxjdP1zdEIGgoKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBPgf9FWDolj5uqkAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="question-9.8-2" class="section level2">
<h2>Question 9.8</h2>
<p>Compare the corresponding generated random numbers with those
produced by the R function you wrote, using the function . This example
appears in .</p>
<p>Consider the bivariate density <span class="math display">\[
f(x, y) \propto \binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x = 0, 1,
\ldots, n, \quad 0 \leq y \leq 1.
\]</span></p>
<p>It can be shown (see e.g. ) that for fixed <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(n\)</span>, the conditional distributions are
<span class="math inline">\(\text{Binomial}(n, y)\)</span> and <span class="math inline">\(\text{Beta}(x + a, n - x + b)\)</span>. Use the
Gibbs sampler to generate a chain with the target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a> <span class="co"># Load necessary library</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a><span class="co"># Define the Gibbs sampler function using Rcpp</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>Rcpp<span class="sc">::</span><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a><span class="st">List gibbs_sampler(int n, double a, double b, int n_iter) {</span></span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a><span class="st">  IntegerVector x_chain(n_iter);</span></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a><span class="st">  NumericVector y_chain(n_iter);</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a><span class="st">  // Initial values</span></span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a><span class="st">  int x = n / 2; // Initial value for x</span></span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a><span class="st">  double y = 0.5; // Initial value for y</span></span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a><span class="st">  for (int i = 0; i &lt; n_iter; i++) {</span></span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a><span class="st">    // Sample x | y from Binomial(n, y)</span></span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a><span class="st">    x = R::rbinom(n, y);</span></span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a><span class="st">    // Sample y | x from Beta(x + a, n - x + b)</span></span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a><span class="st">    y = R::rbeta(x + a, n - x + b);</span></span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a><span class="st">    // Store values in the chains</span></span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a><span class="st">    x_chain[i] = x;</span></span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a><span class="st">    y_chain[i] = y;</span></span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a><span class="st">  // Return the generated chains as a list</span></span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a><span class="st">  return List::create(</span></span>
<span id="cb43-30"><a href="#cb43-30" tabindex="-1"></a><span class="st">    Named(&quot;x_chain&quot;) = x_chain,</span></span>
<span id="cb43-31"><a href="#cb43-31" tabindex="-1"></a><span class="st">    Named(&quot;y_chain&quot;) = y_chain</span></span>
<span id="cb43-32"><a href="#cb43-32" tabindex="-1"></a><span class="st">  );</span></span>
<span id="cb43-33"><a href="#cb43-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb43-34"><a href="#cb43-34" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb43-35"><a href="#cb43-35" tabindex="-1"></a><span class="co">#&gt; Warning: No function found for Rcpp::export attribute at file14341945ce6.cpp:5</span></span>
<span id="cb43-36"><a href="#cb43-36" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb43-38"><a href="#cb43-38" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb43-39"><a href="#cb43-39" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb43-40"><a href="#cb43-40" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb43-41"><a href="#cb43-41" tabindex="-1"></a>n_iter <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb43-42"><a href="#cb43-42" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb43-43"><a href="#cb43-43" tabindex="-1"></a></span>
<span id="cb43-44"><a href="#cb43-44" tabindex="-1"></a><span class="co"># Run Gibbs sampler</span></span>
<span id="cb43-45"><a href="#cb43-45" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb43-46"><a href="#cb43-46" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, n_iter)</span>
<span id="cb43-47"><a href="#cb43-47" tabindex="-1"></a></span>
<span id="cb43-48"><a href="#cb43-48" tabindex="-1"></a><span class="co"># Extract chains and remove burn-in</span></span>
<span id="cb43-49"><a href="#cb43-49" tabindex="-1"></a>x_chain <span class="ot">&lt;-</span> result<span class="sc">$</span>x_chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n_iter]</span>
<span id="cb43-50"><a href="#cb43-50" tabindex="-1"></a>y_chain <span class="ot">&lt;-</span> result<span class="sc">$</span>y_chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n_iter]</span>
<span id="cb43-51"><a href="#cb43-51" tabindex="-1"></a></span>
<span id="cb43-52"><a href="#cb43-52" tabindex="-1"></a><span class="co"># Generate random numbers using R&#39;s built-in functions</span></span>
<span id="cb43-53"><a href="#cb43-53" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb43-54"><a href="#cb43-54" tabindex="-1"></a>x_rbinom <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">length</span>(x_chain), <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">mean</span>(y_chain))</span>
<span id="cb43-55"><a href="#cb43-55" tabindex="-1"></a>y_rbeta <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="fu">length</span>(y_chain), <span class="at">shape1 =</span> <span class="fu">mean</span>(x_chain) <span class="sc">+</span> a, <span class="at">shape2 =</span> (n <span class="sc">-</span> <span class="fu">mean</span>(x_chain)) <span class="sc">+</span> b)</span>
<span id="cb43-56"><a href="#cb43-56" tabindex="-1"></a></span>
<span id="cb43-57"><a href="#cb43-57" tabindex="-1"></a><span class="co"># QQ plot for x</span></span>
<span id="cb43-58"><a href="#cb43-58" tabindex="-1"></a><span class="fu">qqplot</span>(x_rbinom, x_chain, <span class="at">main =</span> <span class="st">&quot;QQ Plot for x&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;rbinom Quantiles&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Gibbs x Quantiles&quot;</span>)</span>
<span id="cb43-59"><a href="#cb43-59" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="co"># QQ plot for y</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="fu">qqplot</span>(y_rbeta, y_chain, <span class="at">main =</span> <span class="st">&quot;QQ Plot for y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;rbeta Quantiles&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Gibbs y Quantiles&quot;</span>)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-9.8-3" class="section level2">
<h2>Question 9.8</h2>
<p>Compare the computation time of the two functions using the function
. This example appears in . Consider the bivariate density <span class="math display">\[
f(x, y) \propto \binom{n}{x} y^{x+a-1} (1-y)^{n-x+b-1}, \quad x = 0, 1,
\ldots, n, \quad 0 \leq y \leq 1.
\]</span> It can be shown (see e.g., ) that for fixed <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(n\)</span>, the conditional distributions are
<span class="math inline">\(\text{Binomial}(n, y)\)</span> and <span class="math inline">\(\text{Beta}(x + a, n - x + b)\)</span>. Use the
Gibbs sampler to generate a chain with the target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
</div>
<div id="answer-9.8-1" class="section level2">
<h2>Answer 9.8</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a> <span class="co"># Load necessary libraries</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a><span class="co"># Define the Gibbs sampler function using Rcpp</span></span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a><span class="st">NumericMatrix gibbsSamplerRcpp(int n, double a, double b, int N, int burn_in) {</span></span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a><span class="st">  NumericMatrix samples(N, 2);</span></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a><span class="st">  int x = n / 2; // Initial value of x</span></span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a><span class="st">  double y = 0.5; // Initial value of y</span></span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a><span class="st">  for (int t = 0; t &lt; N + burn_in; ++t) {</span></span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a><span class="st">    // Sample x | y</span></span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a><span class="st">    x = R::rbinom(n, y);</span></span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a><span class="st">    // Sample y | x</span></span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a><span class="st">    y = R::rbeta(x + a, n - x + b);</span></span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a><span class="st">    // Store samples after burn-in period</span></span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a><span class="st">    if (t &gt;= burn_in) {</span></span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a><span class="st">      samples(t - burn_in, 0) = x;</span></span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a><span class="st">      samples(t - burn_in, 1) = y;</span></span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a><span class="st">  return samples;</span></span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a><span class="co">#&gt; Warning: No function found for Rcpp::export attribute at file14346a037228.cpp:5</span></span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" tabindex="-1"></a><span class="co"># Gibbs sampler function in R</span></span>
<span id="cb45-32"><a href="#cb45-32" tabindex="-1"></a>gibbsSamplerR <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, N, burn_in) {</span>
<span id="cb45-33"><a href="#cb45-33" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb45-34"><a href="#cb45-34" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">floor</span>(n <span class="sc">/</span> <span class="dv">2</span>) <span class="co"># Initial value of x</span></span>
<span id="cb45-35"><a href="#cb45-35" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fl">0.5</span>          <span class="co"># Initial value of y</span></span>
<span id="cb45-36"><a href="#cb45-36" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(N <span class="sc">+</span> burn_in)) {</span>
<span id="cb45-37"><a href="#cb45-37" tabindex="-1"></a>    <span class="co"># Sample x | y</span></span>
<span id="cb45-38"><a href="#cb45-38" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb45-39"><a href="#cb45-39" tabindex="-1"></a>    <span class="co"># Sample y | x</span></span>
<span id="cb45-40"><a href="#cb45-40" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb45-41"><a href="#cb45-41" tabindex="-1"></a>    <span class="co"># Store samples after burn-in</span></span>
<span id="cb45-42"><a href="#cb45-42" tabindex="-1"></a>    <span class="cf">if</span> (t <span class="sc">&gt;</span> burn_in) {</span>
<span id="cb45-43"><a href="#cb45-43" tabindex="-1"></a>      samples[t <span class="sc">-</span> burn_in, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb45-44"><a href="#cb45-44" tabindex="-1"></a>    }</span>
<span id="cb45-45"><a href="#cb45-45" tabindex="-1"></a>  }</span>
<span id="cb45-46"><a href="#cb45-46" tabindex="-1"></a>  <span class="fu">colnames</span>(samples) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb45-47"><a href="#cb45-47" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb45-48"><a href="#cb45-48" tabindex="-1"></a>}</span>
<span id="cb45-49"><a href="#cb45-49" tabindex="-1"></a></span>
<span id="cb45-50"><a href="#cb45-50" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb45-51"><a href="#cb45-51" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>      <span class="co"># Number of trials</span></span>
<span id="cb45-52"><a href="#cb45-52" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>       <span class="co"># Beta parameter a</span></span>
<span id="cb45-53"><a href="#cb45-53" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span>       <span class="co"># Beta parameter b</span></span>
<span id="cb45-54"><a href="#cb45-54" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>   <span class="co"># Number of samples to generate</span></span>
<span id="cb45-55"><a href="#cb45-55" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># Burn-in period</span></span>
<span id="cb45-56"><a href="#cb45-56" tabindex="-1"></a></span>
<span id="cb45-57"><a href="#cb45-57" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb45-58"><a href="#cb45-58" tabindex="-1"></a></span>
<span id="cb45-59"><a href="#cb45-59" tabindex="-1"></a><span class="co"># Benchmarking</span></span>
<span id="cb45-60"><a href="#cb45-60" tabindex="-1"></a>benchmark_results <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb45-61"><a href="#cb45-61" tabindex="-1"></a>  <span class="at">gibbs_Rcpp =</span> <span class="fu">gibbsSamplerRcpp</span>(n, a, b, N, burn_in),</span>
<span id="cb45-62"><a href="#cb45-62" tabindex="-1"></a>  <span class="at">gibbs_R =</span> <span class="fu">gibbsSamplerR</span>(n, a, b, N, burn_in),</span>
<span id="cb45-63"><a href="#cb45-63" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">10</span></span>
<span id="cb45-64"><a href="#cb45-64" tabindex="-1"></a>)</span>
<span id="cb45-65"><a href="#cb45-65" tabindex="-1"></a></span>
<span id="cb45-66"><a href="#cb45-66" tabindex="-1"></a><span class="co"># Print benchmark results</span></span>
<span id="cb45-67"><a href="#cb45-67" tabindex="-1"></a><span class="fu">print</span>(benchmark_results)</span>
<span id="cb45-68"><a href="#cb45-68" tabindex="-1"></a><span class="co">#&gt; Unit: milliseconds</span></span>
<span id="cb45-69"><a href="#cb45-69" tabindex="-1"></a><span class="co">#&gt;        expr       min      lq      mean    median        uq       max neval</span></span>
<span id="cb45-70"><a href="#cb45-70" tabindex="-1"></a><span class="co">#&gt;  gibbs_Rcpp  2.000701  2.0060  2.103521  2.019901  2.076102  2.754701    10</span></span>
<span id="cb45-71"><a href="#cb45-71" tabindex="-1"></a><span class="co">#&gt;     gibbs_R 16.482301 17.0307 19.091131 19.139750 21.062101 22.025101    10</span></span>
<span id="cb45-72"><a href="#cb45-72" tabindex="-1"></a></span>
<span id="cb45-73"><a href="#cb45-73" tabindex="-1"></a><span class="co"># Visualize benchmark results</span></span>
<span id="cb45-74"><a href="#cb45-74" tabindex="-1"></a><span class="fu">autoplot</span>(benchmark_results)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABL1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYzMzM6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5Nbo5NbqtNjqtNjshmAABmADpmOgBmOmZmkJBmkLZmkNtmtpBmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6Obm6Ojm6Ojo6OyP+QOgCQZjqQZmaQkDqQkGaQkLaQtpCQttuQ27aQ2/+rbk2rbm6rbo6rq26ryKur5P+2ZgC2kDq2tpC2ttu227a229u22/+2///Ijk3Ijm7I/8jI///bkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb///kq27k/8jk///r6+v/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///9EzNaxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKDklEQVR4nO2dC3vbNBiFnW4lCeOeDspCubVjrBuwcNvouDTc1kHDuKVsbmBp6///G5A+SbbsOD52L4mXnO9Z69g6ko/fSJ/swiMHEaMwgnkbqHsQEAgCAkFAIAgIBAGBICAQBARi9oCOe6vDqYXjbvPMbUxvbvT2Xk7V4saWCtBg5VkAVBgXD6hqzALQqN151G68F4Xt4JWhvbhH7eDyjr7S5iBYeRD9uxEElx/IFSmV/hTJsRcfCI0fXghU/cirtvrXhhxKt60ELwRy3DT8kwY03jBcjntBEHT06ScNZc7ReLenKh5/qtqaDaCX2+pUd9WvoGkAhepj0NhRO5faweowbNv9cfdS23xStWJNILEVedUub5hD6bajgZOahv/q6vOtCO8UoKwh7xy2iaY770wABZvRI2VOfZIvS/2oq3ykDigTHbG+qZ2tDsfd4LXh8fdir6GO/d4Wo82hKpVjcTVF+Td1KNu2hjEylTrSIaWODZeD8gy5c4y7jXvRvz1p+tVhNJoNIN3Ru6txb9Z93BSpK9qzgijqN3ZEJUetRF2T0eh0kqlmDvltq6I/f/isLSytop/w8QBlDSUNhhqsNDtqX3rn51nlIJcv+w7QlrtSfVV2N9SADJbGTmh6uhpQRqOSSpSpZg75bdtx6QayKtCjKgdQ1lDS4ECA6k9Rf3ZDbFaAFJCXv/zRZB4DqLHZS6auioCi3zfmBygeKwZQMsSakRtiFkaWRhEgU8nkIAOo6RovCygZYhJ/zAeQZM5RNzHmJWmVgm2Svqem+p7OQc78RLVJQCrVqtsDp5CCfuBQD2QCLAaUJOlQzRfR8XwAmflaZmPJrN40ryfgQI8KO8Y6XnfJVJsE5GbrFCCT+AVQch80FdB8pvkJQHI3tpncEo/iG8WOgvXSA3fs0qY/njLVcpK03HDe67tuZwoGLk+PN4Lm3wiQnOP97ixvFJ/BsJNFVLtnsfnHqP2cyjxJ3iKgTNjMEz8ME1A2JPO8Gv+xgIBAEBAIAgJBQCAICAQBgZgFoCclYlI0cWRaO1WPlxMREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBAREBARkIqWiZwdApJoiT1Lxu242gTkAKXjXAA9vbEfPbwjH+0mXXx9TcXr+8sLyCOTC+iGZnOw/ngJAR1tr73x0a70oE/W1hQcuzn0e4wBZH4vG6CHN6PDqwbQ+uNkc3R7Pzq4lgZkelCc/eoYuYAy+9UAaRAnX++6HKR+zObo1q6nMjkoHmHL1IOefvjYAfplVwDZjWJyNWakiw+T3WUClO5BJ/fvuI2Kw7jLyBA7WM5ZzMtB16Jko+FkAJ3cj3MSNJp7NbMD5N0nnscs9ubXbhbTo8htcmax6zdrD8h7vGi10s8apwQU+dN32YBGc69mJg+rybNXdu90gE7ur3nJeAKdzF6TghJG+TRf3SgBAaMEBIwSEDBKQMAoAQGjBASMEhAwSkDAKAEBowQEjBIQMEpAwCgBAaMEBIwSEDBKQMAoAQGjBASMEhAwSkDAKAEBowQEjBIQMEpAwCgBAaMEBIwSEDBKQMAoAQGjBASMEhAwSkDAKAEBowQEjBIQMEpAwCgBAaMEBIwSEDBKQMAoAQGjBASMEhAwuoyAWtPcEJBEi4AIiIAIyBUQULGIgICIgICIgICIgICIgIBoLoCi6YQI6AkBERABEZBXQEDFIgICIgICIgICIgICIgICIgICIgICIgICIgICovkAmk6IgJ4QEAEREAF5BXMCNI0QAT0xyzcTEAEREAFJAQEVi+oDqDXF6LICmiBEQClAE12o9awDqviqrOUD5JEp86qsZQJU8VVZSn519+j2t/q1EXaz4ICqvSpLv+HncP2f7fXHh6/vH5lNlH59lgE0EQV9rwYxHVDFV2UZUkfbd3Qlu7Ea96VYQKkvqvXs9qCKr8rScgXo1m4MMU5Z7pwLNsQqvirL9iBFRvcgs1lsQBVflaXRPb3x6/Y1XXhkNgsOqOKrsswsdutjmcXMZsEBRad4VZbN4OlE7s65YM9ip3pV1jIBOr9w5+SfOwiIgAgoLiCgYtGcAPE/HCJA5Y0SEDBKQMAoAQGjBASMLiUg/k+cBERABGQLCKhYREBAREBAREBAREBAREBAREBAREBAREBAREBAREBANBdAXKKLgAiIgFwBARWLCAiICAiICAiICAiI5gGIb0UgoDMCqmSUgIBRAgJGCQgYJSBglICAUQICRgkIGCUgYJSAgFECAkYJCBglIGB0iQCViRLrL1RdouF8lnQgIBAEBIKAQNQFUG2DgEAQEAgCAkFAIGoB6BCtoxdFB3CtvVTIqixH22uFi8+VijoA0leTrIqWH3kr8E2PQw1Tr2iEmsVRB0A6wEI8yXJWZeLh1e/0sny396uv7zMRdQEEvmo1WmSJwrKhwehV1dLr9Jwm6gHo6fXpKxUZwQe7lXqRrD23vjiAsksy5UeFPLRoPSgqdfUVAS1ODioxFrTk5Jtq0/zJ/ZuLMosdFK2WVlrix2LdB9U6CAgEAYEgIBAEBIKAQJw3oONeYKI5en6nULeV2lfq+F+lE4Yre+7j+C1XdRA0qrUiBvIOjy+iB5W5xkEzr1pVOlEKUBSuDmU77m5VbWaa6f6cACVfdqraGQG5bnmKZvLrjLvBxQGS673bDoLOSP3aMqPPXc1Afdep0tQQ04f8Gnqre5zdmopb4r/xhRI4ve1CercZi698bs4a1zKtHvc62sfKnlTuOECyF7gRGjZHFwuorQwPAv1LO2oaMHKlHe3FK/UBSf1Re8vV0Fs9avRW/5iKK3vjbkcdl7qij7uB3iRiO5hdLdeqtqJ8yHAc2EZyruWCAW0lzmUs2Owgm1Rp6t8V089cDedd9kP9nXst6mu74kaZbV5XSInlYMaHdNXnd/4bRkWj+4IByVdrfw3M7NZJAPmlqe7TNyPK1XBpRgaQ16x0R03H6m3PtIB8cezK86G10kIoQ6oGgOwUUwKQZJeVPVcDArL6koCcj3D1754eo40dT5fOQTMFFHq3JhCQSFyNeIjp/dDlHDtYHD1p0h9ivtgHFPsYv3VXwRWQYR160HFPWXHu+p0CQHLNXg2Xb+O8a+uMu01J0k6fn6SzgBIffT0w9adRuw6AZHp1314o0/y0HhTaTu5qTEzztqKb5p3eTZIi8MU+oMRHKLcGKoE1vkpmglkAKhF5N4pnj+zzy3nEvB5Wcx41zh6hNw+cV8wL0EV82RfSLfnnDhAEBIKAQBAQCAICQUAgCAjE/5chcEVa8BmBAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="co"># Calculate speed-up factor</span></span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>speedup <span class="ot">&lt;-</span> <span class="fu">mean</span>(benchmark_results<span class="sc">$</span>time[benchmark_results<span class="sc">$</span>expr <span class="sc">==</span> <span class="st">&quot;gibbs_R&quot;</span>]) <span class="sc">/</span></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>           <span class="fu">mean</span>(benchmark_results<span class="sc">$</span>time[benchmark_results<span class="sc">$</span>expr <span class="sc">==</span> <span class="st">&quot;gibbs_Rcpp&quot;</span>])</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>speedup_factor <span class="ot">&lt;-</span> speedup</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Speedup Factor:&quot;</span>, speedup_factor, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a><span class="co">#&gt; Speedup Factor: 9.075798</span></span></code></pre></div>
<p>Comments on the results the two implementations of the Gibbs sampler,
gibbsSamplerR in R and gibbsSamplerRcpp in Rcpp, reveal the following
key findings:</p>
<p><strong>Performance Difference:</strong></p>
<ul>
<li>The Rcpp implementation is significantly faster, with a mean
execution time o compared to R</li>
<li>The Rcpp implementation is approximately times faster than the R
implementation, as shown by the speedup factor. Execution
Consistency:</li>
<li>The Rcpp implementation (gibbs_Rcpp) shows a narrow range of
execution times, indicating consistent performance across runs.</li>
<li>The R implementation (gibbs_R) has a wider range, reflecting more
variability in execution times.</li>
</ul>
</div>
<div id="references-4" class="section level2">
<h2>References</h2>
<ul>
<li>Rafael Díaz. (2024). Gibbs sampler bivariate normal in Rcpp. Stack
Overflow. <a href="https://stackoverflow" class="uri">https://stackoverflow</a>.
com/questions/50362985/gibbs-sampler-bivariate-normal-in-rcpp</li>
<li>Thinking inside the box. (2011). MCMC and faster Gibbs Sampling
using Rcpp | R-bloggers. R bloggers. <a href="https://www.r-bloggers.com/2011/07/mcmc-and-faster-gibbs-sampling-using-rcpp" class="uri">https://www.r-bloggers.com/2011/07/mcmc-and-faster-gibbs-sampling-using-rcpp</a></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
